<head>
    <title>PET cloud window</title>
</head>
<body>
    <h3>PET cloud window</h3>
       
    <p style="white-space:pre">
import importlib
import subprocess
import sys
import os
import tkinter
import threading
import queue
from tkinter import ttk, Tk, messagebox, Text
from tkinter.constants import *
import tkinter as tk

try:
    from PyPDF2 import PdfWriter, PdfReader
    import cv2
    from PIL import Image
    from reportlab.lib.pagesizes import letter
    from reportlab.pdfgen import canvas
    import qrcode
except:
    class InstallerManager:
        def __init__(self, root, libraries):
            self.root = root
            self.libraries = libraries
            self.total = len(libraries)
            self.current = 0
            self.progress = 0
            self.status = "准备开始安装..."
            self.queue = queue.Queue()
            self.response_queue = queue.Queue()  # 新增响应队列
            self.thread = None
            self.cancelled = False

        def start_installation(self):
            self.thread = threading.Thread(target=self._install_libraries)
            self.thread.start()
            self.root.after(100, self._update_progress)

        def _update_progress(self):
            try:
                while True:
                    msg_type, value = self.queue.get_nowait()
                    if msg_type == 'progress':
                        self.progress += value
                        self.progress_bar['value'] = self.progress
                    elif msg_type == 'status':
                        self.status_label.config(text=value)
                    elif msg_type == 'error':
                        messagebox.showerror("错误", value)
                    elif msg_type == 'done':
                        messagebox.showinfo("完成", value)
                        self.root.destroy()
                        self.restart_application()
                    elif msg_type == 'ask_install':  # 处理安装询问
                        package, package_name = value
                        response = messagebox.askyesno("缺少库", f"库 {package} 未安装。是否要现在安装？")
                        self.response_queue.put(response)
            except queue.Empty:
                pass
            if not self.cancelled and self.thread.is_alive():
                self.root.after(100, self._update_progress)

        def _install_libraries(self):
            self.total = len(self.libraries)
            for package, package_name in self.libraries.items():
                if self.cancelled:
                    break
                self.current += 1
                self.status = f"正在检查 {package_name} ({self.current}/{self.total})..."
                self.queue.put(('status', self.status))
                try:
                    importlib.import_module(package)
                    self.queue.put(('progress', 100 / self.total))
                    continue
                except ImportError:
                    pass

                # 将安装请求发送到主线程处理
                self.queue.put(('ask_install', (package, package_name)))
                response = self.response_queue.get()  # 等待用户响应

                if response:
                    try:
                        subprocess.check_call([sys.executable, "-m", "pip", "install", package_name])
                        importlib.import_module(package)
                        self.queue.put(('progress', 100 / self.total))
                    except subprocess.CalledProcessError as e:
                        self.queue.put(('error', f"安装 {package_name} 时发生错误: {e}"))
                        continue
                else:
                    self.queue.put(('error', f"已跳过 {package_name}，请手动安装！"))
                    self.queue.put(('progress', 100 / self.total))
                    continue

            if not self.cancelled:
                self.queue.put(('done', "所有库已安装完成，正在重启！"))
                
                os.execl(sys.executable,  sys.executable,  *sys.argv) 

        def restart_application(self):
            script_path = sys.argv[0]
            os.execv(sys.executable, [sys.executable, script_path])
            sys.exit(0)

        def cancel_installation(self):
            self.cancelled = True
            self.progress_bar['value'] = 0
            self.status_label.config(text="安装已取消。")
            if self.thread and self.thread.is_alive():
                self.thread.join(timeout=1)

    def ensure_libraries_installed():
        required_libraries = {
            'cv2': 'opencv-python',
            'PIL': 'Pillow',
            'PyPDF2': 'PyPDF2',
            'reportlab': 'reportlab',
            'qrcode': 'qrcode'
        }

        root = Tk()
        root.title('OFFICE 本地部署')
        root.geometry('400x200')

        progress_frame = ttk.Frame(root)
        progress_frame.pack(fill=X, padx=5, pady=5)

        progress_label = ttk.Label(progress_frame, text="安装进度:")
        progress_label.pack(side=LEFT)

        progress_bar = ttk.Progressbar(progress_frame, orient=HORIZONTAL, length=200, mode='determinate')
        progress_bar.pack(side=RIGHT, fill=X, expand=True)

        status_label = ttk.Label(root, text="准备开始安装...", anchor=W)
        status_label.pack(fill=X, padx=5, pady=5)

        txt_edit = tk.Text(root, font=('微软雅黑', 9), width=54, height=5)
        txt_edit.place(x=9, y=66)
        a = '安装操作说明\n\n提示:此软件不适用于win7以下的操作系统,win10一下操作系统无法使用摄像功能\n\n手动安装操作\n您可以win+r,输入cmd,在窗口中输入\npip install cv2\npip install PIL\npip install PyPdf2\npip install reportlab\npip install qrcode\n\n仍然失败\n可前往python安装程序中选择修复并重启电脑后尝试\n\n客服助理\n13735578201'
        txt_edit.insert(tk.END, a)

        installer_manager = InstallerManager(root, required_libraries)
        installer_manager.progress_bar = progress_bar
        installer_manager.status_label = status_label

        cancel_button = ttk.Button(root, text='取消安装', command=installer_manager.cancel_installation)
        cancel_button.pack(side=BOTTOM, padx=5, pady=5)

        installer_manager.start_installation()

        root.mainloop()

    def show_message(title, message, msg_type='info'):
        if msg_type == 'info':
            messagebox.showinfo(title, message)
        elif msg_type == 'warning':
            messagebox.showwarning(title, message)
        elif msg_type == 'error':
            messagebox.showerror(title, message)

    ensure_libraries_installed()

    try:
        from PyPDF2 import PdfWriter, PdfReader
        import cv2
        from PIL import Image
        from reportlab.lib.pagesizes import letter
        from reportlab.pdfgen import canvas
        import qrcode
    except ImportError as e:
        show_message("导入错误", f"即使尝试安装后，仍无法导入某些库。请检查您的环境配置: {e}", 'error')
        sys.exit(1)

    try:
        show_message("版本信息", f"OpenCV 版本: {cv2.__version__}", 'info')
    except NameError:
        show_message("导入错误", "即使尝试安装后，仍无法导入 cv2。请检查您的环境配置。", 'error')
        sys.exit(1)

# 这里继续添加你的主程序代码
else:
    import tkinter
    from tkinter import ttk,filedialog,messagebox
    import tkinter as tk
    from tkinter import *
    from tkinter import simpledialog,font
    import os
    import shutil
    import zipfile
    import traceback
    import sys
    from datetime import datetime
    import time
    from tkinter import font
    import random
    import turtle
    import tkinter
    import time
    import tkinter.messagebox
    from tkinter import *
    import tkinter as tk
    from tkinter import ttk
    from tkinter import filedialog
    import os
    from tkinter import ttk, filedialog, messagebox
    import shutil
    import ctypes
    from tkinter import font  # 确保正确导入 font
    import zipfile
    from tkinter import simpledialog
    import subprocess
    import sys

    from datetime import datetime
    import importlib.util
    import sys
    import subprocess
    from tkinter.font import Font
    import tkinter as tk
    from tkinter import ttk, messagebox
    import os
    import threading
    import shutil

    import json
    import tkinter as tk
    from tkinter import filedialog, messagebox
    import traceback
    import sys 
    from importlib.util import find_spec
    import traceback
    from PIL import Image, ImageTk
    #import pillow

    import tkinter as tk
    from tkinter import ttk, messagebox
    from tkinter.scrolledtext import ScrolledText
    from threading import Thread, Lock
    from queue import Queue
    import logging
    import os
    import time
    import ctypes
    import sys
    try:
        

        n=0
        文本=""
        a=""
        剪切文本=""
        z_color='black'
        ii=0
        minute=0
        hour=0
        hourList=[]
        minuteList=[]
        placeList=[]
        newsList=[]
        状态=0
        运判=[]
        次数=0
        dayList=[]
        monthList=[]
        ssss=0
        dagou=0
        month=0
        year=0
        day=0

        sssss=0

        频道="00"

        windows=1
        cs=0
        ydcs=5
        pdf=0
        a=0
        b=0
        c=0
        d=0
        e=0
        n=0
        文本=""

        换行=0
        running = False
        次数数=0
        ffont=10
        Font="宋体"
        弹窗_提示窗=[1,0]
        year=0
        窗口填写信息=1
        mounth=0
        date=0
        verification_code=""
        姓名=""
        次数数数=0
        提示总次数=1
        备份i=0
        #用户资金
        class Account:
            def __init__(self, name, password, balance, operation,shenfen):
                self.name = name
                self.password = password
                self.balance = balance
                self.operation = operation
                self.shenfen=shenfen
                
            def record(self):
               current_time = datetime.now() 
                # 格式化时间字符串，年份只保留后两位
               current_time_str = f'{current_time.year  % 100:02d}-{current_time.month:02d}-{current_time.day:02d}  {current_time.hour:02d}:{current_time.minute:02d}:{current_time.second:02d}' 
                
               if(self.name!=''):
            
                   f=open(self.name + ".rtf", "a") 
                   text =f"时间:{current_time}" +  f"昵称:{self.name},密码:{self.password},当前资金:{self.balance},状态:{self.operation},身份:{self.shenfen}/&&\n"
                   f.write(text)
                   f.close()
        #账本
        class Account2:
            def __init__(self, name, wupin,shoujia):
                self.name = name
                
                self.shoujia=shoujia
                self.wupin=wupin

            def record_zhangben(self):
                
                current_time = datetime.now() 
                # 格式化时间字符串，年份只保留后两位
                current_time_str = f'{current_time.year  % 100:02d}-{current_time.month:02d}-{current_time.day:02d}  {current_time.hour:02d}:{current_time.minute:02d}:{current_time.second:02d}' 
                
                if(self.name!=''):
                    with open(self.name + "账本" + ".rtf", "a") as f:  # 使用with语句来确保文件正确关闭
                        text = (f"时间:{current_time},昵称:{self.name},购买了售价:{self.shoujia},虚拟物品:{self.wupin}/&&\n")
                        f.write(text)
        #主控记录

        class Account1:
            def __init__(self, name, tongy, lishi, caozuo):
                self.name  = name
                self.tongy  = tongy
                self.lishi  = lishi  # 使用lishi作为属性存储历史信息
                self.caozuo  = caozuo 
         
            def record_history(self):
                current_time = datetime.now() 
                # 格式化时间字符串，年份只保留后两位
                current_time_str = f'{current_time.year  % 100:02d}-{current_time.month:02d}-{current_time.day:02d}  {current_time.hour:02d}:{current_time.minute:02d}:{current_time.second:02d}' 
                
                if self.name  != '':
                    with open(self.name  + "主控记录" + ".rtf", "a") as f:  # 使用with语句来确保文件正确关闭
                        text = (f"时间:{current_time_str},昵称:{self.name}, 权限:{self.tongy}, 事件:{self.lishi},{self.caozuo}/&&\n") 
                        f.write(text) 




                  
        btn2220=0
        shenfen="用户"
        guanli_li=0

        
        passwar=0
        namee=""
        def 账户():
            dz = tkinter.Tk()
            dz.geometry("316x376")
            dz.title("便利贴 OFFICE【PET/7.V.v】")
            dz.resizable(False, False) 


            # 创建一个Style对象
            style = ttk.Style()

            # 定义一个新的样式，这里以"TButton"为基础样式
            style.configure('Custom.TButton',
                   font=('幼圆', 15,"bold"))
            style = ttk.Style()
            style.configure("TButton", padding=6, relief="flat",
                          background="#ccc", foreground="black")
            def dengl():
                     global 姓名
                    
                     global namee,ydcs,cs
                   
                     nonlocal entry13
                     name=entry11.get()
                     namee=name
                     pw=entry13.get()
                     global cs
                     global ydcs
                     global passwar
                     global btn6
                     if(name!="" and pw!=""):
                              try:
                                       f=open(name+".rtf","r")
                                       ff=open(name+"主控记录"+".rtf","r")
                              except:
                                     
                                       label_提=tk.Label(dz,text='×账户不存在,请先注册',font=('微软雅黑',8),bg='#ffd4d4',fg='black')
                                       label_提.place(x=97,y=7)
                                       dz.after(2600,label_提.destroy)
                              else:
                                   name=name
                                   
                                   current_time = datetime.now()

                                   liness=ff.readlines()
                                       
                                   linee=liness[-1]

                                   lineListt=linee.split(",")

                                   q=lineListt[1]

                                   lines=f.readlines()
                                       
                                   line=lines[-1]
                                   lineListt=linee.split(",")
 
                                   q=lineListt[2]
                                   char_to_remove = "权限:"  
                                   
                                   # 使用 replace() 删除字符
                                   q= q.replace(char_to_remove, "")

                                   tongy=int(q)
                                   uuser = Account1(name, tongy, "登录账号{正登记}", "操作:04登录账户{预备状态}")
                                   uuser.record_history()
                                   
                                   
                                   

                                   liness=ff.readlines()
                                       
                                   linee=liness[-1]

                                   lineListt=linee.split(",")

                                   q=lineListt[1]

                                   lineList=line.split(",")
                                   passward=lineList[1]
                                   char_to_remove = "密码:"
                                   
                                   # 使用 replace() 删除字符2
                                   passward= passward.replace(char_to_remove, "")
                                   
                                   passwar=passward
                         
                                   q=q
                                   
                                   
                                   if(tongy==0):
                                         dz.destroy()
                                         
                                         roo= tk.Tk()
                                         roo.resizable(False, False)
                                         roo.title("便利贴 OFFICE【PET/7.V.v】")
                                         def place_window_to_bottom_right(root, window_width=360, window_height=220):
                                                                            # 获取屏幕的宽度和高度
                                                                            screen_width = root.winfo_screenwidth()
                                                                            screen_height = root.winfo_screenheight()

                                                                            # 计算窗口左上角的坐标
                                                                            x_coordinate = screen_width - window_width - 24  # 从右侧留出一点空间
                                                                            y_coordinate = screen_height - window_height - 94  # 从底部留出一点空间（考虑到任务栏）

                                                                            # 设置窗口的大小和位置
                                                                            roo.geometry(f"{window_width}x{window_height}+{x_coordinate}+{y_coordinate}")
                                                                           # 使用函数将窗口放置到右下角
                                         place_window_to_bottom_right(roo)
                                         cs=0
                                         ydcs=5
                                         
                                         label15 = tkinter.Label(roo, text=""" ㄒoㄒ抱歉异常                                                               """,bg="dark orange",fg="white",font=("微软雅黑", 14))
                                         label15.place(x=0,y=0)
                                         label16 = tkinter.Label(roo, text="""          您的密码错误超过指定次数，已自动将您的账户冻结\n储存,如果您想继续使用可进行解冻账户与人机校验        





                                                                                                 """,bg="#FFB348",fg="white",font=("微软雅黑", 10))
                                         label16.place(x=-14,y=33)
                                   
                                         tongy = "0"
                                         balance=lineList[2]
                                         char_to_remove = "当前资金:"

                                         # 使用 replace() 删除字符
                                         shenfen="用户{未知}"
                                         balance= balance.replace(char_to_remove, "")
                                         user=Account(name,passward,balance,"已被冻结",shenfen)
                                         user.record()
                                         
            
                                         name=name
                                         uuser = Account1(name, "0", "登录账号{被冻结}", "操作:03冻结{禁用账户}")
                                         uuser.record_history()
                                   
                                         
                                         btn6=ttk.Button(roo,text="解冻账户",command=jiedong)
                                         btn6.place(x=0,y=192,width=360)
                                   else:
                                     
                                       place=name
                                       tongy=1
                                       if passward ==str(pw):
                                      
                                            balance=lineList[2]
                                            tongy="1"
                       
                                            char_to_remove = "当前资金:"

                                            # 使用 replace() 删除字符
                                            shenfen="用户"
                                            balance= balance.replace(char_to_remove, "")
                                            user=Account(name,passward,balance,"登录账户",shenfen)
                                            user.record()
                                            

                                            uuser = Account1(name, tongy, "登录账号{已登记}", "操作:04登录账户{打开主页}")
                                            uuser.record_history()
                                            
                                            
                                            
                                            dz.destroy()
                                            #销毁 注册/登录窗口 并启动主页word
                                            ydcs=5
                                            cs=0
                                            姓名=name
                                            便利贴OFFICE()


                                       else:
                                                
                                                cs+=1
                                                ydcs=ydcs-1
                                                if(cs>=3):
                                                     if(cs==5):
                                                        dz.destroy()
                                                        #qc.destroy()
                                                        roo= tk.Tk()
                                                        roo.resizable(False, False)
                                                        roo.title("便利贴 OFFICE【PET/7.V.v】")
                                                        def place_window_to_bottom_right(root, window_width=360, window_height=220):
                                                                            # 获取屏幕的宽度和高度
                                                                            screen_width = root.winfo_screenwidth()
                                                                            screen_height = root.winfo_screenheight()

                                                                            # 计算窗口左上角的坐标
                                                                            x_coordinate = screen_width - window_width - 24  # 从右侧留出一点空间
                                                                            y_coordinate = screen_height - window_height - 94  # 从底部留出一点空间（考虑到任务栏）

                                                                            # 设置窗口的大小和位置
                                                                            roo.geometry(f"{window_width}x{window_height}+{x_coordinate}+{y_coordinate}")
                                                                           # 使用函数将窗口放置到右下角
                                                        place_window_to_bottom_right(roo)
                                                        label15 = tkinter.Label(roo, text=""" ㄒoㄒ抱歉异常                                                               """,bg="dark orange",fg="white",font=("微软雅黑", 14))
                                                        label15.place(x=0,y=0)
                                                        label16 = tkinter.Label(roo, text="""          您的密码错误超过指定次数，已自动将您的账户冻结\n储存,如果您想继续使用可进行解冻账户与人机校验        





                                                                                                                """,bg="#FFB348",fg="white",font=("微软雅黑", 10))
                                                        label16.place(x=-47,y=33)
                                                        tongy = "0"
                                                        balance=lineList[2]
                                                        char_to_remove = "当前资金:"

                                                        # 使用 replace() 删除字符
                                                        balance= balance.replace(char_to_remove, "")
                                                        shenfen="用户{未知}"
                                                        user=Account(name,passward,balance,"已被冻结",shenfen)
                                                        user.record()

                                                        cs=0
                                                        ydcs=5
                                                        name=name


                                                        uuser = Account1(name,"0", "登录账号{被冻结}", "操作:03冻结{禁用账户}")
                                                        uuser.record_history()
                                                        
                                                        btn6=ttk.Button(roo,text="解冻账户",command=jiedong)
                                                        btn6.place(x=0,y=192,width=360)
                                                     else:
                                                      current_time = datetime.now()
                                                      lishii = "登录账号{登记有误}"


                                                      uuser = Account1(name, tongy, "登录账号{登记有误}", "操作:04登录账户{判断拦截中}")
                                                      uuser.record_history()
                                                        
                                                      
                                                      label_提=tk.Label(dz,text=f'×密码错误，您还有{ydcs}次机会',font=('微软雅黑',8),bg='#ffd4d4',fg='black')
                                                      label_提.place(x=87,y=7)
                                                      dz.after(2700,label_提.destroy)
                                                else:
                                                 current_time = datetime.now()
                                                 lishii = "登录账号{登记有误}"


                                                 uuser = Account1(name, tongy, "登录账号{登记有误}", "操作:04登录账户{判断拦截中}")
                                                 uuser.record_history()
                                                 
                                                 label_提=tk.Label(dz,text=f'×密码错误，请核验您的密码',font=('微软雅黑',8),bg='#ffd4d4',fg='black')
                                                 label_提.place(x=83,y=7)
                                                 dz.after(2700,label_提.destroy)
                                            
                     else:
                       
                       label_提=tk.Label(dz,text=f' ! 您还未填写信息',font=('微软雅黑',8),bg='#ffe1a9',fg='black')
                       label_提.place(x=109,y=7)
                       dz.after(2500,label_提.destroy)

            def kefzl():
                 
                def 插入换行(文本):
                    # 在每16个字符后插入一个换行符 
                    新文本 = ""
                    for i in range(0, len(文本), 16): 
                        新文本 += 文本[i:i+16] + "\n\n" 
                    return 新文本 
                 
                def 查看订单状态():
                    内容 = "这也许是你的密码或姓名出现了问题，可再次查询密码和账号是否正确，若账号内未重要信息可重新注册。如果一定要登录账号，你可以多尝试几次，并且可关机重启后在尝试。这也许是因为你生成的账户文件被你删除，或并未存放到一起，你可以找到并将系统与账户放在同一个文件夹中。若以上方法均为失效，可前往人工客服。" 
                    结果文本框.delete('1.0', tk.END) 
                    结果文本框.insert(tk.END, 插入换行(内容)) 
                 
                def 产品信息(): 
                    内容 = "防伪码是防止黑客或各个系统内人机的强行访问，确保系统安全。输入防伪码为，在上方的随机标中输入数字，则完成了防伪码的输入。注意当你的密码被系统侦测为错误，防伪码会自动更新为，别的数字，请注意辨更。"
                    结果文本框.delete('1.0', tk.END) 
                    结果文本框.insert(tk.END, 插入换行(内容)) 
                 
                def 联系客服(): 
                    内容 = "注册后，桌面会自动生成一项rtf文件，这是你保存后的一切信息。请不要将文件当作垃圾处理，以防文件丢失了，数据报错现象，请不要在文件内做擅自更改，若更改需付法律责任。你也可以将这两个文件放入同一个文件夹中，以免丢失一些数据。" 
                    结果文本框.delete('1.0', tk.END) 
                    结果文本框.insert(tk.END, 插入换行(内容)) 
                 
                def 注销账户():
                    内容 = "注销账户前，你需要确定自己不需要这个账户，因为删除后将无法找回所有信息。首先，点击账户注销（深蓝色按钮），随后选择由自己命名的rtf文件，请注意一般文件都放置于主程序文件夹中（例主程序：桌面,即rtf文件：桌面）最后点击删除，待提示删除成功则成功删除。注意分辨自己的账户文件（以自己账户名命名），面删除错误。"
                    结果文本框.delete('1.0', tk.END) 
                    结果文本框.insert(tk.END, 插入换行(内容)) 
                 
                def 注册失败(): 
                    内容 = "在注册中，你可能出现了密码错误或填写了不正确文字信息等。你可以再次确认，密码输入是否正确，或验证码是否正确，再点击完成后若没有出现反馈，你可以再次点击尝试，直至出现弹窗反馈。若以上方式均为解决你的困扰，可前往人工客服答疑解惑。"
                    结果文本框.delete('1.0', tk.END) 
                    结果文本框.insert(tk.END, 插入换行(内容)) 
                 
                def 找账号(): 
                    内容 = "你得先确保自己未将文件删除。你可以打开此电脑，上方查询输入框中输入自己的账号名称，就可以找到了。找到后，可以将账号与系统放置在同一个文件夹中，一边再次丢失。"
                    结果文本框.delete('1.0', tk.END) 
                    结果文本框.insert(tk.END, 插入换行(内容)) 
                 
                def 人工客服(): 
                    内容 = "人工客服，请拨打：13735578201。" 
                    结果文本框.delete('1.0', tk.END) 
                    结果文本框.insert(tk.END, 插入换行(内容)) 
                 
                def 退出应用():
                    窗口.destroy()
                 
                def 创建按钮(文字, 命令): 
                    按钮 = ttk.Button(窗口, text=文字, width=11, command=命令)
                    按钮.pack(pady=1) 
                 
                窗口 = tk.Tk() 
                窗口.title("OFFICE 客户服务") 
                窗口.geometry("340x340") 
                窗口.resizable(False, False) 
                 
                结果文本框 = tk.Text(窗口, wrap=tk.WORD, height=10, width=22)
                结果文本框.pack(side=tk.LEFT, fill=tk.BOTH, expand=True)
                 
                滚动条 = ttk.Scrollbar(窗口, command=结果文本框.yview) 
                滚动条.pack(side=tk.RIGHT, fill=tk.Y)
                结果文本框.config(yscrollcommand=滚动条.set) 
                 
                创建按钮("登不上帐号了", 查看订单状态) 
                创建按钮("防伪码是什么   ", 产品信息)
                创建按钮("  注册后须知   ", 联系客服) 
                创建按钮("注册失败", 注册失败)
                创建按钮("如何注销账户", 注销账户)
                创建按钮("找账户文件", 找账号) 
                创建按钮("人工客服", 人工客服)
                创建按钮("      退出      ", 退出应用)
                 
                窗口.mainloop() 
            def zhuxiao():
                 
                 def permanent_delete(file_path):
                    """使用 Windows API 强制永久删除文件"""
                    file_path = os.path.abspath(file_path)
                    if not os.path.exists(file_path):
                        return False
                    try:
                        class SHFILEOPSTRUCTW(ctypes.Structure):
                            _fields_ = [
                                ("hwnd", ctypes.c_void_p),
                                ("wFunc", ctypes.c_uint),
                                ("pFrom", ctypes.c_wchar_p),
                                ("pTo", ctypes.c_wchar_p),
                                ("fFlags", ctypes.c_ushort),
                                ("fAnyOperationsAborted", ctypes.c_bool),
                                ("hNameMappings", ctypes.c_void_p),
                                ("lpszProgressTitle", ctypes.c_wchar_p),
                            ]

                        FO_DELETE = 0x0003
                        FOF_SILENT = 0x0004
                        FOF_NOCONFIRMATION = 0x0010
                        FOF_NOERRORUI = 0x0400

                        # 构造双NULL结尾的路径字符串
                        pFrom = ctypes.create_unicode_buffer(file_path + '\0\0')
                        
                        fs = SHFILEOPSTRUCTW()
                        fs.hwnd = 0
                        fs.wFunc = FO_DELETE
                        fs.pFrom = ctypes.cast(pFrom, ctypes.c_wchar_p)
                        fs.pTo = None
                        fs.fFlags = FOF_SILENT | FOF_NOCONFIRMATION | FOF_NOERRORUI
                        fs.fAnyOperationsAborted = False
                        fs.hNameMappings = 0
                        fs.lpszProgressTitle = None

                        result = ctypes.windll.shell32.SHFileOperationW(ctypes.byref(fs))
                        return result == 0
                    except Exception as e:
                        print(f"永久删除失败: {e}")
                        return False

                 def delete_files():
                    file_paths = file_listbox.get(0, tk.END)
                    results = []
                    for file_path in file_paths:
                        file_path = file_path.strip()
                        if not file_path:
                            continue

                        if os.path.exists(file_path):
                            confirmed = messagebox.askyesno("确认删除", "删除文件后无法恢复！是否继续？")
                            if confirmed:
                                try:
                                    if permanent_delete(file_path):
                                        results.append(f"文件 {file_path} 已永久删除.")
                                    else:
                                        results.append(f"删除失败: {file_path}")
                                except Exception as e:
                                    results.append(f"删除错误 {file_path}: {str(e)}")
                        else:
                            results.append(f"文件不存在: {file_path}")

                    result_text.delete('1.0', tk.END)
                    result_text.insert(tk.END, '\n'.join(results))
                    file_listbox.delete(0, tk.END)

                 def choose_files():
                    file_paths = filedialog.askopenfilenames()
                    file_listbox.delete(0, tk.END)
                    for path in file_paths:
                        file_listbox.insert(tk.END, path)

                # 初始化主窗口
                 qc = tk.Tk()
                 qc.title("OFFICE 手动注销")
                 qc.geometry("250x200")

                 frame = ttk.Frame(qc, padding="5")
                 frame.grid(column=0, row=0, sticky=(tk.W, tk.E, tk.N, tk.S))

                # 文件列表框
                 file_listbox = tk.Listbox(frame, selectmode=tk.MULTIPLE, height=3, width=30)
                 file_listbox.grid(column=0, row=0, columnspan=2, pady=5, padx=5, sticky=(tk.W, tk.E))

                # 按钮
                 choose_button = ttk.Button(frame, text="选择账户", command=choose_files)
                 choose_button.grid(column=0, row=1, pady=5, padx=5, sticky=tk.W)

                 delete_button = ttk.Button(frame, text="删除账户", command=delete_files)
                 delete_button.grid(column=1, row=1, pady=5, padx=5, sticky=tk.E)

                # 结果展示
                 result_text = tk.Text(frame, height=2, width=30)
                 result_text.grid(column=0, row=2, columnspan=2, pady=5, padx=5, sticky=(tk.W, tk.E))

                # 布局配置
                 qc.columnconfigure(0, weight=1)
                 qc.rowconfigure(0, weight=1)
                 frame.columnconfigure(0, weight=1)
                 frame.columnconfigure(1, weight=1)
                 frame.rowconfigure(0, weight=1)
                 frame.rowconfigure(2, weight=1)

                 qc.mainloop()
            ii=0
            dagou=0
            cs=0
          
            verification_code = ''.join([str(random.randint(0, 9)) for _ in range(6)])
            def wangji():
                try:
                 global entry23, verification_code  # 定义全局变量
                 qc = tk.Tk()
                 qc.title("OFFICE 安全")
                 qc.geometry("285x270")  # 进一步缩小窗口大小
                 qc.resizable(False, False)
                 qr_label = tk.Label(qc)
                 qr_label.place(x=20, y=90)
                 
                 # 创建文件内容列表框

                 # 创建进度条         
                 entry23 = ttk.Entry(qc, font=("微软雅黑", 10))
                 entry23.bind('<Button-1>', lambda e: entry23.delete(0, tk.END))
                 entry23.place(x=20, y=40, width=240, height=30)
                 initial_text1 = "请输入您原有的账户"
                 entry23.insert(0, initial_text1)
                 
                 def tijiao():
                    global verification_code,cs,ydcs
                    cs=0
                    ydcs=5
                    global entry23# 使用非局部变量
                    global sssss
                 
                    
                    c = entry23.get().strip()
                    if(c=='' or c=='请输入您原有的账户'):
                        return
                    name=str(c)
                    current_time = datetime.now()
                    lishii = f"忘记密码"

                    if c != "":
                        try:
                                f=open(name + ".rtf", "r")  # 使用with语句来自动关闭文件
                                ff=open(name+"主控记录.rtf","r")
                        except:
                            for i in range(50):
                      
                                progress['value'] = i + 1  # 更新进度条
                                qc.update_idletasks()  # 强制更新GUI
                                
                            time.sleep(0.1)
                            progress['value'] = 0  # 重置进度条
                           
                            label_提=tk.Label(qc,text=f' ! 账户信息不存在',font=('微软雅黑',8),bg='#ffe1a9',fg='black')
                            label_提.place(x=92,y=9)
                            dz.after(2500,label_提.destroy)
                        else:
                            
                            a=ff.readlines()
                            b=a[-1]
                            b=b.split(',')
                            
                            tongy=b[2]
                            c=f.readlines()
                            c=c[-1]
                            c=c.split(',')
                            
                         
                            passward=c[1]
                            passward=passward.split('密码:')
                            passward=passward[1]
                            balance=c[2]
                            balance=balance.split('当前资金:')
                            balance=balance[1]
                            #print(tongy)
                            if(tongy==' 权限:1'):
                                   
                                    c = entry23.get().strip()
                                    s="正在将此账户载入查找范围:"
                                    file_listbox.insert(tk.END, s+c)  # 插入文件内容到列表框
                                    for i in range(100):
                                        
                                        progress['value'] = i + 1  # 更新进度条
                                        qc.update_idletasks()  # 强制更新GUI
                                    time.sleep(0.1)

                                    # 清理旧的控件
                                    entry23.destroy()
                                    btn25.destroy()
                                    btn26.destroy()
                                    progress.destroy()

                                    # 重新创建新的控件
                                    entry23 = ttk.Entry(qc, font=("微软雅黑", 10))
                                    entry23.bind('<Button-1>', lambda e: entry23.delete(0, tk.END))
                                    entry23.place(x=20, y=40, width=130, height=30)
                                    entry23.insert(0, "请输入右式验证码")
                                    
                                    # 生成随机数作为验证码
                                    verification_code = ''.join([str(random.randint(0, 9)) for _ in range(6)])
                                    canva = tk.Canvas(qc, width=100, height=34)
                                    canva.place(x=162, y=38, width=100, height=34)

                                    colours = ["red", "orange", "green", "yellow", "purple", "grey", "pink", "black"]
                                    theScreen = turtle.TurtleScreen(canva)
                                    asd = turtle.RawTurtle(theScreen)
                                    asd.penup()
                                    asd.goto(-30, -14)
                                    asd.pendown()
                                    asd.write(verification_code, font=("Arial", 13, "normal"))
                                    asd.penup()
                                    asd.goto(-33, -7)
                                    asd.pendown()
                                    b = random.randint(0, 7)
                                    c = random.randint(8, 15)
                                    asd.color(colours[b])
                                    asd.write("-------------", font=("Arial", 11, "normal"))
                                    asd.penup()
                                    asd.goto(-33, -14)
                                    asd.pendown()
                                    asd.color(colours[c-8])
                                    asd.write("————", font=("Arial", 11, "normal"))
                                    
                                    def toggle_password_visibilityy():
                                         global dagou
                                         global sssss
                                         if(sssss==0):
                                             dagou+=1
                                             sssss=1
                                         else:
                                             dagou-=1
                                             sssss=0
                                    def qr():
                                        global dagou
                                        global cs
                                        global ydcs
                                        global passwar,姓名,弹窗_提示窗
                                        global verification_code
                                        nonlocal name
                                        nonlocal passward
                                        user_input = entry23.get().strip()
                                    
                                      
                                        # 使用 replace() 删除字符
                                        
                                        if user_input == verification_code:
                                          s="账户密钥:"
                                          file_listbox.insert(tk.END, s+passward)
                                          current_time = datetime.now()
                                          lishii = "办达安全{忘记密码[传输了一组密钥]}"


                                          shenfen="用户"
                           
                                          tongy="1"

                                          uuser = Account1(name, tongy, "{忘记密码[传输了一组密钥]}", "操作:05忘记密码[传输了一组密钥]")
                                          uuser.record_history()
                                          if(dagou==1):
                                               def is_installed(package_name):
                                                    """检查指定的包是否已安装"""
                                                    spec = importlib.util.find_spec(package_name)
                                                    return spec is not None

                                               def install_package(package_name, qc):
                                                    """使用pip安装指定的包，并用messagebox显示状态"""
                                                    try:
                                                        subprocess.check_call([sys.executable, "-m", "pip", "install", package_name])
                                                        #messagebox.showinfo("安装完成", f"{package_name} 安装完成.")
                                                        label_提=tk.Label(qc,text=f"安装完成,{package_name} 安装完成.",font=('微软雅黑',8),bg='#bfffa9',fg='black')
                                                        label_提.place(x=78,y=9)
                                                        qc.after(3200,label_提.destroy)
                                                        uuser = Account1(name, '1', "{忘记密码[安装库完成]}", "操作:05忘记密码[安装库{package_name}完成]")
                                                        uuser.record_history()
                                                    except Exception as e:
                                                        #messagebox.showerror("安装失败", f"无法安装 {package_name}: {e}")
                                                        label_提=tk.Label(qc,text=f"安装失败,无法安装 {package_name}",font=('微软雅黑',8),bg='#ffd4d4',fg='black')
                                                        label_提.place(x=78,y=9)
                                                        qc.after(3200,label_提.destroy)
                                                        uuser = Account1(name, tongy, "{忘记密码[安装库失败]}", f"操作:05忘记密码[安装库{package_name}失败,错误:{e}]")
                                                        uuser.record_history()
                                               package_name = 'qrcode'
                                               if not is_installed(package_name):
                                                    #messagebox.showwarning("未安装", f"{package_name} 未安装，开始安装...")
                                                    
                                                    uuser = Account1(name, tongy, "{忘记密码[正安装库]}", f"操作:05忘记密码[正安装库)]")
                                                    uuser.record_history()
                                                    install_package(package_name,qc)
                                                    label_提=tk.Label(qc,text=f"未安装,{package_name} 未安装，开始安装...",font=('微软雅黑',8),bg='#ffd4d4',fg='black')
                                                    label_提.place(x=70,y=9)
                                                    qc.after(3400,label_提.destroy)


                                                # 尝试导入 qrcode 库
                                               try:
                                                    import qrcode

                                                    
                                               except ImportError as e:
                                                    messagebox.showerror("错误", f"导入 qrcode 库失败: {e}")
                                                    uuser = Account1(name, tongy, "{忘记密码[安装库失败]}", f"操作:05忘记密码[安装库qrcode失败,错误:{e}]")
                                                    uuser.record_history()
                                                    label_提=tk.Label(qc,text=f"错误,导入 qrcode 库失败",font=('微软雅黑',8),bg='#ffd4d4',fg='black')
                                                    label_提.place(x=97,y=9)
                                                    qc.after(2600,label_提.destroy)

                        

                                                    # 尝试导入 Pillow 库
                                                    try:
                                                            from PIL import Image
                                                            #messagebox.showinfo("成功", "成功导入 Pillow 库.")
                                                    except ImportError as e:
                                                                #messagebox.showerror("错误", f"导入 Pillow 库失败: {e}")
                                                                label_提=tk.Label(qc,text=f"×导入pillow库失败",font=('微软雅黑',8),bg='#ffd4d4',fg='black')
                                                                label_提.place(x=97,y=9)
                                                                qc.after(2600,label_提.destroy)
                                 

                                               data = "密钥:"+str(passward)  # 您可以替换成任何URL或文本

                                               # 创建QRCode对象
                                               qr = qrcode.QRCode(
                                               version=1,  # 控制二维码的大小，1是最小尺寸
                                               error_correction=qrcode.constants.ERROR_CORRECT_L,  # 错误纠正级别，L为最低
                                               box_size=10,  # 控制二维码中每个小格子的大小
                                               border=4,  # 控制边框（空白区域）的宽度，默认为4
                                               )

                                               # 添加数据
                                               qr.add_data(data)
                                               qr.make(fit=True)

                                               # 创建图像
                                               img = qr.make_image(fill_color="black", back_color="white")

                                               # 保存图像到文件
                                               img.save(str(name)+"二维密钥.png")  # 将二维码保存为PNG文件
                                               if(弹窗_提示窗==[1,0]):
                                                   弹窗 = Tk()
                                                   弹窗.title("便利贴 OFFICE【PET/7.V.v】")
                                                   弹窗.attributes('-topmost',  True)
                                                 # 使用 ttk 创建一个框架 
                                                   frame = ttk.Frame(弹窗, padding="10 10 10 10")
                                                   frame.pack(fill="both",  expand=True)
                                               
                                              # 添加一个标签 
                                                   label = ttk.Label(frame, text='OFFICE 安全',font=("微软雅黑",13,"bold"))
                                                   label.place(x=3,y=1)
                                                   label2=ttk.Label(frame,text=f"已将验证码保存在系统同窗处",font=("微软雅黑",11))
                                                   label2.place(x=3,y=38)
                                                   def OK():
                                             
                                                     弹窗.destroy()
                                                   def on_closing():
                                                                        pass  # 不执行任何操作，阻止关闭 
                                                                     
                                                                    
                                                   弹窗.protocol("WM_DELETE_WINDOW",  on_closing)           

                                                   btn1=ttk.Button(frame,text="我知道了",comman=OK)
                                                   btn1.place(x=3,y=160,height=36,width=334)
                                                   # 设置窗口的初始位置（右下角坐标）
                                                   def place_window_to_bottom_right(root, window_width=360, window_height=220):
                                                                                # 获取屏幕的宽度和高度
                                                                                screen_width = root.winfo_screenwidth()
                                                                                screen_height = root.winfo_screenheight()

                                                                                # 计算窗口左上角的坐标
                                                                                x_coordinate = screen_width - window_width - 24  # 从右侧留出一点空间
                                                                                y_coordinate = screen_height - window_height - 94  # 从底部留出一点空间（考虑到任务栏）

                                                                                # 设置窗口的大小和位置
                                                                                弹窗.geometry(f"{window_width}x{window_height}+{x_coordinate}+{y_coordinate}")
                                                                               # 使用函数将窗口放置到右下角
                                                   place_window_to_bottom_right(弹窗)
                                               else:
                                                   
                                                    messagebox.showinfo("便利贴 OFFICE",f"已将验证码保存在系统同窗处")
                                                    
                                               current_time = datetime.now()
                                               lishii = "办达安全{忘记密码[传输了一组密钥]}"

                                               shenfen="用户"

                                               tongy="1"

                                               uuser = Account1(name, tongy, "{忘记密码[传输了一组密钥]}", "操作:05忘记密码[传输了一组二维密钥]")
                                               uuser.record_history()

                                        elif user_input != verification_code:
                                          cs+=1
                                          ydcs=ydcs-1
                                          current_time = datetime.now()
                                          lishii = "办达安全{忘记密码[检测到验证码有误]}"
                                          tongy="1"
                                       
                                          
                                     
                                          


                                          uuser = Account1(name, tongy, "{忘记密码[检测到验证码有误]}", "操作:05忘记密码[判断拦截中]")
                                          uuser.record_history()

                                          
                                          if(cs>=3):
                                               if(cs==5):
                                                        qc.destroy()
                                                        global namee
                                                        #qc.destroy()
                                                        roo= tk.Tk()
                                                        roo.resizable(False, False)
                                                        roo.title("便利贴 OFFICE【PET/7.V.v】")
                                                        def place_window_to_bottom_right(root, window_width=360, window_height=220):
                                                                            # 获取屏幕的宽度和高度
                                                                            screen_width = root.winfo_screenwidth()
                                                                            screen_height = root.winfo_screenheight()

                                                                            # 计算窗口左上角的坐标
                                                                            x_coordinate = screen_width - window_width - 24  # 从右侧留出一点空间
                                                                            y_coordinate = screen_height - window_height - 94  # 从底部留出一点空间（考虑到任务栏）

                                                                            # 设置窗口的大小和位置
                                                                            roo.geometry(f"{window_width}x{window_height}+{x_coordinate}+{y_coordinate}")
                                                                           # 使用函数将窗口放置到右下角
                                                        place_window_to_bottom_right(roo)
                                                        label15 = tkinter.Label(roo, text=""" ㄒoㄒ抱歉异常                                                               """,bg="dark orange",fg="white",font=("微软雅黑", 14))
                                                        label15.place(x=0,y=0)
                                                        label16 = tkinter.Label(roo, text="""          您的密码错误超过指定次数，已自动将您的账户冻结\n储存,如果您想继续使用可进行解冻账户与人机校验        





                                                                                                                """,bg="#FFB348",fg="white",font=("微软雅黑", 10))
                                                        label16.place(x=-47,y=33)
                                                        tongy = "0"
                                                
                                                        char_to_remove = "当前资金:"

                                                        # 使用 replace() 删除字符
                                                        
                                                        shenfen="用户{未知}"
                                                     
                                                        user=Account(name,passward,balance,"已被冻结",shenfen)
                                                        user.record()

                                                        cs=0
                                                        ydcs=5
                                                        namee=name


                                                        uuser = Account1(name,"0", "登录账号{被冻结}", "操作:03冻结{禁用账户}")
                                                        uuser.record_history()
                                                        
                                                        btn6=ttk.Button(roo,text="解冻账户",command=jiedong)
                                                        btn6.place(x=0,y=192,width=360)
                                               else:
                                                       label_提=tk.Label(qc,text=f"密码错误，您还有{ydcs}次机会",font=('微软雅黑',8),bg='#ffd4d4',fg='black')
                                                       label_提.place(x=86,y=9)
                                                       qc.after(2650,label_提.destroy)
                                                       verification_code = ''.join([str(random.randint(0, 9)) for _ in range(6)])
                                                       canva = tk.Canvas(qc, width=100, height=34)
                                                       canva.place(x=162, y=38, width=100, height=34)

                                                       colours = ["red", "orange", "green", "yellow", "purple", "grey", "pink", "black"]
                                                       theScreen = turtle.TurtleScreen(canva)
                                                       asd = turtle.RawTurtle(theScreen)

                                                       colours = ["red", "orange", "green", "yellow", "purple", "grey", "pink", "black"]
                                                   
                                                       asd.penup()
                                                       asd.goto(-30, -14)
                                                       asd.pendown()
                                                       asd.write(verification_code, font=("Arial", 13, "normal"))
                                                       asd.penup()
                                                       asd.goto(-33, -7)
                                                       asd.pendown()
                                                       b = random.randint(0, 7)
                                                       c = random.randint(8, 15)
                                                       asd.color(colours[b])
                                                       asd.write("-------------", font=("Arial", 11, "normal"))
                                                       asd.penup()
                                                       asd.goto(-33, -14)
                                                       asd.pendown()
                                                       asd.color(colours[c-8])
                                                       asd.write("————", font=("Arial", 11, "normal"))

                                                        
                                                      # tkinter.messagebox.showerror("系统消息:","密码错误，您还有"+str(ydcs)+"机会")
                                                   
                                          else:
                                                 

                                                 

                                                   #tkinter.messagebox.showerror("系统消息:","检测到验证码错误")
                                                   label_提=tk.Label(qc,text=f"密码错误，请确核验您的密码",font=('微软雅黑',8),bg='#ffd4d4',fg='black')
                                                   label_提.place(x=74,y=9)
                                                   qc.after(2650,label_提.destroy)
                                                   verification_code = ''.join([str(random.randint(0, 9)) for _ in range(6)])
                                                   canva = tk.Canvas(qc, width=100, height=34)
                                                   canva.place(x=162, y=38, width=100, height=34)

                                                   colours = ["red", "orange", "green", "yellow", "purple", "grey", "pink", "black"]
                                                   theScreen = turtle.TurtleScreen(canva)
                                                   asd = turtle.RawTurtle(theScreen)

                                                   colours = ["red", "orange", "green", "yellow", "purple", "grey", "pink", "black"]
                                               
                                                   asd.penup()
                                                   asd.goto(-30, -14)
                                                   asd.pendown()
                                                   asd.write(verification_code, font=("Arial", 13, "normal"))
                                                   asd.penup()
                                                   asd.goto(-33, -7)
                                                   asd.pendown()
                                                   b = random.randint(0, 7)
                                                   c = random.randint(8, 15)
                                                   asd.color(colours[b])
                                                   asd.write("-------------", font=("Arial", 11, "normal"))
                                                   asd.penup()
                                                   asd.goto(-33, -14)
                                                   asd.pendown()
                                                   asd.color(colours[c-8])
                                                   asd.write("————", font=("Arial", 11, "normal"))
                                     

                                    btn27 = ttk.Button(qc, text="确认", style='Custom.TButton', command=qr)
                                    btn27.place(x=20, y=180, width=240, height=40)
                                    check_buttonn = tk.Checkbutton(qc, text="并将二维密码保存到指定地址", variable=show_password, command=toggle_password_visibilityy)
                                    check_buttonn.place(x=20,y=226)
                            else:
                                qc.destroy()
                                global namee
                                #qc.destroy()
                                roo= tk.Tk()
                                roo.resizable(False, False)
                                roo.title("便利贴 OFFICE【PET/7.V.v】")
                                def place_window_to_bottom_right(root, window_width=360, window_height=220):
                                                    # 获取屏幕的宽度和高度
                                                    screen_width = root.winfo_screenwidth()
                                                    screen_height = root.winfo_screenheight()

                                                    # 计算窗口左上角的坐标
                                                    x_coordinate = screen_width - window_width - 24  # 从右侧留出一点空间
                                                    y_coordinate = screen_height - window_height - 94  # 从底部留出一点空间（考虑到任务栏）

                                                    # 设置窗口的大小和位置
                                                    roo.geometry(f"{window_width}x{window_height}+{x_coordinate}+{y_coordinate}")
                                                   # 使用函数将窗口放置到右下角
                                place_window_to_bottom_right(roo)
                                label15 = tkinter.Label(roo, text=""" ㄒoㄒ抱歉异常                                                               """,bg="dark orange",fg="white",font=("微软雅黑", 14))
                                label15.place(x=0,y=0)
                                label16 = tkinter.Label(roo, text="""          您的密码错误超过指定次数，已自动将您的账户冻结\n储存,如果您想继续使用可进行解冻账户与人机校验        





                                                                                        """,bg="#FFB348",fg="white",font=("微软雅黑", 10))
                                label16.place(x=0,y=33)
                                tongy = "0"
                        
                                char_to_remove = "当前资金:"

                                # 使用 replace() 删除字符
                                
                                shenfen="用户{未知}"
                             
                                user=Account(name,passward,balance,"已被冻结",shenfen)
                                user.record()

                                cs=0
                                ydcs=5
                                namee=name


                                uuser = Account1(name,"0", "登录账号{被冻结}", "操作:03冻结{禁用账户}")
                                uuser.record_history()
                                
                                btn6=ttk.Button(roo,text="解冻账户",command=jiedong)
                                btn6.place(x=0,y=192,width=360)

       


                            
                 def quxiao():
                           qc.destroy()

                     # 创建主窗口并设置标题和大小

                     # 创建一个水平进度条
                 progress = ttk.Progressbar(qc, orient="horizontal", length=240, mode='determinate')
                 progress.place(x=20,y=160)
                 btn25=ttk.Button(qc,text="提交用户名资料",style='Custom.TButton',command=tijiao)
                 btn25.place(x=20,y=200,width=140,height=40)
                 btn26=ttk.Button(qc,text="取消",style='Custom.TButton',command=quxiao)
                 btn26.place(x=180,y=200,width=80,height=40)
                 # 创建一个带有内边距的框架
                 frame = ttk.Frame(qc, padding="5")
                 #frame.grid(column=0, row=0, sticky=(tk.W, tk.E, tk.N, tk.S))
                 frame.place(x=10,y=70,width=260,height=90)
                 # 减小Listbox和Text控件的高度和宽度
                 file_listbox = tk.Listbox(frame, selectmode=tk.MULTIPLE, height=3, width=30)
                 file_listbox.grid(column=0, row=0, columnspan=2, pady=5, padx=5, sticky=(tk.W, tk.E))

                 # 设置网格权重以允许控件扩展
                 qc.columnconfigure(0, weight=1)
                 qc.rowconfigure(0, weight=1)
                 frame.columnconfigure(0, weight=1)
                 frame.columnconfigure(1, weight=1)
                 frame.rowconfigure(0, weight=1)
                 frame.rowconfigure(2, weight=1)
                 #qcccc.destroy()
                except Exception as e:
                                    # 打印错误信息和行号
                                    tb = traceback.extract_tb(sys.exc_info()[2])
                                    error_message = f"{e} (line {tb[-1].lineno})"
                                    print(f"报错: {error_message}")

            def zhuc():
             nonlocal entry11
           
             nonlocal label13
             global e
             global a
             global b
             global c
             global d,窗口填写信息
             nonlocal btn1
             nonlocal btn3
             nonlocal btn5
             nonlocal btn2
             nonlocal label11
             nonlocal label12
             nonlocal label13
             nonlocal entry11
             nonlocal entry13
             
             global btn222
             global btn2220
             name=entry11.get()
             pw=entry13.get()
             label11 = ttk.Label(dz, text="""
          创建你的办公区        
            """, font=("微软雅黑", 14,"bold"))
             label11.place(x=30,y=0)
          
             btn5.destroy()
             btn1.destroy()
             btn2.destroy()
             c=name


             style=ttk.Style()
             style.configure('fh.TButton',font=('微软雅黑',11))
             def 新建():
                 global 窗口填写信息
                 窗口填写信息=1
                 dz.destroy()
                 账户()
                 
             btn_提示=tkinter.Button(dz,text="<返回",font=("微软雅黑",11),borderwidth=-1,fg='black',bg='#EDEDED',activebackground='#cecfcb',command=新建)
             btn_提示.place(x=25,y=20,width=44,height=41)

                 
             if(name!="" and pw!=""):
                      
                      
                      try:
                          open(name+".rtf","r")
                          pass
                      except:
                               current_time = datetime.now()
                               

                               
                               tongy = "1"
                               lishi = "正在注册"
                               caozuo = "操作:02注册账户"
                               
                               uuser = Account1(name, tongy, lishi, caozuo)
                               uuser.record_history()  # 调用record_history方法
                                                      #print("系统提示:开始注册")
                               label11 = ttk.Label(dz, text="""
          创建你的办公区         
            """, font=("微软雅黑", 14,"bold"))
                               label11.place(x=30,y=0)
                               btn2=ttk.Button(dz,text="注册账号",style='Custom.TButton')
                               btn2.place(x=23,y=270,width=8,height=0)
          
                               #删除按钮
                               for i in range(90):
                                   btn1.destroy()
                                   btn2.destroy()
                               print(窗口填写信息)
                               if 窗口填写信息!=1:
                                   btn222.destroy()
                       
                               entry11.destroy()
                               entry13.destroy()
                               label11.destroy()
                               label12.destroy()
                               label13.destroy()
                               label13 = ttk.Label(dz, text="""请再次确认密码：
            """, font=("微软雅黑", 15))
                               label13.place(x=29,y=185)
                               label12 = ttk.Label(dz, text="""人机认证，请填写防伪码：
            """, font=("微软雅黑", 15))
                               label12.place(x=29,y=105)
                               entry13 = ttk.Entry(dz, font=("微软雅黑", 14))
                               entry13.bind('<Button-1>', lambda e: entry13.delete(0, tk.END))
                               entry13.place(x=30,y=225,width=260)
                               
                               a=random.randint(0,9)
                               b=random.randint(0,9)
                               c=random.randint(0,9)
                               d=random.randint(0,9)
                               e=a*1000+b*100+c*10+d
                               label13 = ttk.Label(dz, text="(@"+str(a)+"/"+str(b)+"&!}"+str(c)+"*%"+str(d)+"<>?^)", font=("微软雅黑", 15))
                               label13.place(x=60,y=70,width=260)
  
                               entry11 = ttk.Entry(dz,font=("微软雅黑", 14))
                               entry11.place(x=30,y=145,width=260)
                               entry11.bind('<Button-1>', lambda e: entry11.delete(0, tk.END))
                               def wanc():
                                    global e, a, b, c, d  # 确保这些全局变量可以在函数内使用
                                    global 姓名,弹窗_提示窗
                                    nonlocal name
                                    

                                    renzhen = entry11.get()
                                    mima = entry13.get()

                                    if renzhen and mima:  # 检查是否非空
                                        if int(renzhen) == e and mima == pw:
                                            tongy = "1"
                                            shenfen = "用户"

                                            # 创建 Account1 对象并记录历史
                                            uuser = Account1(name, tongy, "注册成功", "操作:02注册账户")
                                            uuser.record_history()

                                            uuserr = Account2(name,'暂无','暂无')
                                            uuserr.record_zhangben()

                                            # 创建 Account 对象并记录
                                            user = Account(name, pw, 0, "创建账户", shenfen)
                                            user.record()
                                            if(弹窗_提示窗==[1,0]):
                                                弹窗 = Tk()
                                                弹窗.title("便利贴 OFFICE【PET/7.V.v】")
                                                弹窗.attributes('-topmost',  True)
                                            # 使用 ttk 创建一个框架 
                                                frame = ttk.Frame(弹窗, padding="10 10 10 10")
                                                frame.pack(fill="both",  expand=True)
                                                
                                          
                                         # 添加一个标签 
                                                label = ttk.Label(frame, text="便利贴 OFFICE",font=("微软雅黑",13,"bold"))
                                                label.place(x=3,y=1)
                                                label2=ttk.Label(frame,text=f"注册/创建成功,已将您的账户信息保存在系统同窗处",font=("微软雅黑",11))
                                                label2.place(x=1,y=38)
                                                def OK():
                                                 global 姓名
                                                 nonlocal name
                                                 姓名=name
                                                 #print(姓名)
                                                 弹窗.destroy()
                                                 dz.destroy()
                                                 便利贴OFFICE()
                                              
                                                 
                                                def on_closing():
                                                        pass  # 不执行任何操作，阻止关闭 
                                                                     
                                                                    
                                                弹窗.protocol("WM_DELETE_WINDOW",  on_closing)
                                                   

                                                btn1=ttk.Button(frame,text="我知道了",comman=OK)
                                                btn1.place(x=3,y=160,height=36,width=334)
                                              # 设置窗口的初始位置（右下角坐标）
                                                def place_window_to_bottom_right(root, window_width=360, window_height=220):
                                                                                # 获取屏幕的宽度和高度
                                                                                screen_width = root.winfo_screenwidth()
                                                                                screen_height = root.winfo_screenheight()

                                                                                # 计算窗口左上角的坐标
                                                                                x_coordinate = screen_width - window_width - 24  # 从右侧留出一点空间
                                                                                y_coordinate = screen_height - window_height - 94  # 从底部留出一点空间（考虑到任务栏）

                                                                                # 设置窗口的大小和位置
                                                                                弹窗.geometry(f"{window_width}x{window_height}+{x_coordinate}+{y_coordinate}")
                                                                               # 使用函数将窗口放置到右下角
                                                place_window_to_bottom_right(弹窗)
                                            else:
                                                r=messagebox.showinfo("OFFICE 安全",f"注册/创建成功,已将您的账户信息保存在系统同窗处")
                                                if r=='ok':
                                                     姓名=name
                                                     #print(姓名)
                                                     弹窗.destroy()
                                                     dz.destroy()
                                                     便利贴OFFICE()
                                                    
                                                     
                                                     
                                        else:
                                            tongy = "1"
                                            shenfen = "用户"

                                            # 创建 Account1 对象并记录历史
                                            uuser = Account1(name, tongy, "注册有误", "操作:02注册账户")
                                            uuser.record_history()
                                            
                                            #tkinter.messagebox.showwarning("系统提示:", "防伪码或密码错误")
                                            label_提=tk.Label(dz,text=f"×防伪码或密码错误",font=('微软雅黑',8),bg='#ffd4d4',fg='black')
                                            label_提.place(x=109,y=7)
                                            dz.after(2500,label_提.destroy)
                                                   
                                            # 生成新的防伪码
                                            a, b, c, d = (random.randint(0, 9) for _ in range(4))
                                            e = a * 1000 + b * 100 + c * 10 + d
                                            label13.config(text="(@" + str(a) + "/" + str(b) + "&!}" + str(c) + "*%" + str(d) + "<>?^)")
                                    else:
                                        #tkinter.messagebox.showwarning("系统提示:", "您还未填写信息")
                                        label_提=tk.Label(dz,text=f" ! 你还未填写信息",font=('微软雅黑',8),bg='#ffe1a9',fg='black')
                                        label_提.place(x=109,y=7)
                                        dz.after(2500,label_提.destroy)
                                                                    
                               btn4=ttk.Button(dz,text="完成",style='Custom.TButton',command=wanc)
                               btn4.place(x=30,y=266,width=60,height=42)
                               label14 = ttk.Label(dz, text="我已阅读完",font=("微软雅黑", 13))
                               label14.place(x=90,y=273)
                               def xieyi():

                                        def create_protocol_window():
                                            # 创建一个新窗口
                                            protocol_window = tk.Tk()
                                            protocol_window.title("OFFICE 用户协议")
                                            protocol_window.geometry("400x400")
                                            protocol_window.resizable(width=False, height=False)

                                            # 创建滚动条
                                            scrollbar = tk.Scrollbar(protocol_window)
                                            scrollbar.pack(side=tk.RIGHT, fill=tk.Y)

                                            # 创建Text控件
                                            text_widget = tk.Text(protocol_window, wrap=tk.WORD, yscrollcommand=scrollbar.set)
                                            text_widget.pack(side=tk.LEFT, fill=tk.BOTH, expand=True)

                                            # 将滚动条与Text控件关联
                                            scrollbar.config(command=text_widget.yview)

                                            # 协议书内容
                                            protocol_text = """                      用户协议

小引：
                            欢迎使用[任务助手]！本协议（以下称“协议”）由[任务助手]制定，适用于您（及10+用户）使用我们提供的所有服务。
                            请在使用服务前仔细阅读并理解本协议的所有条款。通过访问或使用服务，您即表示接受并同意遵守本协议的所有条款和
                        条件。如果您不同意本协议的任何部分，请勿使用服务。

服务概述：
1. 接受条款
                            •年龄限制：您必须年满10周岁才能使用我们的服务。如果您未满13周岁，您必须在父母或法定监护人的监督下使用服务，
                            并且父母或法定监护人必须同意本协议。
                            •注册与账户：在使用某些功能时，您可能需要创建一个账户。使用的电脑版本为【win10-win11】,并且您承诺在注册过
                            程中提供真实、准确、最新的信息，并同意维护信息的最新状态。您有责任保护您的账户安全，不应向任何人透露您的
                            账户信息。您对所有使用您的账户发生的活动负责。
                            •账户暂停与终止：我们保留因违反本协议而暂停或终止您账户的权利，包括但不限于涉嫌欺诈、滥用服务、违反法律或道
                            德规范的行为。账户暂停或终止可能会影响您对服务的访问和使用。
2. 内容与行为准则
                            •内容上传与使用：您上传至服务的内容应合法，不得侵犯任何第三方的知识产权或其他权利。您不得上传含有病毒、恶意
                            软件、色情材料或诽谤性言论的内容。您对上传内容的合法性和适当性负责。
                            •行为准则：您在使用服务时应尊重其他用户，不得从事骚扰、威胁或恐吓他人的行为，包括但不限于种族歧视、性别歧视
                            、宗教歧视或性取向歧视。我们鼓励建设性交流和积极互动。•内容审核与移除：我们有权不经通知删除我们认为不当或违
                            法的内容。我们不承担监控所有用户上传内容的责任，但我们保留采取适当行动的权利，以维护服务的安全和健康环境。
3. 服务使用
                            •服务可用性：我们努力确保服务的可用性，但不保证服务的不间断、及时性或无错误。服务可能包含广告和其他第三方材
                            料，我们不对这些内容负责。我们保留随时修改、暂停或终止服务的权利，无需事先通知。
                            •服务费用：某些功能可能需要付费。您使用付费功能前，我们将明确告知相关费用。我们保留调整服务价格的权利。
                            •技术支持与客户服务：我们将尽力提供技术支持和客户服务，但不保证即时响应或解决问题的时间。技术支持可能受到资
                            源限制。
4. 版权与许可
                            •用户内容：您保留对自己上传内容的所有权，但授予我们非独家的、全球性的、永久的、不可撤销的、免费的使用权，以
                            展示、复制、修改、分发和以其他方式利用内容。我们鼓励原创内容，但不承担验证内容原创性的责任。
                            •第三方内容：服务可能包含不属于公司的内容，这些内容的版权属于其各自的所有者。您不得在未经版权所有人明确许可
                            的情况下使用这些内容。•商标与品牌：我们所有的商标、徽标和品牌特征均受法律保护。未经我们书面许可，您不得使用
                            这些标识。
5. 隐私政策
                            •个人信息保护：我们承诺按照隐私政策保护您的个人信息。使用服务即表示您授权我们收集、使用和披露必要的信息，包
                            括但不限于提供服务、改进用户体验和遵守法律要求。
                            •数据安全：我们采取合理措施保护您的个人信息免受未经授权的访问、使用或披露。然而，互联网传输和电子存储的安全
                            性不能保证绝对安全。
                            •第三方数据分享：我们可能需要与第三方服务提供商共享您的信息，以提供服务或履行合同义务。我们要求第三方遵守严
                            格的数据保护标准。
6. 免责声明与责任限制
                            •服务使用风险：我们不对服务的准确性、完整性或适用性作任何保证。使用服务的风险由您自行
                            承担。
                            •责任限制：在适用法律允许的最大范围内，我们不对因使用或无法使用服务而产生的任何间接、附带、特殊或惩罚性损害
                            承担责任，包括但不限于利润损失、数据丢失或商业中断。
                            •免责声明：我们不对第三方网站或服务的可用性、内容或准确性负责。您访问或使用第三方网站或服务的风险由您自行承
                            担。
7. 法律适用与争议解决
                            •法律适用：本协议受[所在国家或地区]法律管辖。
                            •争议解决：任何因本协议引起的或与之相关的争议应首先尝试友好协商解决。如果协商不成，争议应提交至[所在地]法院
                            解决。
                            •仲裁条款：在适用法律允许的情况下，双方同意将争议提交至有管辖权的仲裁机构进行最终裁决，而不是法院诉讼。
8. 修改条款
                            •协议变更：我们保留在任何时候修改本协议的权利。修改后的条款将在网站上公布，并在发布后生效。继续使用服务即表
                            示您接受修订后的条款。
                            •通知：我们将通过电子邮件或在服务上发布通知的方式向您发送重要通知，包括协议变更通知。
9. 其他条款
                            •整合条款：本协议构成您与我们之间关于服务使用的完整协议。本协议取代先前所有口头或书面的协议。
                            •分割性：如果本协议的任何条款被认定为无效，其余条款仍然有效。•放弃权利：我们未能行使或执行本协议的任何权利
                            或规定，不应视为放弃该权利或规定。
                            •联系信息：如有任何疑问，请联系我们的客户服务部门。
小结:
                            如果您对以上协议保持赞成态度，可以选择完成进行注册。感谢您的支持与谅解。更多了解拨打：13735578201。
                            
                                """

                                            # 插入协议书内容
                                            text_widget.insert(tk.END, protocol_text)

                                            # 禁止编辑Text控件
                                            text_widget.config(state=tk.DISABLED)

                                            # 运行窗口的主循环
                                            protocol_window.mainloop()

                                        # 主程序入口
                                        if __name__ == "__main__":
                                            create_protocol_window()

                               btn5=tkinter.Button(dz,text="协议",font=("微软雅黑",13),borderwidth=0,fg="#0074D9",width=40,height=40,command=xieyi)
                               btn5.place(x=177,y=268,width=40,height=40)
                               label15 = ttk.Label(dz, text=",并同意。",font=("微软雅黑", 13))
                               label15.place(x=214,y=273)

                      else:
                          if 窗口填写信息==2:
                              btn222.destroy()
                              窗口填写信息-=1
                          窗口填写信息+=1
                         
                          btn222=ttk.Button(dz,text="下一步",style='Custom.TButton',command=zhuc)
                          btn222.place(x=37,y=240,width=246,height=40)
                          btn2220+=1
                         
                          #print("系统提示:已经存在了这个项目！")
                          #tkinter.messagebox.showwarning("系统提示:","您的账户在系统中被重名")
                          label_提=tk.Label(dz,text=f" ! 您的账户在系统中被重名",font=('微软雅黑',8),bg='#ffe1a9',fg='black')
                          label_提.place(x=94,y=7)
                          dz.after(2900,label_提.destroy)
             else:
                         
                         if 窗口填写信息==2:
                              #print(1)
                              btn222.destroy()
                              窗口填写信息-=1
                         窗口填写信息+=1
                     
                         btn222=ttk.Button(dz,text="下一步",style='Custom.TButton',command=zhuc)
                         btn222.place(x=37,y=240,width=246,height=40)
                         btn2220+=1
                         #tkinter.messagebox.showwarning("系统提示:","请先在窗口处填写信息")
                         label_提=tk.Label(dz,text=f" ! 请现在窗口处填写信息",font=('微软雅黑',8),bg='#ffe1a9',fg='black')
                         label_提.place(x=94,y=7)
                         
                         dz.after(2900,label_提.destroy)
            dagouu=0
            sssss=0

            def jiedong():
                global verification_code,姓名,弹窗_提示窗
                verification_code = ''.join([str(random.randint(0, 9)) for _ in range(6)])
                global sssss
                sssss=0
                qc = tk.Tk()
                qc.title("OFFICE 安全")
                qc.geometry("285x280")  # 进一步缩小窗口大小
                qc.resizable(False, False)
                qr_label = tk.Label(qc)
                qr_label.place(x=20, y=120)
                # 重新创建新的控件
                entry23 = ttk.Entry(qc, font=("微软雅黑", 10))
                entry23.place(x=20, y=40, width=134, height=30)
                entry23.insert(0, "请输入右式验证码")
                entry23.bind('<Button-1>', lambda e: entry23.delete(0, tk.END))

                # 生成随机数作为验证码
                #verification_code = ''.join([str(random.randint(0, 9)) for _ in range(6)])
                canva = tk.Canvas(qc, width=100, height=34)
                canva.place(x=170, y=38, width=100, height=34)

                progress = ttk.Progressbar(qc, orient="horizontal", length=248, mode='determinate')
                progress.place(x=20,y=78)


                # 可以在这里检测是否安装库等


                colours = ["red", "orange", "green", "yellow", "purple", "grey", "pink", "black"]
                theScreen = turtle.TurtleScreen(canva)
                asd = turtle.RawTurtle(theScreen)
                asd.penup()
                asd.goto(-30, -14)
                asd.pendown()
                asd.write(verification_code, font=("Arial", 13, "normal"))
                asd.penup()
                asd.goto(-33, -7)
                asd.pendown()
                b = random.randint(0, 7)
                c = random.randint(8, 15)
                asd.color(colours[b])
                asd.write("-------------", font=("Arial", 11, "normal"))
                asd.penup()
                asd.goto(-33, -14)
                asd.pendown()
                asd.color(colours[c-8])
                asd.write("————", font=("Arial", 11, "normal"))

                def toggle_password_visibilityy():
                         nonlocal dagouu
                         global sssss
                         if(sssss==0):
                             dagouu+=1
                             sssss=1
                         else:
                             dagouu-=1
                             sssss=0
                def qr():
                    
                    global namee,cs,ydcs,弹窗_提示窗,姓名
                    name=namee
                    nonlocal dagouu
                    import importlib
                    import subprocess
                    import sys
                    from tkinter import messagebox
                    global verification_code
                    def install_and_import(package, package_name_for_install=None):
                        """Install and import the given package if it's not already available."""
                        package_name_for_install = package_name_for_install or package
                        
                        try:
                            # Try to import the module
                            importlib.import_module(package)
                        except ImportError:
                            response = messagebox.askyesno("缺少库", f"库 {package} 未安装。是否要现在安装？")
                            if response:
                                try:
                                    # Install the package using pip
                                    subprocess.check_call([sys.executable, "-m", "pip", "install", package_name_for_install])
                                    #messagebox.showinfo("安装完成", f"{package_name_for_install} 安装完成")
                                    label_提=tk.Label(qc,text=f"安装完成,{package_name_for_install} 安装完成",font=('微软雅黑',8),bg='#bfffa9',fg='black')
                                    label_提.place(x=78,y=9)
                                    qc.after(2900,label_提.destroy)
                                    
                                    # Import the module after installation
                                    globals()[package] = importlib.import_module(package)
                                except subprocess.CalledProcessError as e:
                                    #messagebox.showerror("安装错误", f"安装 {package_name_for_install} 时发生错误: {e}")
                                    label_提=tk.Label(qc,text=f"安装错误,安装 {package_name_for_install} 时发生错误",font=('微软雅黑',8),bg='#ffd4d4',fg='black')
                                    label_提.place(x=70,y=9)
                                    qc.after(3300,label_提.destroy)
                                    sys.exit(1)  # Exit program to prevent subsequent code from crashing due to missing library
                            else:
                                #messagebox.showerror("手动安装", f"请手动安装 {package_name_for_install} 后再运行此程序。")
                                label_提=tk.Label(qc,text=f"手动安装,请手动安装 {package_name_for_install} 后再运行此程序。",font=('微软雅黑',8),bg='#ffd4d4',fg='black')
                                label_提.place(x=64,y=9)
                                qc.after(3600,label_提.destroy)
                                    
                                sys.exit(1)

                    def ensure_libraries_installed():
                        """Ensure all required libraries are installed."""
                        required_libraries = {
                            'cv2': 'opencv-python',
                            'PIL': 'Pillow',  # 注意：导入时使用的是 from PIL import Image
                            'PyPDF2': 'PyPDF2',
                            'reportlab': 'reportlab'
                        }

                        for package, package_name_for_install in required_libraries.items():
                            install_and_import(package, package_name_for_install)

                    def show_message(title, message, msg_type='info'):
                        """Display a message box with the given title and message."""
                        if msg_type == 'info':
                            messagebox.showinfo(title, message)
                        elif msg_type == 'warning':
                            messagebox.showwarning(title, message)
                        elif msg_type == 'error':
                            messagebox.showerror(title, message)

                    # 在程序启动时调用该函数以确保所有必需的库都已安装
                    ensure_libraries_installed()

                    # 现在可以正常使用所需的模块
                    try:
                        from PyPDF2 import PdfWriter, PdfReader
                        import cv2
                        from PIL import Image
                        from reportlab.lib.pagesizes import letter
                        from reportlab.pdfgen import canvas
                    except ImportError as e:
                        #show_message("导入错误", f"即使尝试安装后，仍无法导入某些库。请检查您的环境配置: {e}", 'error')
                        label_提=tk.Label(qc,text=f"导入错误,即使尝试安装后，仍无法导入某些库。请检查您的环境配置。",font=('微软雅黑',8),bg='#ffd4d4',fg='black')
                        label_提.place(x=54,y=9 )
                        qc.after(4000,label_提.destroy)
                        
                        sys.exit(1)

                    # 检查并显示 OpenCV 版本信息
     
                    try:

                        pass
                    except NameError:
                        #show_message("导入错误", "即使尝试安装后，仍无法导入 cv2。请检查您的环境配置。", 'error')
                        label_提=tk.Label(qc,text=f"导入错误,即使尝试安装后，仍无法导入 cv2。请检查您的环境配置。",font=('微软雅黑',8),bg='#ffd4d4',fg='black')
                        label_提.place(x=54,y=9)
                        qc.after(4000,label_提.destroy)
                        sys.exit(1)
                               
                    
                    try:
                       
                        from PyPDF2 import PdfWriter, PdfReader
                        import cv2
                        from PIL import Image
                        from reportlab.lib.pagesizes import letter
                        from reportlab.pdfgen import canvas
                        
                        
                    except ImportError as e:
                        #messagebox.showerror("导入错误", f"即使尝试安装后，仍无法导入某些库。请检查您的环境配置: {e}")
                        label_提=tk.Label(qc,text=f"导入错误,即使尝试安装后，仍无法导入 cv2。请检查您的环境配置。",font=('微软雅黑',8),bg='#ffd4d4',fg='black')
                        label_提.place(x=54,y=9)
                        qc.after(4000,label_提.destroy)
                        sys.exit(1)
                   
                    
                    name = namee
                    
                    user_input = entry23.get().strip()

                    if user_input == verification_code:
                        i = 48
                        progress['value'] = i
                        qc.update_idletasks()

                        if dagouu == 1:
                                #messagebox.showinfo("系统消息:", "正在预备中")
                                label_提=tk.Label(qc,text=f" ! 正在预备中",font=('微软雅黑',8),bg='#ffe1a9',fg='black')
                                label_提.place(x=114,y=9)
                                qc.after(2500,label_提.destroy)

                                # 打开摄像头
                                cap = cv2.VideoCapture(0)
                                if not cap.isOpened():
                                    #show_message("摄像头错误", "无法打开摄像头", 'error')
                                    label_提=tk.Label(qc,text=f"×摄像头错误,无法打开摄像头",font=('微软雅黑',8),bg='#ffd4d4',fg='black')
                                    label_提.place(x=78,y=9)
                                    qc.after(2900,label_提.destroy)
                                    sys.exit(1)

                                ret, frame = cap.read()
                                if not ret:
                                    #show_message("图像读取错误", "无法读取图像", 'error')
                                    label_提=tk.Label(qc,text=f"×图像读取错误,无法读取图像",font=('微软雅黑',8),bg='#ffd4d4',fg='black')
                                    label_提.place(x=78,y=9)
                                    qc.after(2900,label_提.destroy)
                                    sys.exit(1)

                                image_path = 'photo.jpg'
                                try:
                                    cv2.imwrite(image_path,  frame)
                                except cv2.error  as e:
                                    label_提 = tk.Label(qc, text=f"×图像保存错误: {e}", font=('微软雅黑', 8), bg='#ffd4d4', fg='black')
                                    label_提.place(x=78, y=9)
                                    qc.after(3000,  label_提.destroy)
                                    cap.release() 
                                    sys.exit(1) 
                         
                                cap.release() 

                                pdf_path = f'{name} photo_protected.pdf'
                                c = canvas.Canvas(pdf_path, pagesize=letter)
                                width, height = letter
                                c.drawImage(image_path, 72, 72, width=width-144, height=height-144)
                                c.showPage()
                                c.save()

                                with open(pdf_path, 'rb') as input_pdf:
                                    pdf_reader = PdfReader(input_pdf)
                                    pdf_writer = PdfWriter()
                                    for page in pdf_reader.pages:
                                        pdf_writer.add_page(page)
                                    verification_code = ''.join([str(random.randint(0, 9)) for _ in range(8)])
                                    pdf_writer.encrypt(user_password=verification_code)
                                    print(str(verification_code))

                                    with open(pdf_path, 'wb') as output_pdf:
                                        pdf_writer.write(output_pdf)

                                i = 100
                                progress['value'] = i
                                qc.update_idletasks()
                                s = f"PDF格式密码为: {verification_code}"
                                file_listbox.insert(tk.END, s)
                                os.remove("photo.jpg")
                                if(弹窗_提示窗==[1,0]):
                                    弹窗 = Tk()
                                    弹窗.title("便利贴 OFFICE【PET/7.V.v】")
                                    弹窗.attributes('-topmost',  True)
                                  # 使用 ttk 创建一个框架 
                                    frame = ttk.Frame(弹窗, padding="10 10 10 10")
                                    frame.pack(fill="both",  expand=True)
                                
                               # 添加一个标签 
                                    label = ttk.Label(frame, text="OFFICE 安全",font=("微软雅黑",13,"bold"))
                                    label.place(x=3,y=1)
                                    label2=ttk.Label(frame,text=f"操作完成,\n备份图像已保存为带密码保护的\nPDF:{pdf_path}",font=("微软雅黑",11))
                                    label2.place(x=3,y=38)
                                    def OK():
                              
                                      弹窗.destroy()
                                    def on_closing():
                                        pass  # 不执行任何操作，阻止关闭 
                                                                
                                                                    
                                    弹窗.protocol("WM_DELETE_WINDOW",  on_closing)

                                    btn1=ttk.Button(frame,text="我知道了",comman=OK)
                                    btn1.place(x=3,y=160,height=36,width=334)
                                    # 设置窗口的初始位置（右下角坐标）

                                    def place_window_to_bottom_right(root, window_width=360, window_height=220):
                                                # 获取屏幕的宽度和高度
                                                screen_width = root.winfo_screenwidth()
                                                screen_height = root.winfo_screenheight()

                                                # 计算窗口左上角的坐标
                                                x_coordinate = screen_width - window_width - 24  # 从右侧留出一点空间
                                                y_coordinate = screen_height - window_height - 94  # 从底部留出一点空间（考虑到任务栏）

                                                # 设置窗口的大小和位置
                                                弹窗.geometry(f"{window_width}x{window_height}+{x_coordinate}+{y_coordinate}")
                                               # 使用函数将窗口放置到右下角
                                    place_window_to_bottom_right(弹窗)
                                else:
                                    messagebox.showinfo("OFFICE 安全",f"操作完成,\n备份图像已保存为带密码保护的\nPDF:{pdf_path}")
                               
                                f = open(name + ".rtf", "r")
                                ff = open(name + "主控记录" + ".rtf", "r")
                                lines = f.readlines()
                                line = lines[-1]
                                lineList = line.split(",")
                                liness = ff.readlines()
                                linee = liness[-1]
                                lineListt = linee.split(",")
                                tongy = "1"

                              
                                
                                passward=lineList[1]
                                passward=passward.split('密码:')
                                passward=passward[1]
                                #print(passward)
                                balance = lineList[2].replace("当前资金:", "")
                                shenfen = "用户"
                                user = Account(name, passward, balance, "已解冻", shenfen)
                                user.record()
                                uuser = Account1(name, tongy, "OFFICE 安全{已解冻}", f"操作:01解冻{{并使用相机保存图像|设置代开密钥:{verification_code}}}")
                                uuser.record_history()
                                if(弹窗_提示窗==[1,0]):
                                    弹窗c = Tk()
                                    弹窗c.title("便利贴 OFFICE【PET/7.V.v】")
                                    弹窗c.attributes('-topmost',  True)
                                  # 使用 ttk 创建一个框架 
                                    frame = ttk.Frame(弹窗c, padding="10 10 10 10")
                                    frame.pack(fill="both",  expand=True)
                                
                               # 添加一个标签 
                                    label = ttk.Label(frame, text="OFFICE 安全",font=("微软雅黑",13,"bold"))
                                    label.place(x=3,y=1)
                                    label2=ttk.Label(frame,text=f"操作完成,\n请重启程序以解冻账户",font=("微软雅黑",11))
                                    label2.place(x=3,y=38)
                                    def OK():
                                      qc.destroy()
                                      弹窗c.destroy()
                                    def on_closing():
                                        pass  # 不执行任何操作，阻止关闭 
                                                                
                                                                    
                                    弹窗c.protocol("WM_DELETE_WINDOW",  on_closing)

                                    btn1=ttk.Button(frame,text="我知道了",comman=OK)
                                    btn1.place(x=3,y=160,height=36,width=334)
                                    # 设置窗口的初始位置（右下角坐标）

                                    def place_window_to_bottom_right(root, window_width=360, window_height=220):
                                                # 获取屏幕的宽度和高度
                                                screen_width = root.winfo_screenwidth()
                                                screen_height = root.winfo_screenheight()

                                                # 计算窗口左上角的坐标
                                                x_coordinate = screen_width - window_width - 24  # 从右侧留出一点空间
                                                y_coordinate = screen_height - window_height - 94  # 从底部留出一点空间（考虑到任务栏）

                                                # 设置窗口的大小和位置
                                                弹窗c.geometry(f"{window_width}x{window_height}+{x_coordinate}+{y_coordinate}")
                                               # 使用函数将窗口放置到右下角
                                    place_window_to_bottom_right(弹窗c)
                                else:
                                   
                                    r=messagebox.showinfo("OFFICE 安全",f"操作完成,\n请重启程序以解冻账户")
                                    if r=='ok':
                                        qc.destroy()
                            
                        else:
                            #messagebox.showerror("系统消息:", "无法执行后期命令")
                            label_提=tk.Label(qc,text=f"×无法执行后期命令",font=('微软雅黑',8),bg='#ffd4d4',fg='black')
                            label_提.place(x=97,y=9)
                            qc.after(2600,label_提.destroy)
                    else:
                        cs += 1
                        ydcs -= 1
                        i = 33
                        progress['value'] = i
                        qc.update_idletasks()
                        if cs >= 3:
                            #messagebox.showerror("系统消息:", "检测到验证码错误")
                            label_提=tk.Label(qc,text=f"×检测到验证码错误",font=('微软雅黑',8),bg='#ffd4d4',fg='black')
                            label_提.place(x=97,y=9)
                            qc.after(2600,label_提.destroy)
                            
                            verification_code = ''.join([str(random.randint(0, 9)) for _ in range(6)])
                            update_verification_code_display(verification_code)
                        else:
                            verification_code = ''.join([str(random.randint(0, 9)) for _ in range(6)])
                            update_verification_code_display(verification_code)
                            #messagebox.showerror("系统消息:", "检测到验证码错误")
                            label_提=tk.Label(qc,text=f"×检测到验证码错误",font=('微软雅黑',8),bg='#ffd4d4',fg='black')
                            label_提.place(x=97,y=9)
                            qc.after(2600,label_提.destroy)

                def update_verification_code_display(code):
                    canva = tk.Canvas(qc, width=100, height=34)
                    canva.place(x=170, y=38, width=100, height=34)
                    colours = ["red", "orange", "green", "yellow", "purple", "grey", "pink", "black"]
                    theScreen = turtle.TurtleScreen(canva)
                    asd = turtle.RawTurtle(theScreen)
                    asd.penup()
                    asd.goto(-30, -14)
                    asd.pendown()
                    asd.write(code, font=("Arial", 13, "normal"))
                    asd.penup()
                    asd.goto(-33, -7)
                    asd.pendown()
                    b = random.randint(0, 7)
                    c = random.randint(8, 15)
                    asd.color(colours[b])
                    asd.write("-------------", font=("Arial", 11, "normal"))
                    asd.penup()
                    asd.goto(-33, -14)
                    asd.pendown()
                    asd.color(colours[c-8])
                    asd.write("————", font=("Arial", 11, "normal"))
               
                btn27 = ttk.Button(qc, text="确认", style='Custom.TButton', command=qr)
                btn27.place(x=20, y=194, width=250, height=40)
                check_buttonn = tk.Checkbutton(qc, text="确认后授权相机拍摄记录", variable=show_password, command=toggle_password_visibilityy)
                check_buttonn.place(x=20,y=236)
                frame = ttk.Frame(qc, padding="5")
               
                frame.place(x=10,y=100,width=300,height=90)
                # 减小Listbox和Text控件的高度和宽度
                file_listbox = tk.Listbox(frame, selectmode=tk.MULTIPLE, height=5, width=35)
                file_listbox.grid(column=0, row=0, columnspan=2, pady=5, padx=5, sticky=(tk.W, tk.E))

            def toggle_password_visibility():
                nonlocal entry13
                if show_password.get():
                    entry13.config(show='')
                else:
                    entry13.config(show='·')
            label11 = ttk.Label(dz, text="""
             办公区向导           
            """, font=("微软雅黑", 14, "bold"))
            label11.place(x=29,y=6)

            #label11.pack_forget() 
            label12 = ttk.Label(dz, text="""账户：
            """, font=("微软雅黑", 14))
            label12.place(x=32,y=75)
            entry11 = ttk.Entry(dz,font=("微软雅黑", 15))
            entry11.place(x=36,y=110)
            label13 = ttk.Label(dz, text="""密码：
            """, font=("微软雅黑", 14))
            label13.place(x=32,y=149)
            entry13 = ttk.Entry(dz, font=("微软雅黑", 15,"bold"),show='·')
            entry13.place(x=36,y=185)



            btn1=ttk.Button(dz,text="进入任务",style='Custom.TButton',command=dengl)
            btn1.place(x=36,y=265,width=245,height=40)


            btn2=tkinter.Button(dz,text="注册账户",font=("微软雅黑 Light",13,"bold"),borderwidth=0,fg="#FFB348",command=zhuc)
            btn2.place(x=192,y=219,width=110,height=40)


            btn3=tkinter.Button(dz,text="客服助理",font=("微软雅黑 Light",13,"bold"),borderwidth=0,fg="#FFB348",command=kefzl)
            btn3.place(x=105,y=330,width=106,height=40)



            btn5=tkinter.Button(dz,text="我忘记了PIN",font=("微软雅黑 Light",13,"bold"),borderwidth=0,fg="#FFB348",command=wangji)
            btn5.place(x=31,y=219,width=106,height=40)

            btn6=tkinter.Button(dz,text="注销账户",font=("微软雅黑 Light",13,"bold"),borderwidth=0,fg="#FFB348",command=zhuxiao)
            btn6.place(x=193,y=70,width=106,height=40)

                    
            show_password = tk.BooleanVar()
            show_password.set(False)  # 默认不显示密码
            check_button = tk.Checkbutton(dz, text="显示密码", font=("april",10),fg="#0592E8",variable=show_password, command=toggle_password_visibility)
            check_button.place(x=206,y=156)

            dz.mainloop()

        def 便利贴OFFICE():





                                          
                                            global 姓名,windows

                                            name=姓名
                                            
                                            word = tkinter.Tk()
                                           
                                            word.title("便利贴 0FFiCE【PET/7.V.v】")
                                            word.geometry("473x417")
                                            word.resizable(True, False)  # 禁止
                                          
                                            uuser = Account1(name, '1', "生成主页", "操作:06运行{生成主页代码}")
                                            uuser.record_history()
                                            提示标签=0
                                            worddd=0
                                            备份_备份i=0
                                            
                 
                                         

                                            

                                                        
                                            def save_as():
                                                global 文本
                                                nonlocal 旬报
                                                global 姓名
                                                name=姓名
                                                
                                                global 文本 
                                                file_path = filedialog.asksaveasfilename(defaultextension=".json",  filetypes=[("Text Files", "*.txt"), ("All Files", "*.*"), ("RTF Document", "*.rtf")])
                                                if file_path:
                                                    文本 = file_path
                                                    save()
                                                旬报=txt_edit.get('1.0',tk.END)
                                                文本 = os.path.basename(文本) 
                                                if(文本!=""):
                                                    word.title(文本+"-便利贴 OFFICCE【PET/7.V.v】")
                                                
                                                uuser = Account1(name, '1', "另存标签文件:"+str(文本), "操作:10文件{重命名文件并定义格式}")
                                                uuser.record_history()
                                                
                                            def save():
                                                global 文本 
                                                global 旬报
                                                global 姓名
                                                name=姓名
                                               
                                             
                                                if 文本 != "":
                                                    try:
                                                        # 获取文本内容 
                                                        content = txt_edit.get('1.0',  tk.END).strip()
                                                        
                                                        # 获取文本格式信息 
                                                        format_info = []
                                                        for tag in txt_edit.tag_names(): 
                                                            ranges = txt_edit.tag_ranges(tag) 
                                                            while ranges:
                                                                start = ranges[0]
                                                                end = ranges[1]
                                                                format_info.append({ 
                                                                    "tag": tag,
                                                                    "start": str(start),
                                                                    "end": str(end),
                                                                    "config": txt_edit.tag_cget(tag,  "font"),
                                                                    "color": txt_edit.tag_cget(tag,  "foreground")
                                                                })
                                                                ranges = ranges[2:]
                                             
                                                        # 创建一个包含文本内容和格式信息的字典
                                                        data = {
                                                            "content": content,
                                                            "format_info": format_info
                                                        }
                                             
                                                        # 将数据保存到文件
                                                        with open(文本, 'w', encoding='utf-8') as file:
                                                            json.dump(data,  file, ensure_ascii=False, indent=4)
                                             
                                                        旬报 = content
                                                        文本 = os.path.basename(文本) 
                                                        word.title( 文本 + "-便利贴 OFFICE【PET/7.V.v】")
                                                        
                                                        uuser = Account1(name, '1', "保存标签文件:"+str(文本), "操作:10文件{重命名文件/定义格式}")
                                                        uuser.record_history()
                                                    except Exception as e:
                                                        tb = traceback.extract_tb(sys.exc_info()[2]) 
                                                        error_message = f"{e} (line {tb[-1].lineno})"
                                                        print(f"报错: {error_message}")
                                                        messagebox.showerror(" 保存失败", f"保存文件时发生错误: {error_message}")
                                                else:
                                                    save_as()
                                            def new_bq():
                                                global 文本
                                                nonlocal 旬报
                                                global 姓名
                                                name=姓名
                                                txt_edit.config(state=tk.NORMAL) 
                                                try:
                                                    txt_edit.config(state=tk.NORMAL) 
                                                    if(txt_edit.get('1.0',  tk.END)!=旬报):
                                                        response = messagebox.askyesno(" 确认", "需要保存原文件吗？") 
                                                        if response: 
                                                            save()
                                                        
                                                    # 无论是否保存原文件，都清空文本框内容并更新窗口标题 
                                                    txt_edit.delete('1.0',  tk.END)
                                                    旬报=txt_edit.get('1.0',tk.END)
                                                    word.title(" 新建文本-便利贴 OFFICE【PET/7.V.v】")
                                                    menu_bar.entryconfig('编辑',  state='normal')
                                                    文本 = os.path.basename(文本) 
                                                    uuser = Account1(name, '1', "新建标签:"+str(文本), "操作:10文件{生成新文档}")
                                                    uuser.record_history()
                                                except Exception as e:
                                                        # 打印错误信息和行号
                                                        tb = traceback.extract_tb(sys.exc_info()[2])
                                                        error_message = f"{e} (line {tb[-1].lineno})"
                                                        print(f"报错: {error_message}")
                                            
                                            
                                                
                                                    
                                                    
                                                
                                                
                                            def dak():
                                                global 文本,a
                                                nonlocal 旬报
                                                global 姓名
                                                name=姓名
                                                try:
                                                    uuser = Account1(name, '1', "打开文件标签{正选择}", "操作:10文件{读取文本文档}")
                                                    uuser.record_history()
                                                    if(txt_edit.get('1.0',  tk.END)!=旬报):
                                                        response = messagebox.askyesno("确认", "需要保存原文件吗？")
                                                        if response:
                                                            #print("用户选择了是")
                                                            with(open(文本,"w",encoding='utf-8')) as file:
                                                                file.write(txt_edit.get('1.0',tk.END))
                                                                txt_edit.delete('1.0',tk.END)
                                                    
                                                    #文本对话框打开模式
                                                    def load():
                                                        global 文本
                                                        file_path = filedialog.askopenfilename(filetypes=[("Text Files", "*.txt"), ("All Files", "*.*"), ("RTF Document", "*.rtf")])
                                                        if file_path:
                                                            try:
                                                                with open(file_path, 'r', encoding='utf-8') as file:
                                                                    data = json.load(file) 
                                                                    content = data.get("content",  "")
                                                                    format_info = data.get("format_info",  [])
                                                     
                                                                    # 清空文本框
                                                                    txt_edit.delete('1.0',  tk.END)
                                                     
                                                                    # 插入文本内容
                                                                    txt_edit.insert(tk.END,  content)
                                                     
                                                                    # 恢复格式
                                                                    for info in format_info:
                                                                        tag = info["tag"]
                                                                        start = info["start"]
                                                                        end = info["end"]
                                                                        config = info.get("config",  "Arial 12")
                                                                        color = info.get("color",  "black")
                                                     
                                                                        # 配置标签
                                                                        txt_edit.tag_configure(tag,  font=config, foreground=color)
                                                                        txt_edit.tag_add(tag,  start, end)
                                                     
                                                                    文本 = file_path
                                                                    文本 = os.path.basename(文本) 
                                                                    word.title( 文本 + "-便利贴 OFFICE【PET/7.V.v】")
                                                                    menu_bar.entryconfig('编辑',  state='normal')
                                                                    uuser = Account1(name, '1', "打开文件标签{选择完毕}", "操作:10文件{输出文本内容}")
                                                                    uuser.record_history()
                                                                    
                                                            except Exception as e:
                                                                tb = traceback.extract_tb(sys.exc_info()[2]) 
                                                                error_message = f"{e} (line {tb[-1].lineno})"
                                                                print(f"报错: {error_message}")
                                                                messagebox.showerror(" 加载失败", f"加载文件时发生错误: {error_message}")
                                                     
                                                    load()
                                                    
                                                   
                                                    旬报=txt_edit.get('1.0',tk.END)
                                                except Exception as e:
                                                        # 打印错误信息和行号
                                                        tb = traceback.extract_tb(sys.exc_info()[2])
                                                        error_message = f"{e} (line {tb[-1].lineno})"
                                                        print(f"报错: {error_message}")
                                            工作时长 = [0, 0, 0]
                                            工作判 = True
                                      
                                            时=0
                                            分=0
                                            秒=0
                                            def 工作时间():
                                                nonlocal 工作时长,工作判
                                                if(工作判==True):
                                                    工作时长[2]+=1
                                                    if(工作时长[2]>59):
                                                        工作时长[2]=0
                                                        工作时长[1]+=1
                                                        if(工作时长[1]>59):
                                                            工作时长[0]+=1
                                                            工作时长[1]=0
                                                    #print(工作时长)
                                                    
                                                    word.after(1000,工作时间)
                                                else:
                                                    return
                                            工作时间()
                                                
                                            def close():
                                                
                                                global 文本, a, 姓名 
                                                nonlocal 旬报, 工作时长, 工作判,分,秒,时
                                                name=姓名
                                                try:
                                                    if 姓名 != "":
                                                    # 当前工作时长 
                                                        时 = int(工作时长[0])
                                                        分 = int(工作时长[1])
                                                        秒 = int(工作时长[2])
                                                        timee=时+分+秒
                                                        f=open(name+'.rtf','r')
                                                        a=f.readlines()
                                                        b=a[-1]
                                                        b=b.split(',')
                                                        c=b[2]
                                                        c=c.split('当前资金:')
                                                        c=c[1]
                                                        c=list(c)
                                                        if(len(c)==1):
                                                            c=[0,'时',0,'分',0,'秒']
                                                        i=0
                                                 
                                                        pw=b[1]
                                                        pw=pw.split('密码:')
                                                        
                                                        pw=pw[1]
                                                        
                                                        import re 
     
                                                        def extract_time_units(lst):
                                                            # 将列表转换为字符串 
                                                            lst_str = ''.join(map(str, lst))
                                                            
                                                            # 使用正则表达式匹配数字和单位 
                                                            pattern = r'(\d+)(时|分|秒)'
                                                            matches = re.findall(pattern,  lst_str)
                                                            
                                                            # 初始化变量 
                                                            时时 = None 
                                                            分分 = None 
                                                            秒秒 = None 
                                                            
                                                            # 处理匹配结果 
                                                            for match in matches:
                                                                value, unit = match 
                                                                if unit == '时':
                                                                    时时 = int(value)
                                                                elif unit == '分':
                                                                    分分 = int(value)
                                                                elif unit == '秒':
                                                                    秒秒 = int(value)
                                                            
                                                            return 时时, 分分, 秒秒 
                                                         
                                                        # 示例列表 
                                                        my_list =c                                                     
                                                        # 提取时间单位 
                                                        时时, 分分, 秒秒 = extract_time_units(my_list)
                                                    


                                                        时=时+int(时时)
                                                        分=int(分分)+分
                                                        秒=int(秒秒)+秒
                                                        if(秒>59):
                                                            秒-=60
                                                            分+=1
                                                        if(分>59):
                                                            分-=60
                                                            时+=1
                                                            
                                                        timme=str(时)+"时"+str(分)+"分"+str(秒)+"秒"
                                                        工作时长[0]=时
                                                        工作时长[1]=分
                                                        工作时长[2]=秒
                                                        shenfen = "用户"

                                                        tongy="1"
                                                        uuser = Account1(姓名, tongy, "退出登录", "操作:06运行{关闭窗口代码}")
                                                        uuser.record_history()



                                                        # 创建 Account 对象并记录
                                                        user = Account(name, pw,timme , "退出登录", shenfen)
                                                        user.record()
                                                         
                                                    
                                                    if txt_edit.get('1.0',  tk.END) != 旬报:
                                                        uuser = Account1(name, '1', "退出登录{正选择}", "操作:06运行{退出保存代码}")
                                                        uuser.record_history()
                                                        response = messagebox.askyesno(" 确认", "需要保存原文件吗？")
                                                        if response:
                                                            save()
                                                           
                                                    
                                                except Exception as e:
                                                    tb = traceback.extract_tb(sys.exc_info()[2]) 
                                                    error_message = f"{e} (line {tb[-1].lineno})"
                                                    print(f"报错: {error_message}")
                                             
                                                word.destroy()
                                                工作判 = False 
                                                return 
                                             
                                            # 绑定窗口关闭事件到自定义函数 
                                            word.protocol("WM_DELETE_WINDOW",  close)

                                            def jq():
                                                global 剪切文本
                                                global 姓名
                                                name=姓名
                                                try:
                                                    剪切文本=txt_edit.get(tk.SEL_FIRST,tk.SEL_LAST)
                                                    txt_edit.delete(tk.SEL_FIRST,tk.SEL_LAST)
                                                    uuser = Account1(name, '1', f"剪切文本", "操作:08编辑{剪切扫过文本}")
                                                    uuser.record_history()
                                                except:
                                                    pass
                                                
                                            def fz():
                                                global 剪切文本
                                                global 姓名
                                                name=姓名
                                                try:
                                                    剪切文本=txt_edit.get(tk.SEL_FIRST,tk.SEL_LAST)
                                                    uuser = Account1(name, '1', f"复制文本", "操作:08编辑{复制扫过文本}")
                                                    uuser.record_history()
                                                except:
                                                    pass
                                            def zt():
                                                global 剪切文本
                                                global 姓名
                                                name=姓名
                                                if 剪切文本:
                                                    txt_edit.insert(tk.INSERT,剪切文本)
                                                    uuser = Account1(name, '1', f"粘贴文本", "操作:08编辑{粘贴扫过文本}")
                                                    uuser.record_history()
                                                #print(剪切文本)
                                            def 帮助():
                                                #特别的 different
                                                         global 姓名
                                                         name=姓名
                                                         uuser = Account1(name, '1', "客服助理{正咨询}", "操作:06运行{文本帮助代码}")
                                                         uuser.record_history()
                                                         def 查看订单状态():
                                                             
                                                             结果文本框.delete('1.0', tk.END)
                                                             结果文本框.insert(tk.END, """文件操作

新建与关闭

新建标签：点击菜单栏中的“文件”->“新建”，或者使用快捷键Ctrl+N，可以创建一个新的空白文本标签。

新建提示标签：点击“文件”->“新建提示标签”，或者使用快捷键Ctrl+Shift+N，可以创建一个新的提示标签，用于记录提醒事项。

关闭文件：点击“文件”->“关闭”，或者使用快捷键Ctrl+W，可以关闭当前打开的文件。如果文本有改动，会提示用户是否保存。


打开与保存

打开文件：点击“文件”->“打开”，或者使用快捷键Ctrl+O，可以选择并打开本地的文本文件。

保存文件：点击“文件”->“保存”，或者使用快捷键Ctrl+S，可以将当前编辑的文本保存到本地。如果是新文件，则会弹出“另存为”对话框。

另存为：点击“文件”->“另存为”，可以将当前编辑的文本以指定的文件名和格式保存到本地。支持的文件格式包括文本文件（.txt）、RTF文档（.rtf）等。
""")

                                                         def 产品信息():
                                                             
                                                             结果文本框.delete('1.0', tk.END)
                                                             结果文本框.insert(tk.END, """文本编辑

基本操作

剪切：选中需要剪切的文本，然后点击“编辑”->“剪切”，或者使用快捷键Ctrl+X，可以将选中的文本剪切到剪贴板。

复制：选中需要复制的文本，然后点击“编辑”->“复制”，或者使用快捷键Ctrl+C，可以将选中的文本复制到剪贴板。

粘贴：将光标放在需要粘贴的位置，然后点击“编辑”->“粘贴”，或者使用快捷键Ctrl+V，可以将剪贴板中的文本粘贴到当前位置。

撤销：点击“编辑”->“撤销”，或者使用快捷键Ctrl+Z，可以撤销最近的一次操作。
""")
                                                         def 联系客服():
                                                             
                                                             结果文本框.delete('1.0', tk.END)
                                                             结果文本框.insert(tk.END, """字体设置

选择字体：点击“格式”->“字体”，会弹出字体设置对话框，用户可以在其中选择字体类型、大小、颜色等属性。

加粗：选中需要加粗的文本，然后点击工具栏上的“加粗”按钮，或者使用快捷键Ctrl+B，可以将选中的文本设置为加粗。

斜体：选中需要斜体的文本，然后点击工具栏上的“斜体”按钮，或者使用快捷键Ctrl+I，可以将选中的文本设置为斜体。


颜色设置

设置文本颜色：选中需要设置颜色的文本，然后点击工具栏上的“文本颜色”按钮，选择所需的颜色。

设置填充颜色：点击工具栏上的“填充颜色”按钮，选择所需的颜色，可以为文本编辑框设置不同的填充颜色。
""")
                                                         def 注销账户():
                                                             
                                                             结果文本框.delete('1.0', tk.END)
                                                             结果文本框.insert(tk.END, """行数检测

显示行数

鼠标所在行数：当鼠标移动到某一行时，状态栏会显示当前鼠标所在的行数。

光标所在行数：当光标移动到某一行时，状态栏会显示当前光标所在的行数。

""")

                                                         def 注册失败():
                                                             
                                                             结果文本框.delete('1.0', tk.END)
                                                             结果文本框.insert(tk.END, """模板功能

使用模板

选择模板：点击“文件”->“模版”，会弹出模板选择对话框，用户可以选择需要的模板，如个人简历、读后感、一封信、奖状等。

生成模板内容：点击相应的模板按钮，软件会自动生成模板内容，用户可以直接使用或进行修改。

""")
                                                         def 找账号():
                                                             
                                                             结果文本框.delete('1.0', tk.END)
                                                             结果文本框.insert(tk.END, """形状插入

插入形状：点击“插入”->“形状”，会弹出形状选择对话框，用户可以选择需要插入的形状，如正方形、三角形、圆形等。
""")
                                                         def 人工客服():
                                                             
                                                             结果文本框.delete('1.0', tk.END)
                                                             结果文本框.insert(tk.END, """提醒功能

录入提醒

设置提醒：点击“工具”->“录入”，会弹出提醒设置对话框，用户可以设置提醒的时间、地点和事件。

检测提醒：软件会在后台运行检测，到达设定时间时弹出消息提醒用户。

挂起提醒：点击“工具”->“挂起”，可以暂时停止提醒任务。

关闭提醒：点击“工具”->“关闭”，可以永久关闭提醒任务。

""")
                                                         def 退出应用():
                                                             结果文本框.delete('1.0', tk.END)
                                                             结果文本框.insert(tk.END, """排版功能

左对齐：选中需要左对齐的文本，然后点击工具栏上的“左对齐”按钮，可以将选中的文本设置为左对齐。

居中对齐：选中需要居中对齐的文本，然后点击工具栏上的“居中对齐”按钮，可以将选中的文本设置为居中对齐。

右对齐：选中需要右对齐的文本，然后点击工具栏上的“右对齐”按钮，可以将选中的文本设置为右对齐。

""")
                                                         def 人工():
                                                             结果文本框.delete('1.0', tk.END)
                                                             结果文本框.insert(tk.END, """人工客服，请拨打：13735578201""")
                                                         def 退出():
                                                             窗口.destroy()
                                                         def 创建按钮(文字, 命令):
                                                             按钮 = ttk.Button(窗口, text=文字, width=11, command=命令)
                                                             按钮.pack(pady=1)
                                                         

                                                         窗口 = tk.Tk()
                                                         窗口.title("OFFICE 客户服务")
                                                         窗口.geometry("340x340")  # 调整窗口高度以适应更小的文本框
                                                         窗口.resizable(False, False) 
                                                         # 创建 Text 控件用于显示结果，调整高度和宽度
                                                         结果文本框 = tk.Text(窗口, wrap=tk.WORD, height=3, width=22)  # 减小高度和宽度
                                                         结果文本框.pack(side=tk.LEFT, fill=tk.BOTH, expand=True)
                                                         #结果文本框.config(state=tk.DISABLED) 
                                                         # 创建垂直滚动条并绑定到 Text 控件
                                                         滚动条 = ttk.Scrollbar(窗口, command=结果文本框.yview)
                                                         滚动条.pack(side=tk.RIGHT, fill=tk.Y)
                                                         结果文本框.config(yscrollcommand=滚动条.set)

                                                         创建按钮("文件操作", 查看订单状态)
                                                         创建按钮("文本编辑", 产品信息)
                                                         创建按钮("文本设置", 联系客服)
                                                         创建按钮("提醒功能", 人工客服)
                                                         创建按钮("模板配置", 注册失败)
                                                         创建按钮("追踪显示", 注销账户)
                                                         创建按钮("形状插入",找账号)
                                                         创建按钮("文本排版", 退出应用)
                                                         创建按钮("人工客服", 人工)
                                                         创建按钮("      退出      ", 退出)
                                                         窗口.mainloop()

                                                
                                                
                                            def js():
                                                global ffont
                                                wordd = tk.Tk()
                                                wordd.title("OFFICE 介绍")
                                                wordd.geometry("340x340") 
                                                wordd.resizable(False, False)
                                                global 姓名
                                                name=姓名
                                                uuser = Account1(name, '1', "介绍{正查看}", "操作:06运行{输出介绍文本代码}")
                                                uuser.record_history()
                                                # 定义字体 

                                             
                                                # 创建文本编辑框并设置布局 
                                                txt_edit = tk.Text(wordd, wrap='none', width=46, height=25, undo=True)
                                                txt_edit.place(x=0,  y=0)
                                             
                                                # 创建垂直滚动条并与文本编辑框关联 
                                                v_scrollbar = tk.Scrollbar(wordd, orient=tk.VERTICAL, command=txt_edit.yview) 
                                                v_scrollbar.pack(side=tk.RIGHT,  fill=tk.Y)
                                                txt_edit.config(yscrollcommand=v_scrollbar.set) 
                                                txt_edit.delete('1.0',tk.END)
                                                # 插入文本并设置字体 
                                                s = """便利贴 OFFiCE 软件介绍

随着现代办公环境的不断发展，人们对于办公软件的
需求也在不断提升。传统的办公软件虽然功能强大，
但在某些方面仍然无法满足用户日益增长的需求。为
了填补这一空白，便利贴 OFFiCE 应运而生。本文将
详细介绍便利贴 OFFiCE 的功能、特点、应用场景以
及未来发展。

一、软件概述
便利贴 OFFiCE 是一款集便签、日历、提醒、文件管
理等多种功能于一体的高效办公软件。它旨在帮助用
户更好地组织和管理日常工作和生活，提高工作效率
。软件采用了简洁明了的用户界面设计，使得用户可
以快速上手，无需复杂的培训即可高效使用。

二、主要功能

1. 便签功能
便利贴 OFFiCE 的核心功能之一便是便签功能。用户
可以在软件中创建多个便签，用于记录各种信息，如
会议纪要、待办事项、灵感笔记等。每个便签都可以
设置不同的颜色和字体，以便用户更好地分类和识别
。

2. 日历功能
软件内置的日历功能可以帮助用户更好地管理时间。
用户可以在日历中添加各种事件，如会议、约会、
生日等，并设置提醒，以免错过重要的活动。此外，
日历还支持多种视图模式，如日视图、周视图和月
视图，方便用户根据不同需求查看日程安排。

3. 提醒功能
便利贴 OFFiCE 的提醒功能非常强大。用户可以为
每个便签或日历事件设置提醒，提醒方式包括声音
提醒、弹窗提醒和邮件提醒等。此外，软件还支持
重复提醒功能，用户可以设置每日、每周、每月或
自定义的提醒频率，确保不会错过任何重要事项。

4. 文件管理功能
为了方便用户管理各种文件，便利贴 OFFiCE 还集
成了文件管理功能。用户可以在软件中创建文件夹
，上传和下载各种文件，如文档、图片、音频等。
此外，软件还支持文件共享功能，用户可以将文件
共享给其他用户，方便团队协作。

5. 数据同步功能
便利贴 OFFiCE 支持跨平台数据同步功能。用户可
以在不同设备上登录同一个账号，所有数据将会自
动同步，确保用户在任何地方都可以访问到最新的
信息。目前，软件支持Windows、MacOS、iOS和
Android等多个平台。

三、软件特点

1. 简洁易用的界面
便利贴 OFFiCE 采用了简洁明了的用户界面设计，
使得用户可以快速上手，无需复杂的培训即可高效
使用。软件的主界面分为多个区域，每个区域都有
明确的功能标识，用户可以根据需要快速找到所需
功能。

2. 强大的功能集成
除了基本的便签功能外，便利贴 OFFiCE 还集成了
日历、提醒、文件管理等多种实用功能，帮助用户
更好地组织和管理日常工作和生活。这些功能相互
配合，形成了一套完整的办公解决方案。

3. 跨平台支持
为了满足不同用户的需求，便利贴 OFFiCE 支持
Windows、MacOS、iOS和Android等多个平台。用户
可以在不同设备间无缝切换，保持工作的连续性。

4. 数据安全保护
我们非常重视用户的数据安全，便利贴 OFFiCE
采用了先进的加密技术，确保用户的数据不会被泄
露或篡改。此外，软件还支持备份和恢复功能，用
户可以定期备份数据，以防数据丢失。

5. 智能分类与搜索
便利贴 OFFiCE 具备智能分类和搜索功能，用户可
以通过关键词快速查找所需信息，大大提高工作效
率。此外，软件还支持标签功能，用户可以为每个
便签或文件添加标签，方便分类和管理。

四、应用场景

1. 办公场景
在办公场景中，便利贴 OFFiCE 可以帮助用户更好
地组织和管理日常工作。用户可以使用便签功能记
录会议纪要、待办事项等，使用日历功能管理日程
安排，使用提醒功能确保不会错过任何重要事项，
使用文件管理功能管理各种文件。

2. 学习场景
在学习场景中，便利贴 OFFiCE 可以帮助学生更好
地管理学习计划和笔记。学生可以使用便签功能记
录课堂笔记、作业要求等，使用日历功能管理学习
计划，使用提醒功能确保按时完成作业，使用文件
管理功能管理各种学习资料。

3. 生活场景
在生活场景中，便利贴 OFFiCE 可以帮助用户更好
地管理日常生活。用户可以使用便签功能记录购物
清单、旅行计划等，使用日历功能管理家庭活动，
使用提醒功能确保不会忘记重要的日期，使用文件
管理功能管理各种生活资料。

五、未来发展
未来，我们将继续关注用户反馈，不断完善和升级
便利贴 OFFiCE。具体来说，我们计划在以下几个
方面进行改进和发展：

1. 增加更多实用功能
我们将根据用户需求，增加更多实用功能，如语音
输入、手写笔记、思维导图等，进一步提升用户体
验。

2. 优化性能和稳定性
我们将持续优化软件的性能和稳定性，确保用户在
使用过程中不会遇到卡顿、崩溃等问题。

3. 加强数据安全保障
我们将继续加强数据安全保障措施，采用更先进的
加密技术和备份机制，确保用户数据的安全。

4. 扩展平台支持
我们将继续扩展平台支持，计划在未来推出Linux
版本，满足更多用户的需求。

5. 推出企业版
我们将推出企业版便利贴 OFFiCE，增加更多针对企
业用户的功能，如团队协作、项目管理等，帮助企
业提高工作效率。

六、结语
总之，便利贴 OFFiCE 是一款功能强大、易于使用
的高效办公软件。它不仅可以帮助用户更好地组织
和管理日常工作和生活，还可以提高工作效率，提
升生活质量。我们相信，随着不断的改进和发展，
便利贴 OFFiCE 将成为更多用户信赖的办公助手。
    """
                                                
                                                # 插入文本并设置字体 
                                                txt_edit.insert(tk.END,  s, 'custom_font')
                                                txt_edit.config(state=tk.DISABLED) 

                                            def mb():
                                                wordd=tkinter.Tk()
                                                wordd.title("OFFICE 生成")
                                                wordd.geometry("240x270")
                                                wordd.resizable(False, False)
                                                global 姓名
                                                name=姓名
                                                uuser = Account1(name, '1', "生成模板{正选择}", "操作:06运行{生成模板代码}")
                                                uuser.record_history()
                                                
                                                def me():
                                                    new_bq()
                                                    a="""
                             个人简历                           
 [            ]                                                 
 ---------------------------------------------------------------
 <         >                                                    
                                                                
                                                                
                                                                
                                                                
 <         >                                                    
                                                                
                                                                
                                                                
                                                                
                                                               
 <         >
                                                                 
                                                                
                                                                
                                                                
                                                               
 <         >   
 --------------------------------------------------------------
                                                                


                                                                              
 ______________________________________________________________


 """  
                                                    txt_edit.insert(tk.END,a)
                                                    global 姓名
                                                    name=姓名
                                                    uuser = Account1(name, '1', "生成模板{选择完毕:个人简介}", "操作:06运行{输出介绍模板代码}")
                                                    uuser.record_history()
                                                def read():
                                                    new_bq()
                                                    a="""
                              读后感     
 《            》        
  -------------------------------------------------------------




 ____________





 ____________





 ____________






 --------------------------------------------------------------





 ______________________________________________________________"""
                                                    txt_edit.insert(tk.END,a)
                                                    global 姓名
                                                    name=姓名
                                                    uuser = Account1(name, '1', "生成模板{选择完毕:读后感}", "操作:06运行{输出介绍模板代码}")
                                                    uuser.record_history()
                                                def news():
                                                    new_bq()
                                                    a="""
                                一封信     
  ________你好:          
          





















                                                     -------

                                                   
  _____________________________________________________________"""
                                                    txt_edit.insert(tk.END,a)
                                                    global 姓名
                                                    name=姓名
                                                    uuser = Account1(name, '1', "生成模板{选择完毕:一封信}", "操作:06运行{输出介绍模板代码}")
                                                    uuser.record_history()
                                                def good():
                                                    new_bq()
                                                    a="""
                                奖状                  
  ________同(学)志 ,


                              表现优异.以资鼓励。
  _____________________________________________________________"""
                                                    txt_edit.insert(tk.END,a)
                                                    global 姓名
                                                    name=姓名
                                                    uuser = Account1(name, '1', "生成模板{选择完毕:奖状}", "操作:06运行{输出介绍模板代码}")
                                                    uuser.record_history()


                                                    
                                                button1=ttk.Button(wordd,text="""|   个人简历    |
|[     ]            |
|---------------|
|< >             |
|< >             |
|_______________|""",command=me)
                                                button1.place(x=6,y=3,width=110)
                                                button2=ttk.Button(wordd,text="""|     读后感     |
|《     》        |
|---------------|
|_____             |
|_____             |
|_______________|""",command=read)
                                                button2.place(x=120,y=3,width=110)
                                                button3=ttk.Button(wordd,text="""|     一封信     |
|__你好:          |
|   _____________|
|_______________|
|_______________|
|           --xxx |
|_______________|""",command=news)
                                                button3.place(x=6,y=123,width=110)
                                                #print(文本)
                                                button3=ttk.Button(wordd,text="""|       奖状       |
|__你好:           | 
|   ____同(学)志 |
|________________|
|______表现优异 |
|           --xxx  |
|________________|""",command=good)
                                                button3.place(x=120,y=123,width=110)

                                                
                                                
                                            
                                            
                                                                                            
                                            def Undo():
                                            
                                                try:
                                                     txt_edit.edit_undo()
                                                except:
                                                    pass
                                            
                                            
                                            #定义字体  size是字号   slant="italic"斜体   weight="normal"加粗
                                           # font_F=font.Font(family="宋体",size=10)

                                            global 弹窗_提示窗
                                            try:
                                                screen_width=word.winfo_screenwidth()
                                     
                                            except:
                                                tkinter. messagebox.showerror("便利贴 OFFICE",f"品牌异常,\n检测到您正使用非windows计算机部分功能将出现不可估异常")
                                               
                                           
                                            # 创建一个文本编辑框并设置布局 
                                            txt_edit = tk.Text(word, wrap='none',width=45,font=('微软雅黑',11),height=19,undo=True)
                                            txt_edit.place(x=47,  y=3)
                                          
                                             
                                            # 创建垂直滚动条并与文本编辑框关联
                                            v_scrollbar = tk.Scrollbar(word, orient=tk.VERTICAL, command=txt_edit.yview) 
                                            v_scrollbar.pack(side=tk.RIGHT,  fill=tk.Y)
                                            txt_edit.config(yscrollcommand=v_scrollbar.set) 
                                             
                                                                                       
                                                   


                                            #检测鼠标所在行数
                                            def get_mouse_line(event=None):
                                                # 获取鼠标位置对应的文本索引
                                                mouse_index = txt_edit.index(f"@{event.x},{event.y}")
                                                
                                                # 解析出行号
                                                line_number = int(mouse_index.split('.')[0])
                                                
                                                # 更新标签显示当前行数
                                                line_label.config(text=f"Mouse: {line_number}")

                                            # 绑定鼠标移动事件
                                            txt_edit.bind("<Motion>", get_mouse_line)
                                            # 创建标签用于显示鼠标所在的行数
                                            line_label = tk.Label(word, text="Mouse:")
                                            line_label.place(x=307,y=391)





                                            #检测光标所在行数
                                            def update_cursor_line(event=None):
                                                # 获取光标位置对应的文本索引
                                                cursor_index = txt_edit.index("insert")
                                                
                                                # 解析出行号
                                                line_number = int(cursor_index.split('.')[0])
                                                
                                                # 更新标签显示当前光标所在行数
                                                line_label2.config(text=f"Ln: {line_number}")
                                            
                                            
                                            # 绑定事件以在光标移动时更新行数显示
                                            txt_edit.bind("<KeyRelease>", update_cursor_line)  # 键盘输入后更新
                                            txt_edit.bind("<ButtonRelease-1>", update_cursor_line)  # 鼠标点击后更新

                                            # 初始化窗口状态
                                            last_state = word.wm_state()
                                            
                                            def on_configure(event):
                                                nonlocal last_state
                                                global 频道
                                                current_state = word.wm_state() 
                                                
                                                if current_state != last_state:
                                                    if current_state == 'zoomed':
                                                        # 获取屏幕的宽度
                                                        screen_width = word.winfo_screenwidth() 
                                                        if 频道 == '00':
                                                            # 根据屏幕宽度设置 txt_edit 的宽度
                                                            txt_edit.config(width=int(screen_width  / 7)-58)  # 假设每个字符的平均宽度为7像素
                                                        else:
                                                            return
                                                    else:
                                                        # 恢复默认宽度
                                                        txt_edit.config(width=45) 
                                                    
                                                    last_state = current_state
 
                                 
                                            
                                             
                                            # 绑定 <Configure> 事件
                                            word.bind('<Configure>',  on_configure)
                                             
                                           
                                            # 创建标签用于显示光标所在的行数
                                            line_label2 = tk.Label(word, text="Ln: ")
                                            line_label2.place(x=7,y=390)
                                            # 初始化显示光标所在行数
                                            update_cursor_line()

                                            def new_tsbqq():
                                                新建()
                                            # 创建菜单栏
                                            menu_bar = tk.Menu(word)
                                            # 文件菜单
                                            file_menu = tk.Menu(menu_bar, tearoff=0)
                                            file_menu.add_command(label="新建文本文档 Ctrl+n", command=new_bq)
                                            file_menu.add_command(label="新建标签文档 Ctrl+shift+N", command=new_tsbqq)
                                           
                                            
                                            

                                            #file_menu.add_command(label="新建窗口 Ctrl+shift+n", command=window)
                                            
                                            file_menu.add_separator()
                                            file_menu.add_command(label="打开 Ctrl+o", command=dak)
                                            
                                            
                                            file_menu.add_command(label="保存 Ctrl+s", command=save)
                                            file_menu.add_command(label="另存为 Ctrl+Shift+s", command=save_as)
                                            file_menu.add_command(label="撤回 Ctrl+z",command=Undo)
                                            file_menu.add_separator()
                                            file_menu.add_command(label="关闭", command=close)
                                            menu_bar.add_cascade(label="文件", menu=file_menu)
                                            word.bind('<Control-z>', lambda event:Undo())
                                            word.bind('<Control-o>', lambda event: dak())
                                            word.bind('<Control-Shift-n>', lambda event: new_tsbqq())
                                            word.bind('<Control-s>', lambda event:save())
                                            word.bind('<Control-n>', lambda event: new_bq())
                                            word.bind('<Control-Shift-s>', lambda event: save_as())
                                            #word.bind('<Control-Shift-d>', lambda event: close())
                                            #word.bind('<Control-Shift-N>', lambda event: window())







                                            
                                            # 编辑菜单
                                            edit_menu = tk.Menu(menu_bar, tearoff=0)
                                            #添加子菜单栏
                                            about_menu = tk.Menu(edit_menu, tearoff=0)
                                            edit_menu.add_cascade(label="字体", menu=about_menu)

                                            # 定义字体
                                            font_F2222 = font.Font(family="Microsoft YaHei", size=10,weight="normal")
                                            font_F2223= font.Font(family="Microsoft YaHei", size=10,slant="italic")

                                            font_F2 = font.Font(family="Microsoft YaHei", size=10)  # 等线
                                            font_F111 = font.Font(family="Microsoft YaHei Light", size=10)  # 等线 Light
                                            font_F3 = font.Font(family="STZhongsong", size=10)  # 华文中宋
                                            font_F4 = font.Font(family="Microsoft YaHei", size=10)  # 微软雅黑
                                            font_F5 = font.Font(family="STXinwei", size=10)  # 华文新魏
                                            font_F6 = font.Font(family="STLiti", size=10)  # 华文隶书
                                            font_F7 = font.Font(family="FZYaoti", size=10)  # 方正姚体
                                            font_F8 = font.Font(family="FZShuTi", size=10)  # 方正舒体
                                            font_F9 = font.Font(family="FZCuHeiSong-S01", size=10)  # 方正粗黑宋简体
                                            font_F10 = font.Font(family="FZLanTingHei-X-GBK", size=10)  # 方正兰亭超细黑简体
                                            font_F11 = font.Font(family="SimHei", size=10)  # 黑体
                                            font_F12 = font.Font(family="FangSong", size=10)  # 仿宋
                                            font_F13 = font.Font(family="STCaiyun", size=10)  # 华文彩云
                                            font_F14 = font.Font(family="STFangsong", size=10)  # 华文仿宋
                                            font_F15 = font.Font(family="STHupo", size=10)  # 华文琥珀
                                            font_F16 = font.Font(family="STKaiti", size=10)  # 华文楷体
                                            font_F17 = font.Font(family="STSong", size=10)  # 华文宋体
                                            font_F18 = font.Font(family="STXihei", size=10)  # 华文细黑
                                            font_F19 = font.Font(family="STXingkai", size=10)  # 华文行楷
                                            font_F20 = font.Font(family="KaiTi", size=10)  # 楷体
                                            font_F21 = font.Font(family="LiSu", size=10)  # 隶书
                                            font_F22 = font.Font(family="NSimSun", size=10)  # 新宋体
                                            font_F23 = font.Font(family="YouYuan", size=10)  # 幼圆
                                            font_F24 = font.Font(family="SimSun", size=10)  # 宋体
                                            font_F44 = font.Font(family="微软雅黑 Light", size=10)  # 宋体
                                            font_F441 = font.Font(slant="italic", size=10)  # 宋体
                                            font_F442 = font.Font(weight="normal", size=10)  # 宋体

                                            # 创建菜单栏
                                            
                                            def 华文中宋():

                                                    #index 方法用于指定或获取文本中的位置。
                                                    #get 方法用于获取文本框内的文本内容。
                                                    #tk.SEL_FIRST 选取选中头部 tk.SEL_LAST 选取选中尾部
                                                    
                                                global ffont,Font
                                                
                                                try:
                                                    a=txt_edit.index(tk.SEL_FIRST)
                                                    b=txt_edit.index(tk.SEL_LAST)
                                                    new_font=font.Font(family="华文中宋",size=ffont)
                                                    txt_edit.tag_add("new_font",a,b)
                                                    txt_edit.tag_config("new_font",font=new_font)
                                                    global Font
                                                    Font="华文中宋"
                                                    global 姓名
                                                    name=姓名
                                                    uuser = Account1(name, '1', f"调整字体{Font}", "操作:08编辑{改变文本字体}")
                                                    uuser.record_history()
                                                    
                                                except:
                                                    return
                         



                                            def 微软雅黑Light():
                                                global ffont,Font
                                                try:
                                                    a=txt_edit.index(tk.SEL_FIRST)
                                                    b=txt_edit.index(tk.SEL_LAST)
                                                    new_font=font.Font(family="微软雅黑 Light",size=ffont)
                                                    txt_edit.tag_add("new_font",a,b)
                                                    txt_edit.tag_config("new_font",font=new_font)
                                                    global Font
                                                    Font="微软雅黑"
                                                    global 姓名
                                                    name=姓名
                                                    uuser = Account1(name, '1', f"调整字体{Font}", "操作:08编辑{改变文本字体}")
                                                    uuser.record_history()
                                                except:
                                                    return
              
                                            # 添加菜单项和关联字体及命令
                                            def 华文新魏():
                                                global ffont,Font
                                                try:
                                                    a=txt_edit.index(tk.SEL_FIRST)
                                                    b=txt_edit.index(tk.SEL_LAST)
                                                    new_font=font.Font(family="华文新魏",size=ffont)
                                                    txt_edit.tag_add("new_font",a,b)
                                                    txt_edit.tag_config("new_font",font=new_font)
                                                    global Font
                                                    Font="华文新魏"
                                                    global 姓名
                                                    name=姓名
                                                    uuser = Account1(name, '1', f"调整字体{Font}", "操作:08编辑{改变文本字体}")
                                                    uuser.record_history()
                                                except:
                                                    return
                                            def 华文隶书():
                                                global ffont,Font
                                                try:
                                                    a=txt_edit.index(tk.SEL_FIRST)
                                                    b=txt_edit.index(tk.SEL_LAST)
                                                    new_font=font.Font(family="华文隶书",size=ffont)
                                                    txt_edit.tag_add("new_font",a,b)
                                                    txt_edit.tag_config("new_font",font=new_font)
                                                    global Font
                                                    Font="华文隶书"
                                                    global 姓名
                                                    name=姓名
                                                    uuser = Account1(name, '1', f"调整字体{Font}", "操作:08编辑{改变文本字体}")
                                                    uuser.record_history()
                                                except:
                                                    return
                                            def 微软雅黑():
                                                global ffont,Font
                                                try:
                                                    a=txt_edit.index(tk.SEL_FIRST)
                                                    b=txt_edit.index(tk.SEL_LAST)
                                                    new_font=font.Font(family="微软雅黑",size=ffont)
                                                    txt_edit.tag_add("new_font",a,b)
                                                    txt_edit.tag_config("new_font",font=new_font)
                                                    global Font
                                                    Font=new_font
                                                    global 姓名
                                                    name=姓名
                                                    uuser = Account1(name, '1', f"调整字体{Font}", "操作:08编辑{改变文本字体}")
                                                    uuser.record_history()
                                                except:
                                                    return
                                            def 宋体():
                                                global ffont,Font
                                                try:
                                                    a=txt_edit.index(tk.SEL_FIRST)
                                                    b=txt_edit.index(tk.SEL_LAST)
                                                    new_font=font.Font(family="宋体",size=ffont)
                                                    txt_edit.tag_add("new_font",a,b)
                                                    txt_edit.tag_config("new_font",font=new_font)
                                                    global Font
                                                    Font="宋体"
                                                    global 姓名
                                                    name=姓名
                                                    uuser = Account1(name, '1', f"调整字体{Font}", "操作:08编辑{改变文本字体}")
                                                    uuser.record_history()
                                                except:
                                                    return
                                            def 等线():
                                                global ffont,Font
                                                try:
                                                    a=txt_edit.index(tk.SEL_FIRST)
                                                    b=txt_edit.index(tk.SEL_LAST)
                                                    new_font=font.Font(family="等线",size=ffont)
                                                    txt_edit.tag_add("new_font",a,b)
                                                    txt_edit.tag_config("new_font",font=new_font)
                                                    global Font
                                                    Font="等线"
                                                    global 姓名
                                                    name=姓名
                                                    uuser = Account1(name, '1', f"调整字体{Font}", "操作:08编辑{改变文本字体}")
                                                    uuser.record_history()
                                                except:
                                                    return

                                            def 等线Light():
                                                global ffont,Font
                                                try:
                                                    a=txt_edit.index(tk.SEL_FIRST)
                                                    b=txt_edit.index(tk.SEL_LAST)
                                                    new_font=font.Font(family="等线 Light",size=ffont)
                                                    txt_edit.tag_add("new_font",a,b)
                                                    txt_edit.tag_config("new_font",font=new_font)
                                                    global Font
                                                    Font="等线 Light"
                                                    global 姓名
                                                    name=姓名
                                                    uuser = Account1(name, '1', f"调整字体{Font}", "操作:08编辑{改变文本字体}")
                                                    uuser.record_history()
                                                except:
                                                    return


                                            def 方正姚体():
                                                global ffont,Font
                                                try:
                                                    a=txt_edit.index(tk.SEL_FIRST)
                                                    b=txt_edit.index(tk.SEL_LAST)
                                                    new_font=font.Font(family="方正姚体",size=ffont)
                                                    txt_edit.tag_add("new_font",a,b)
                                                    txt_edit.tag_config("new_font",font=new_font)
                                                    global Font
                                                    Font="方正姚体"
                                                    global 姓名
                                                    name=姓名
                                                    uuser = Account1(name, '1', f"调整字体{Font}", "操作:08编辑{改变文本字体}")
                                                    uuser.record_history()
                                                except:
                                                    return

                                            def 方正舒体():
                                                global ffont,Font
                                                try:
                                                    a=txt_edit.index(tk.SEL_FIRST)
                                                    b=txt_edit.index(tk.SEL_LAST)
                                                    new_font=font.Font(family="方正舒体",size=ffont)
                                                    txt_edit.tag_add("new_font",a,b)
                                                    txt_edit.tag_config("new_font",font=new_font)
                                                    global Font
                                                    Font="方正舒体"
                                                    global 姓名
                                                    name=姓名
                                                    uuser = Account1(name, '1', f"调整字体{Font}", "操作:08编辑{改变文本字体}")
                                                    uuser.record_history()
                                                except:
                                                    return

                                            def 方正粗黑宋简体():
                                                global ffont,Font
                                                try:
                                                    a=txt_edit.index(tk.SEL_FIRST)
                                                    b=txt_edit.index(tk.SEL_LAST)
                                                    new_font=font.Font(family="方正粗黑宋简体",size=ffont)
                                                    txt_edit.tag_add("new_font",a,b)
                                                    txt_edit.tag_config("new_font",font=new_font)
                                                    global Font
                                                    Font="方正粗黑宋简体"
                                                    global 姓名
                                                    name=姓名
                                                    uuser = Account1(name, '1', f"调整字体{Font}", "操作:08编辑{改变文本字体}")
                                                    uuser.record_history()
                                                except:
                                                    return

                                            def 方正兰亭超细黑简体():
                                                global ffont,Font
                                                try:
                                                    a=txt_edit.index(tk.SEL_FIRST)
                                                    b=txt_edit.index(tk.SEL_LAST)
                                                    new_font=font.Font(family="方正兰亭超细黑简体",size=ffont)
                                                    txt_edit.tag_add("new_font",a,b)
                                                    txt_edit.tag_config("new_font",font=new_font)
                                                    global Font
                                                    Font="方正兰亭超细黑简体"
                                                    global 姓名
                                                    name=姓名
                                                    uuser = Account1(name, '1', f"调整字体{Font}", "操作:08编辑{改变文本字体}")
                                                    uuser.record_history()
                                                except:
                                                    return
                                            def 黑体():
                                                global ffont,Font
                                                try:
                                                    a=txt_edit.index(tk.SEL_FIRST)
                                                    b=txt_edit.index(tk.SEL_LAST)
                                                    new_font=font.Font(family="黑体",size=ffont)
                                                    txt_edit.tag_add("new_font",a,b)
                                                    txt_edit.tag_config("new_font",font=new_font)
                                                    global Font
                                                    Font="黑体"
                                                    global 姓名
                                                    name=姓名
                                                    uuser = Account1(name, '1', f"调整字体{Font}", "操作:08编辑{改变文本字体}")
                                                    uuser.record_history()
                                                except:
                                                    return
                                            def 仿宋():
                                                global ffont,Font
                                                try:
                                                    a=txt_edit.index(tk.SEL_FIRST)
                                                    b=txt_edit.index(tk.SEL_LAST)
                                                    new_font=font.Font(family="仿宋",size=ffont)
                                                    txt_edit.tag_add("new_font",a,b)
                                                    txt_edit.tag_config("new_font",font=new_font)
                                                    global Font
                                                    Font="仿宋"
                                                    global 姓名
                                                    name=姓名
                                                    uuser = Account1(name, '1', f"调整字体{Font}", "操作:08编辑{改变文本字体}")
                                                    uuser.record_history()
                                                except:
                                                    return

                                            def 华文彩云():
                                                global ffont,Font
                                                try:
                                                    a=txt_edit.index(tk.SEL_FIRST)
                                                    b=txt_edit.index(tk.SEL_LAST)
                                                    new_font=font.Font(family="华文彩云",size=ffont)
                                                    txt_edit.tag_add("new_font",a,b)
                                                    txt_edit.tag_config("new_font",font=new_font)
                                                    global Font
                                                    Font="华文彩云"
                                                    global 姓名
                                                    name=姓名
                                                    uuser = Account1(name, '1', f"调整字体{Font}", "操作:08编辑{改变文本字体}")
                                                    uuser.record_history()
                                                except:
                                                    return

                                            def 华文仿宋():
                                                global ffont,Font
                                                try:
                                                    a=txt_edit.index(tk.SEL_FIRST)
                                                    b=txt_edit.index(tk.SEL_LAST)
                                                    new_font=font.Font(family="华文仿宋",size=ffont)
                                                    txt_edit.tag_add("new_font",a,b)
                                                    txt_edit.tag_config("new_font",font=new_font)
                                                    global Font
                                                    Font="华文仿宋"
                                                    global 姓名
                                                    name=姓名
                                                    uuser = Account1(name, '1', f"调整字体{Font}", "操作:08编辑{改变文本字体}")
                                                    uuser.record_history()
                                                except:
                                                    return
                                            def 华文琥珀():
                                                global ffont,Font
                                                try:
                                                    a=txt_edit.index(tk.SEL_FIRST)
                                                    b=txt_edit.index(tk.SEL_LAST)
                                                    new_font=font.Font(family="华文琥珀",size=ffont)
                                                    txt_edit.tag_add("new_font",a,b)
                                                    txt_edit.tag_config("new_font",font=new_font)
                                                    global Font
                                                    Font="华文琥珀"
                                                    global 姓名
                                                    name=姓名
                                                    uuser = Account1(name, '1', f"调整字体{Font}", "操作:08编辑{改变文本字体}")
                                                    uuser.record_history()
                                                except:
                                                    return

                                            def 华文楷体():
                                                global ffont,Font
                                                try:
                                                    a=txt_edit.index(tk.SEL_FIRST)
                                                    b=txt_edit.index(tk.SEL_LAST)
                                                    new_font=font.Font(family="华文楷体",size=ffont)
                                                    txt_edit.tag_add("new_font",a,b)
                                                    txt_edit.tag_config("new_font",font=new_font)
                                                    global Font
                                                    Font="华文楷体"
                                                    global 姓名
                                                    name=姓名
                                                    uuser = Account1(name, '1', f"调整字体{Font}", "操作:08编辑{改变文本字体}")
                                                    uuser.record_history()
                                                except:
                                                    return

                                            def 华文宋体():
                                                global ffont,Font
                                                try:
                                                    a=txt_edit.index(tk.SEL_FIRST)
                                                    b=txt_edit.index(tk.SEL_LAST)
                                                    new_font=font.Font(family="华文宋体",size=ffont)
                                                    txt_edit.tag_add("new_font",a,b)
                                                    txt_edit.tag_config("new_font",font=new_font)
                                                    global Font
                                                    Font="华文宋体"
                                                    global 姓名
                                                    name=姓名
                                                    uuser = Account1(name, '1', f"调整字体{Font}", "操作:08编辑{改变文本字体}")
                                                    uuser.record_history()
                                                except:
                                                    return

                                            def 华文细黑():
                                                global ffont,Font
                                                try:
                                                    a=txt_edit.index(tk.SEL_FIRST)
                                                    b=txt_edit.index(tk.SEL_LAST)
                                                    new_font=font.Font(family="华文细黑",size=ffont)
                                                    txt_edit.tag_add("new_font",a,b)
                                                    txt_edit.tag_config("new_font",font=new_font)
                                                    global Font
                                                    Font="华文细黑"
                                                    global 姓名
                                                    name=姓名
                                                    uuser = Account1(name, '1', f"调整字体{Font}", "操作:08编辑{改变文本字体}")
                                                    uuser.record_history()
                                                except:
                                                    return

                                            def 华文行楷():
                                                global ffont,Font
                                                try:
                                                    a=txt_edit.index(tk.SEL_FIRST)
                                                    b=txt_edit.index(tk.SEL_LAST)
                                                    new_font=font.Font(family="华文行楷",size=ffont)
                                                    txt_edit.tag_add("new_font",a,b)
                                                    txt_edit.tag_config("new_font",font=new_font)
                                                    global Font
                                                    Font="华文行楷"
                                                    global 姓名
                                                    name=姓名
                                                    uuser = Account1(name, '1', f"调整字体{Font}", "操作:08编辑{改变文本字体}")
                                                    uuser.record_history()
                                                except:
                                                    return

                                            def 楷体():
                                                global ffont,Font
                                                try:
                                                    a=txt_edit.index(tk.SEL_FIRST)
                                                    b=txt_edit.index(tk.SEL_LAST)
                                                    new_font=font.Font(family="楷体",size=ffont)
                                                    txt_edit.tag_add("new_font",a,b)
                                                    txt_edit.tag_config("new_font",font=new_font)
                                                    global Font
                                                    Font="楷体"
                                                    global 姓名
                                                    name=姓名
                                                    uuser = Account1(name, '1', f"调整字体{Font}", "操作:08编辑{改变文本字体}")
                                                    uuser.record_history()
                                                except:
                                                    return

                                            def 隶书():
                                                global ffont,Font
                                                try:
                                                    a=txt_edit.index(tk.SEL_FIRST)
                                                    b=txt_edit.index(tk.SEL_LAST)
                                                    new_font=font.Font(family="隶书",size=ffont)
                                                    txt_edit.tag_add("new_font",a,b)
                                                    txt_edit.tag_config("new_font",font=new_font)
                                                    global Font
                                                    Font="隶书"
                                                    global 姓名
                                                    name=姓名
                                                    uuser = Account1(name, '1', f"调整字体{Font}", "操作:08编辑{改变文本字体}")
                                                    uuser.record_history()
                                                except:
                                                    return
                                            def 新宋体():
                                                global ffont,Font
                                                try:
                                                    a=txt_edit.index(tk.SEL_FIRST)
                                                    b=txt_edit.index(tk.SEL_LAST)
                                                    new_font=font.Font(family="新宋体",size=ffont)
                                                    txt_edit.tag_add("new_font",a,b)
                                                    txt_edit.tag_config("new_font",font=new_font)
                                                    global Font
                                                    Font="新宋体"
                                                    global 姓名
                                                    name=姓名
                                                    uuser = Account1(name, '1', f"调整字体{Font}", "操作:08编辑{改变文本字体}")
                                                    uuser.record_history()
                                                except:
                                                    return

                                            def 幼圆():
                                                global ffont,Font
                                                try:
                                                    a=txt_edit.index(tk.SEL_FIRST)
                                                    b=txt_edit.index(tk.SEL_LAST)
                                                    new_font=font.Font(family="幼圆",size=ffont)
                                                    txt_edit.tag_add("new_font",a,b)
                                                    txt_edit.tag_config("new_font",font=new_font)
                                                    global Font
                                                    Font="幼圆"
                                                    global 姓名
                                                    name=姓名
                                                    uuser = Account1(name, '1', f"调整字体{Font}", "操作:08编辑{改变文本字体}")
                                                    uuser.record_history()
                                                except:
                                                    return
                                            def 加粗():
                                                global ffont,Font
                                                global 姓名
                                                name=姓名
                                                uuser = Account1(name, '1', "调整字形{加粗}", "操作:08编辑{改变文本字形}")
                                                uuser.record_history()
                                                #print(Font)
                                                try:
                                                    # 获取选中文本的位置
                                                    a = txt_edit.index(tk.SEL_FIRST)
                                                    b = txt_edit.index(tk.SEL_LAST)

                                                    # 定义一个辅助函数来获取或创建带有指定属性的字体
                                                    def get_font_with_attributes(current_font, weight=None):
                                                        return font.Font(family=current_font['family'],
                                                                         size=current_font['size'],
                                                                         weight=weight if weight else current_font['weight'],
                                                                         slant=current_font['slant'])

                                                    # 获取当前选中文本的所有标签
                                                    current_tags = txt_edit.tag_names(tk.SEL_FIRST)

                                                    # 如果有现有标签，则从这些标签中获取字体属性
                                                    for tag in current_tags:
                                                        if tag != "bold":  # 忽略我们正在改变的标签
                                                            current_font = font.Font(font=txt_edit.tag_cget(tag, "font"))
                                                            break
                                                    else:
                                                        # 如果没有其他标签，使用默认字体
                                                        current_font = font.Font(family=Font, size=ffont)

                                                    # 检查是否已经应用了加粗
                                                    if "bold" in current_tags:
                                                        # 如果已应用加粗，则恢复到原始字体
                                                        txt_edit.tag_remove("bold", a, b)
                                                    else:
                                                        # 创建新的加粗字体对象
                                                        new_font = get_font_with_attributes(current_font, weight='bold')
                                                        txt_edit.tag_add("bold", a, b)
                                                        txt_edit.tag_config("bold", font=new_font)

                                                except tk.TclError:  # 当没有文本被选中时会抛出此异常
                                                    return

                                            def 斜体():
                                                 global ffont,Font
                                                 global 姓名
                                                 name=姓名
                                                 uuser = Account1(name, '1', "调整字形{斜体}", "操作:08编辑{改变文本字形}")
                                                 uuser.record_history()
                                                 try:
                                                    # 获取选中文本的位置
                                                    a = txt_edit.index(tk.SEL_FIRST)
                                                    b = txt_edit.index(tk.SEL_LAST)

                                                    # 定义一个函数来获取或创建带有指定属性的字体
                                                    def get_font_with_attributes(current_font, slant=None, weight=None):
                                                        return font.Font(family=current_font['family'],
                                                                         size=current_font['size'],
                                                                         weight=weight if weight else current_font['weight'],
                                                                         slant=slant if slant else current_font['slant'])

                                                    # 获取当前选中文本的所有标签
                                                    current_tags = txt_edit.tag_names(tk.SEL_FIRST)

                                                    # 如果已经应用了斜体，则移除斜体
                                                    if "italic" in current_tags:
                                                        # 获取现有斜体标签的字体属性并转换为直立
                                                        current_font = font.Font(font=txt_edit.tag_cget("italic", "font"))
                                                        new_font = get_font_with_attributes(current_font, slant='roman')
                                                        txt_edit.tag_config("italic", font=new_font)
                                                        txt_edit.tag_remove("italic", a, b)  # 移除斜体标签
                                                    else:
                                                        # 没有斜体标签时，添加斜体
                                                        # 首先尝试从已有标签中获取字体属性
                                                        for tag in current_tags:
                                                            if tag != "italic":  # 忽略斜体标签，因为我们正在改变它
                                                                current_font = font.Font(font=txt_edit.tag_cget(tag, "font"))
                                                                break
                                                        else:
                                                            # 如果没有其他标签，使用默认字体
                                                            current_font = font.Font(font=txt_edit.cget("font"))

                                                        # 创建新的斜体字体对象
                                                        new_font = get_font_with_attributes(current_font, slant='italic')
                                                        txt_edit.tag_config("italic", font=new_font)
                                                        txt_edit.tag_add("italic", a, b)  # 应用斜体标签

                                                 except tk.TclError:  # 当没有文本被选中时会抛出此异常
                                                    
                                                    return
                                            # 将函数与菜单项关联
                                            about_menu.add_command(label="宋体", command=宋体, font=font_F24)
                                            about_menu.add_command(label="等线", command=等线, font=font_F2)
                                            about_menu.add_command(label="等线 Light", command=等线Light, font=font_F111)

                                            about_menu.add_command(label="微软雅黑", command=微软雅黑, font=font_F4)
                                            about_menu.add_command(label="微软雅黑 Light", command=微软雅黑Light, font=font_F44)
                                            about_menu.add_command(label="华文中宋", command=华文中宋, font=font_F3)
                                            about_menu.add_command(label="华文新魏", command=华文新魏, font=font_F5)
                                            about_menu.add_command(label="华文隶书", command=华文隶书, font=font_F6)
                                            about_menu.add_command(label="方正姚体", command=方正姚体, font=font_F7)
                                            about_menu.add_command(label="方正舒体", command=方正舒体, font=font_F8)
                                            about_menu.add_command(label="方正粗黑宋简体", command=方正粗黑宋简体, font=font_F9)
                                            about_menu.add_command(label="方正兰亭超细黑简体", command=方正兰亭超细黑简体, font=font_F10)
                                            about_menu.add_command(label="黑体", command=黑体, font=font_F11)
                                            about_menu.add_command(label="仿宋", command=仿宋, font=font_F12)
                                            about_menu.add_command(label="华文彩云", command=华文彩云, font=font_F13)
                                            about_menu.add_command(label="华文仿宋", command=华文仿宋, font=font_F14)
                                            about_menu.add_command(label="华文琥珀", command=华文琥珀, font=font_F15)
                                            about_menu.add_command(label="华文楷体", command=华文楷体, font=font_F16)
                                            about_menu.add_command(label="华文宋体", command=华文宋体, font=font_F17)
                                            about_menu.add_command(label="华文细黑", command=华文细黑, font=font_F18)
                                            about_menu.add_command(label="华文行楷", command=华文行楷, font=font_F19)
                                            about_menu.add_command(label="楷体", command=楷体, font=font_F20)
                                            about_menu.add_command(label="隶书", command=隶书, font=font_F21)
                                            about_menu.add_command(label="新宋体", command=新宋体, font=font_F22)
                                            about_menu.add_command(label="幼圆", command=幼圆, font=font_F23)
                                            about_menu.add_separator()
                                            about_menu.add_command(label="B Ctrl+b",command=加粗,font=font_F2222)
                                            about_menu.add_command(label="I  Ctrl+I",command=斜体,font=font_F2223)
                                            word.bind('<Control-b>', lambda event: 加粗())
                                            word.bind('<Control-I>', lambda event: 斜体())
                                            word.bind('<Control-s>', lambda event:save())

                                            def redd():
                                                global Font,ffont
                                                global 姓名
                                                name=姓名
                                                uuser = Account1(name, '1', "调整字色{red}", "操作:08编辑{改变文本字色}")
                                                uuser.record_history()
                                                try:
                                                    start = txt_edit.index(tk.SEL_FIRST)
                                                    end = txt_edit.index(tk.SEL_LAST)

                                                    # 创建或更新名为 "red" 的 tag，指定前景色为红色
                                                    txt_edit.tag_config("red", foreground="#FF6A6A")

                                                    # 应用 "red" tag 到选定的文本范围
                                                    txt_edit.tag_add("red", start, end)
                                                
                                                except:
                                                    return
                                            def oranged():
                                                 
                                                global Font,ffont
                                                global 姓名
                                                name=姓名
                                                uuser = Account1(name, '1', "调整字色{orange}", "操作:08编辑{改变文本字色}")
                                                uuser.record_history()
                                                try:
                                                    start = txt_edit.index(tk.SEL_FIRST)
                                                    end = txt_edit.index(tk.SEL_LAST)

                                                    # 创建或更新名为 "red" 的 tag，指定前景色为红色
                                                    txt_edit.tag_config("red", foreground="#FF7F50")

                                                    # 应用 "red" tag 到选定的文本范围
                                                    txt_edit.tag_add("red", start, end)
                                                
                                                except:
                                                    return
                                            def yellowd():
                                                global Font,ffont
                                                global 姓名
                                                name=姓名
                                                uuser = Account1(name, '1', "调整字色{yellow}", "操作:08编辑{改变文本字色}")
                                                uuser.record_history()
                                                try:
                                                    start = txt_edit.index(tk.SEL_FIRST)
                                                    end = txt_edit.index(tk.SEL_LAST)

                                                    # 创建或更新名为 "red" 的 tag，指定前景色为红色
                                                    txt_edit.tag_config("red", foreground="#FFFF00")

                                                    # 应用 "red" tag 到选定的文本范围
                                                    txt_edit.tag_add("red", start, end)
                                                
                                                except:
                                                    return
                                            def greend():
                                                global Font,ffont
                                                global 姓名
                                                name=姓名
                                                uuser = Account1(name, '1', "调整字色{green绿}", "操作:08编辑{改变文本字色}")
                                                uuser.record_history()
                                                try:
                                                    start = txt_edit.index(tk.SEL_FIRST)
                                                    end = txt_edit.index(tk.SEL_LAST)

                                                    # 创建或更新名为 "red" 的 tag，指定前景色为红色
                                                    txt_edit.tag_config("red", foreground="#B5E61D")

                                                    # 应用 "red" tag 到选定的文本范围
                                                    txt_edit.tag_add("red", start, end)
                                                
                                                except:
                                                    return
                                            def blued():
                                                global Font,ffont
                                                global 姓名
                                                name=姓名
                                                uuser = Account1(name, '1', "调整字色{blue}", "操作:08编辑{改变文本字色}")
                                                uuser.record_history()
                                                try:
                                                    start = txt_edit.index(tk.SEL_FIRST)
                                                    end = txt_edit.index(tk.SEL_LAST)

                                                    # 创建或更新名为 "red" 的 tag，指定前景色为红色
                                                    txt_edit.tag_config("red", foreground="#3487FF")

                                                    # 应用 "red" tag 到选定的文本范围
                                                    txt_edit.tag_add("red", start, end)
                                                
                                                except:
                                                    return
                                            def purpled():
                                                global Font,ffont
                                                global 姓名
                                                name=姓名
                                                uuser = Account1(name, '1', "调整字色{purple}", "操作:08编辑{改变文本字色}")
                                                uuser.record_history()
                                                try:
                                                    start = txt_edit.index(tk.SEL_FIRST)
                                                    end = txt_edit.index(tk.SEL_LAST)

                                                    # 创建或更新名为 "red" 的 tag，指定前景色为红色
                                                    txt_edit.tag_config("red", foreground="#9B6CFF")

                                                    # 应用 "red" tag 到选定的文本范围
                                                    txt_edit.tag_add("red", start, end)
                                                except:
                                                    return
                                            def blackd():
                                                global Font,ffont
                                                global 姓名
                                                name=姓名
                                                uuser = Account1(name, '1', "调整字色{black}", "操作:08编辑{改变文本字色}")
                                                uuser.record_history()
                                                try:
                                                    start = txt_edit.index(tk.SEL_FIRST)
                                                    end = txt_edit.index(tk.SEL_LAST)

                                                    # 创建或更新名为 "red" 的 tag，指定前景色为红色
                                                    txt_edit.tag_config("red", foreground="black")

                                                    # 应用 "red" tag 到选定的文本范围
                                                    txt_edit.tag_add("red", start, end)
                                                except:
                                                    return
                                            def greyd():
                                                global Font,ffont
                                                global 姓名
                                                name=姓名
                                                uuser = Account1(name, '1', "调整字色{grey}", "操作:08编辑{改变文本字色}")
                                                uuser.record_history()
                                                try:
                                                    start = txt_edit.index(tk.SEL_FIRST)
                                                    end = txt_edit.index(tk.SEL_LAST)

                                                    # 创建或更新名为 "red" 的 tag，指定前景色为红色
                                                    txt_edit.tag_config("red", foreground="#B3B2B5")

                                                    # 应用 "red" tag 到选定的文本范围
                                                    txt_edit.tag_add("red", start, end)
                                                
                                                except:
                                                    return
                                            def whited():
                                                global Font,ffont
                                                global 姓名
                                                name=姓名
                                                uuser = Account1(name, '1', "调整字色{white}", "操作:08编辑{改变文本字色}")
                                                uuser.record_history()
                                                try:
                                                    start = txt_edit.index(tk.SEL_FIRST)
                                                    end = txt_edit.index(tk.SEL_LAST)

                                                    # 创建或更新名为 "red" 的 tag，指定前景色为红色
                                                    txt_edit.tag_config("red", foreground="#ffffff")

                                                    # 应用 "red" tag 到选定的文本范围
                                                    txt_edit.tag_add("red", start, end)
                                                except:
                                                    return
                                            def pinkd():
                                                global Font,ffont
                                                global 姓名
                                                name=姓名
                                                uuser = Account1(name, '1', "调整字色{pink}", "操作:08编辑{改变文本字色}")
                                                uuser.record_history()
                                                try:
                                                    start = txt_edit.index(tk.SEL_FIRST)
                                                    end = txt_edit.index(tk.SEL_LAST)

                                                    # 创建或更新名为 "red" 的 tag，指定前景色为红色
                                                    txt_edit.tag_config("red", foreground="#FF89B4")

                                                    # 应用 "red" tag 到选定的文本范围
                                                    txt_edit.tag_add("red", start, end)
                                                except:
                                                    return
                                            def green():
                                                global Font,ffont
                                                global 姓名
                                                name=姓名
                                                uuser = Account1(name, '1', "调整字色{green青}", "操作:08编辑{改变文本字色}")
                                                uuser.record_history()
                                                try:
                                                    start = txt_edit.index(tk.SEL_FIRST)
                                                    end = txt_edit.index(tk.SEL_LAST)

                                                   
                                                    txt_edit.tag_config("red", foreground="#00FFFF")

                                                    # 应用 "red" tag 到选定的文本范围
                                                    txt_edit.tag_add("red", start, end)
                                                except:
                                                    return

                                            def flesh():
                                                global Font,ffont
                                                global 姓名
                                                name=姓名
                                                uuser = Account1(name, '1', "调整字色{flesh肉色}", "操作:08编辑{改变文本字色}")
                                                uuser.record_history()
                                                try:
                                                    start = txt_edit.index(tk.SEL_FIRST)
                                                    end = txt_edit.index(tk.SEL_LAST)

                                                   
                                                    txt_edit.tag_config("red", foreground="#fff7d0")

                                                    # 应用 "red" tag 到选定的文本范围
                                                    txt_edit.tag_add("red", start, end)
                                                except:
                                                    return

                                                
                                            color = tk.Menu(edit_menu, tearoff=0)
                                            color.add_command(label="红色",command=redd)
                                            color.add_command(label="橙色",command=oranged)
                                            color.add_command(label="黄色",command=yellowd)
                                            color.add_command(label="绿色",command=greend)

                                            color.add_command(label="青色",command=green)
                                            
                                            
                                            color.add_command(label="蓝色",command=blued)
                                            color.add_command(label="紫色",command=purpled)
                                            color.add_command(label="粉色",command=pinkd)
                                            color.add_command(label="肉色",command=flesh)
                                            
                                            color.add_command(label="黑色",command=blackd)
                                            color.add_command(label="灰色",command=greyd)
                                            color.add_command(label="白色",command=whited)
                                            
                                            edit_menu.add_cascade(label="字色", menu=color)
                                            字号=tk.Menu(edit_menu,tearoff=0)
                                            current_font_family = tk.StringVar(value="宋体")
                                            current_font_size = tk.IntVar(value=12)

                                            def zih():
                                                
                                                    global ffont,Font
                                               
                                                
                                             
                                                    try: 
                                                        # 获取选中文本 
                                                        start_idx = txt_edit.index(tk.SEL_FIRST)  
                                                        end_idx = txt_edit.index(tk.SEL_LAST)  
                                                        selected_text = txt_edit.get(start_idx,  end_idx) 
                                                 
                                                        # 删除选中文本 
                                                        txt_edit.delete(start_idx,  end_idx) 
                                                 
                                                        # 获取字体大小 
                                                        ffont=ffont # 这里假设字体大小为ffont，实际应用中你需要从合适的地方获取，比如用户输入 
                                                        custom_font = font.Font(size=ffont) 
                                                 
                                                        # 配置标签样式 
                                                        txt_edit.tag_config("custom_style",  font=custom_font) 
                                                 
                                                        # 重新插入文本并应用样式 
                                                        txt_edit.insert(start_idx,  selected_text, "custom_style")
                                                        global 姓名
                                                        name=姓名
                                                        uuser = Account1(name, '1', f"字号{ffont}", "操作:08编辑{调整字体大小}")
                                                        uuser.record_history()
                                                    except tk.TclError: 
                                                        pass 
                                                
                                            def seven():
                                                global ffont
                                                ffont=7
                                                zih()
                                            def eight():
                                                global ffont
                                                ffont=8
                                                zih()
                                            def nine():
                                                global ffont
                                                ffont=9
                                                zih()
                                            def ten():
                                                global ffont
                                                ffont=10
                                                zih()
                                            def eleven():
                                                global ffont
                                                ffont=11
                                                zih()

                                            def twelve():
                                                global ffont
                                                ffont=12
                                                zih()

                                            def thirteen():
                                                global ffont
                                                ffont=13
                                                zih()

                                            def fourteen():
                                                global ffont
                                                ffont=14
                                                zih()


                                            def sixteen():
                                                global ffont
                                                ffont=16
                                                zih()

                                          
                                            def eighteen():
                                                global ffont
                                                ffont=18
                                                zih()

                                            def twenty():
                                                global ffont
                                                ffont=20
                                                zih()
                                            def twentytwo():
                                                global ffont
                                                ffont=22
                                                zih()

                                            def twentyfive():
                                                global ffont
                                                ffont=25
                                                zih()
                                            def twentynine():
                                                global ffont
                                                ffont=29
                                                zih()
                                            def thirtyfour():
                                                global ffont
                                                ffont=34
                                                zih()
                                            def fourty():
                                                global ffont
                                                ffont=40
                                                zih()
                                            字号.add_command(label='7',command=seven)
                                            字号.add_command(label='8',command=eight)
                                            字号.add_command(label='9',command=nine)

                                            字号.add_command(label='10',command=ten)
                                            字号.add_command(label='11',command=eleven)
                                            字号.add_command(label='12',command=twelve)

                                            字号.add_command(label='13',command=thirteen)
                                            字号.add_command(label='14',command=fourteen)
                                          
                                            字号.add_command(label='16',command=sixteen)
                                            字号.add_command(label='18',command=eighteen)
                                            字号.add_command(label='20',command=twenty)
                                            字号.add_command(label='22',command=twentytwo)
                                            字号.add_command(label='25',command=eight)
                                            字号.add_command(label='29',command=twentynine)

                                            字号.add_command(label='34',command=thirtyfour)
                                            字号.add_command(label='40',command=fourty)
                                         





                                            edit_menu.add_cascade(label="字号", menu=字号)

                                            def 正方形():
                                               z="◼"
                                               txt_edit.insert(tk.INSERT,z)
                                               global 姓名
                                               name=姓名
                                               uuser = Account1(name, '1', "插入特殊符{实行[]}", "操作:08编辑{输出特殊字符}")
                                               uuser.record_history()
                                            def 正方形2():
                                               z="□"
                                               txt_edit.insert(tk.INSERT,z)
                                               global 姓名
                                               name=姓名
                                               uuser = Account1(name, '1', "插入特殊符{空心[]}", "操作:08编辑{输出特殊字符}")
                                               uuser.record_history()
                                            def 三角形():
                                                z="▲"
                                                txt_edit.insert(tk.INSERT,z)
                                                global 姓名
                                                name=姓名
                                                uuser = Account1(name, '1', "插入特殊符{实心▲}", "操作:08编辑{输出特殊字符}")
                                                uuser.record_history()
                                            def 三角形2():
                                                z="△"
                                                txt_edit.insert(tk.INSERT,z)
                                                global 姓名
                                                name=姓名
                                                uuser = Account1(name, '1', "插入特殊符{空心△}", "操作:08编辑{输出特殊字符}")
                                                uuser.record_history()
                                            def 长方形1():
                                                z="[ ]"
                                                txt_edit.insert(tk.INSERT,z)
                                                global 姓名
                                                name=姓名
                                                uuser = Account1(name, '1', "插入特殊符{[ ]}", "操作:08编辑{输出特殊字符}")
                                                uuser.record_history()
                                            def 圆形():
                                                z="⚪"
                                                txt_edit.insert(tk.INSERT,z)
                                                global 姓名
                                                name=姓名
                                                uuser = Account1(name, '1', "插入特殊符{o}", "操作:08编辑{输出特殊字符}")
                                                uuser.record_history()
                                            def 梯形():
                                                z="/二\\"
                                                txt_edit.insert(tk.INSERT,z)
                                                global 姓名
                                                name=姓名
                                                uuser = Account1(name, '1', "插入特殊符{/二\\}", "操作:08编辑{输出特殊字符}")
                                                uuser.record_history()
                                            def 平行四边形():
                                                z="/二/"
                                                txt_edit.insert(tk.INSERT,z)
                                                global 姓名
                                                name=姓名
                                                uuser = Account1(name, '1', "插入特殊符{/二/}", "操作:08编辑{输出特殊字符}")
                                                uuser.record_history()
                                            def 除():
                                                z="÷"
                                                txt_edit.insert(tk.INSERT,z)
                                                global 姓名
                                                name=姓名
                                                uuser = Account1(name, '1', "插入特殊符{÷}", "操作:08编辑{输出特殊字符}")
                                                uuser.record_history()
                                            def 乘():
                                                z="×"
                                                txt_edit.insert(tk.INSERT,z)
                                                global 姓名
                                                name=姓名
                                                uuser = Account1(name, '1', "插入特殊符{×}", "操作:08编辑{输出特殊字符}")
                                                uuser.record_history()
                                            def 勾():
                                                z="✔"
                                                txt_edit.insert(tk.INSERT,z)
                                                global 姓名
                                                name=姓名
                                                uuser = Account1(name, '1', "插入特殊符{勾}", "操作:08编辑{输出特殊字符}")
                                                uuser.record_history()
                                            def 叉():
                                                z="❌"
                                                txt_edit.insert(tk.END,z)
                                                global 姓名
                                                name=姓名
                                                uuser = Account1(name, '1', "插入特殊符{叉}", "操作:08编辑{输出特殊字符}")
                                                uuser.record_history()
                                            def 点():
                                                z="·"
                                                txt_edit.insert(tk.END,z)
                                                global 姓名
                                                name=姓名
                                                uuser = Account1(name, '1', "插入特殊符{·}", "操作:08编辑{输出特殊字符}")
                                                uuser.record_history()
                                            def 上():
                                                z="↑"
                                                txt_edit.insert(tk.END,z)
                                                global 姓名
                                                name=姓名
                                                uuser = Account1(name, '1', "插入特殊符{↑}", "操作:08编辑{输出特殊字符}")
                                                uuser.record_history()
                                            def 下():
                                                z="↓"
                                                txt_edit.insert(tk.END,z)
                                                global 姓名
                                                name=姓名
                                                uuser = Account1(name, '1', "插入特殊符{↓}", "操作:08编辑{输出特殊字符}")
                                                uuser.record_history()
                                            def 左():
                                                z="←"
                                                txt_edit.insert(tk.END,z)
                                                global 姓名
                                                name=姓名
                                                uuser = Account1(name, '1', "插入特殊符{←}", "操作:08编辑{输出特殊字符}")
                                                uuser.record_history()
                                            def 右():
                                                z="→"
                                                txt_edit.insert(tk.END,z)
                                                global 姓名
                                                name=姓名
                                                uuser = Account1(name, '1', "插入特殊符{→}", "操作:08编辑{输出特殊字符}")
                                                uuser.record_history()
                                                
                                            xingz = tk.Menu(edit_menu, tearoff=0)
                                            xingz.add_command(label="◼",command=正方形)
                                            xingz.add_command(label="□",command=正方形2)
                                            xingz.add_command(label="·",command=点)
                                            xingz.add_command(label='△',command=三角形2)
                                            xingz.add_command(label="▲",command=三角形)
                                            xingz.add_command(label="[  ]",command=长方形1)
                                            xingz.add_command(label="⚪",command=圆形)
                                            xingz.add_command(label="/二\\",command=梯形)
                                            xingz.add_command(label="/二/",command=平行四边形)
                                            xingz.add_command(label='↑',command=上)
                                            xingz.add_command(label='↓',command=下)
                                            xingz.add_command(label='←',command=左)
                                            xingz.add_command(label='→',command=右)

                                            xingz.add_command(label="÷",command=除)
                                            xingz.add_command(label="×",command=乘)
                                            xingz.add_command(label="✔",command=勾)
                                            xingz.add_command(label="❌",command=叉)

                                            edit_menu.add_separator()
                                            def qax():
                                                txt_edit.tag_add("sel", "1.0", "end-1c")
                                                # 将焦点设置到 Text 控件上
                                                txt_edit.focus_set()
                                             
                                            
                                            edit_menu.add_command(label="剪切 Ctrl+x", command=jq)
                                            edit_menu.add_command(label="复制 Ctrl+c", command=fz)
                                            edit_menu.add_command(label="粘贴 Ctrl+v", command=zt)
                                            edit_menu.add_command(label="全选 Ctrl+a", command=qax)
                                            word.bind('<Control-x>', lambda event:jq())
                                            word.bind('<Control-c>', lambda event:fz())
                                            word.bind('<Control-v>', lambda event:zt())
                                            word.bind('<Control-a>', lambda event:qax())
                                           
                                            def red():
                                                global 姓名
                                                name=姓名
                                                uuser = Account1(name, '1', "调整色板色{red}", "操作:08编辑{改变文本字色}")
                                                uuser.record_history()
                                                txt_edit.config(bg="#FF6A6A")
                                                
                                            def orange():
                                                global 姓名
                                                name=姓名
                                                uuser = Account1(name, '1', "调整色板色{orange}", "操作:08编辑{改变文本字色}")
                                                uuser.record_history()
                                                txt_edit.config(bg="#FF7F50")
                                            def yellow():
                                                global 姓名
                                                name=姓名
                                                uuser = Account1(name, '1', "调整色板色{yellow}", "操作:08编辑{改变文本字色}")
                                                uuser.record_history()
                                                txt_edit.config(bg="#FFFF00")
                                            def greenn():
                                                global 姓名
                                                name=姓名
                                                uuser = Account1(name, '1', "调整色板色{green}", "操作:08编辑{改变文本字色}")
                                                uuser.record_history()
                                                txt_edit.config(bg="#B5E61D")
                                            def blue():
                                                txt_edit.config(bg="#3487FF")
                                                global 姓名
                                                name=姓名
                                                uuser = Account1(name, '1', "调整色板色{blue}", "操作:08编辑{改变文本字色}")
                                                uuser.record_history()
                                            def purple():
                                                txt_edit.config(bg="#9B6CFF")
                                                global 姓名
                                                name=姓名
                                                uuser = Account1(name, '1', "调整色板色{purple}", "操作:08编辑{改变文本字色}")
                                                uuser.record_history()
                                            def pink():
                                                txt_edit.config(bg="#FF89B4")
                                                global 姓名
                                                name=姓名
                                                uuser = Account1(name, '1', "调整色板色{pink}", "操作:08编辑{改变文本字色}")
                                                uuser.record_history()
                                            def black():
                                                txt_edit.config(bg="#373738")
                                                global 姓名
                                                name=姓名
                                                uuser = Account1(name, '1', "调整色板色{black}", "操作:08编辑{改变文本字色}")
                                                uuser.record_history()
                                            def white():
                                                txt_edit.config(bg="#ffffff")
                                                global 姓名
                                                name=姓名
                                                uuser = Account1(name, '1', "调整色板色{white}", "操作:08编辑{改变文本字色}")
                                                uuser.record_history()
                                            def grey():
                                                txt_edit.config(bg="#B3B2B5")
                                                global 姓名
                                                name=姓名
                                                uuser = Account1(name, '1', "调整色板色{grey}", "操作:08编辑{改变文本字色}")
                                                uuser.record_history()
                                            def green():
                                                 txt_edit.config(bg="#00FFFF")
                                                 global 姓名
                                                 name=姓名
                                                 uuser = Account1(name, '1', "调整色板色{green(青)}", "操作:08编辑{改变文本字色}")
                                                 uuser.record_history()
                                            def flesh():
                                                 txt_edit.config(bg="#fff7d0")
                                                 global 姓名
                                                 name=姓名
                                                 uuser = Account1(name, '1', "调整色板色{flesh(肉色)}", "操作:08编辑{改变文本字色}")
                                                 uuser.record_history()
                                            #在填充中添加子菜单的项
                                            aboutt_menu = tk.Menu(edit_menu, tearoff=0)
                                            aboutt_menu.add_command(label="红色",command=red)
                                            aboutt_menu.add_command(label="橙色",command=orange)
                                            aboutt_menu.add_command(label="黄色",command=yellow)
                                            aboutt_menu.add_command(label="绿色",command=greenn)
                                            aboutt_menu.add_command(label="青色",command=green)
                                            aboutt_menu.add_command(label="蓝色",command=blue)
                                            aboutt_menu.add_command(label="紫色",command=purple)
                                            aboutt_menu.add_command(label="粉色",command=pink)
                                            aboutt_menu.add_command(label="肉色",command=flesh)
                                            
                                            aboutt_menu.add_command(label="黑色",command=black)
                                            aboutt_menu.add_command(label="白色",command=white)
                                            aboutt_menu.add_command(label="灰色",command=grey)
                                            
                                            






                                            



                                            #在填充中添加子菜单
                                            edit_menu.add_separator()
                                            edit_menu.add_cascade(label="填充色板", menu=aboutt_menu)
                                            edit_menu.add_cascade(label="插入形状", menu=xingz)
                                            
                                            edit_menu.add_separator()
                                            edit_menu.add_command(label="模版 Ctrl+m", command=mb)
                                            word.bind('<Control-m>', lambda event: mb())


                                            def right():
                                                try:
                                                    try:
                                                        txt_edit.tag_remove("left", "1.0", "end")
                                                        txt_edit.tag_remove("center", "1.0", "end")
                                                        txt_edit.tag_remove("right", "1.0", "end")
                                                        a=txt_edit.tag_ranges(tk.SEL)
                                                        if not a:
                                                            return
                                                        txt_edit.tag_add("right",*a)
                                                        global 姓名
                                                        name=姓名
                                                        uuser = Account1(name, '1', "调整文本排版{right}", "操作:08编辑{改变文本位置}")
                                                        uuser.record_history()
                                                    except tk.TclError:
                                                        pass
                                                except Exception as e:
                                                    # 打印错误信息和行号
                                                    tb = traceback.extract_tb(sys.exc_info()[2])
                                                    error_message = f"{e} (line {tb[-1].lineno})"
                                                    print(f"报错: {error_message}")
                                            def middle():
                                                try:
                                                    try:
                                                        txt_edit.tag_remove("left", "1.0", "end")
                                                        txt_edit.tag_remove("center", "1.0", "end")
                                                        txt_edit.tag_remove("right", "1.0", "end")
                                                        a=txt_edit.tag_ranges(tk.SEL)
                                                        if not a:
                                                            return
                                                        txt_edit.tag_add("center",*a)
                                                        global 姓名
                                                        name=姓名
                                                        uuser = Account1(name, '1', "调整文本排版{middle}", "操作:08编辑{改变文本位置}")
                                                        uuser.record_history()
                                                    except:
                                                        pass
                                                except Exception as e:
                                                    # 打印错误信息和行号
                                                    tb = traceback.extract_tb(sys.exc_info()[2])
                                                    error_message = f"{e} (line {tb[-1].lineno})"
                                                    print(f"报错: {error_message}")
                                            def left():
                                                try:
                                                    try:
                                                        txt_edit.tag_remove("left", "1.0", "end")
                                                        txt_edit.tag_remove("center", "1.0", "end")
                                                        txt_edit.tag_remove("right", "1.0", "end")
                                                        # 获取当前选中的文本范围
                                                        a = txt_edit.tag_ranges(tk.SEL)
                                                        if not a:
                                                            return  # 如果没有选中文本，则不进行任何操作
                                                        
                                                        # 应用相应的对齐标签到选中的文本
                                                        txt_edit.tag_add("left", *a)
                                                        global 姓名
                                                        name=姓名
                                                        uuser = Account1(name, '1', "调整文本排版{left}", "操作:08编辑{改变文本位置}")
                                                        uuser.record_history()
                                                    except tk.TclError:
                                                        pass  # 如果没有选中的文本，则忽略错误
                                                except Exception as e:
                                                    # 打印错误信息和行号
                                                    tb = traceback.extract_tb(sys.exc_info()[2])
                                                    error_message = f"{e} (line {tb[-1].lineno})"
                                                    print(f"报错: {error_message}")             

                                            # 定义不同的对齐标签(必写)
                                            txt_edit.tag_configure("left", justify='left')
                                            txt_edit.tag_configure("center", justify='center')
                                            txt_edit.tag_configure("right", justify='right')
                                            pb = tk.Menu(edit_menu, tearoff=0)
                                            pb.add_command(label="三  ",command=left)
                                            pb.add_command(label=" 三 ",command=middle)
                                            pb.add_command(label="  三",command=right)
                                            edit_menu.add_cascade(label="排版", menu=pb)

                                            menu_bar.add_cascade(label="编辑", menu=edit_menu)

                                            

                                      

                                            def 管理():
                                                    global 姓名
                                                    name=姓名
                                                    if(姓名!=""):
                                                            tongy="1"
                                                            uuser = Account1(name, tongy, "文件管理工具", "操作:06运行{文件管理代码}")
                                                            uuser.record_history()
                                                    def browse_directory():
                                                                current_dir = filedialog.askdirectory()
                                                                if current_dir:
                                                                    path_var.set(current_dir)
                                                                    refresh()
                                                                #path_entry.insert(0)
                                                                path_entry.delete(0,tk.END)
                                                                path_entry.insert(0,current_dir)
                                                            
                                                    def refresh():
                                                        file_listbox.delete(0, END)
                                                        current_dir = path_var.get()
                                                        if os.path.exists(current_dir):
                                                            for filename in sorted(os.listdir(current_dir)):
                                                                file_listbox.insert(END, filename)
                                                        if(姓名!=""):

                                                            uuser = Account1(name, tongy, "文件资源管理器{办公小窗口}", "操作:07自动操作{刷新}")
                                                            uuser.record_history()
                                                            

                                                    def create_file():
                                                        filetypes = [("Text Files", "*.txt"), ("CSV Files", "*.csv"), ("Python Files", "*.py"),
                                                                     ("Rich Text Format", "*.rtf"), ("PDF Files", "*.pdf"),
                                                                     ("Image Files", "*.png;*.jpg;*.jpeg;*.gif"),
                                                                     ("Audio Files", "*.mp3;*.wav"), ("Video Files", "*.mp4;*.avi"),
                                                                     ("All Files", "*.*"), ("JPEG Image", "*.jpg"), ("RTF Document", "*.rtf"),
                                                                     ("Word Document", "*.docx"), ("Excel Spreadsheet", "*.xlsx"),
                                                                     ("PowerPoint Presentation", "*.pptx")]
                                                        filename = filedialog.asksaveasfilename(defaultextension=".txt", filetypes=filetypes)
                                                        if filename:
                                                            with open(filename, 'w'):
                                                                pass  # 创建空文件
                                                            refresh()
                                                        if(姓名!=""):
                                                            uuser = Account1(name, tongy, "文件资源管理器{办公小窗口}", "操作:07自动操作{新建文件}")
                                                            uuser.record_history()

                                                    def create_directory():
                                                        current_dir = path_var.get() 
                                                        directory_path = filedialog.asksaveasfilename(initialdir=current_dir,  filetypes=[("文件夹", "")])
                                                        if directory_path:
                                                            if not os.path.exists(directory_path): 
                                                                os.makedirs(directory_path) 
                                                                #messagebox.showinfo(" 成功", f"文件夹 {os.path.basename(directory_path)}  已创建。")
                                                                refresh()
                                                            else:
                                                                messagebox.showerror(" 错误", f"文件夹 {os.path.basename(directory_path)}  已存在。")
                                                        if 姓名!='':
                                                            uuser = Account1(name, tongy, "文件资源管理器{{办公小窗口}}", "操作:07自动操作{{新建文件夹}}")
                                                            uuser.record_history() 



                                                    def delete_item():
                                                        selected_item = file_listbox.get(ACTIVE)
                                                        if selected_item:
                                                            current_dir = path_var.get()
                                                            item_path = os.path.join(current_dir, selected_item)
                                                            if os.path.exists(item_path):
                                                                if messagebox.askyesno("确认删除", f"确定要删除 {selected_item} 吗？"):
                                                                    if os.path.isfile(item_path):
                                                                        os.remove(item_path)
                                                                    elif os.path.isdir(item_path):
                                                                        shutil.rmtree(item_path)
                                                                    refresh()
                                                        if(姓名!=""):
                                                            uuser = Account1(name, tongy, "文件资源管理器{办公小窗口}", "操作:07自动操作{删除文本文档}")
                                                            uuser.record_history()

                                                    def compress_item():
                                                        selected_item = file_listbox.get(ACTIVE)
                                                        if selected_item:
                                                            current_dir = path_var.get()
                                                            item_path = os.path.join(current_dir, selected_item)
                                                            if os.path.exists(item_path):
                                                                zip_filename = filedialog.asksaveasfilename(defaultextension=".zip", filetypes=[("Zip Files", "*.zip")])
                                                                if zip_filename:
                                                                    with zipfile.ZipFile(zip_filename, 'w', zipfile.ZIP_DEFLATED) as zipf:
                                                                        if os.path.isfile(item_path):
                                                                            zipf.write(item_path, os.path.basename(item_path))
                                                                        else:
                                                                            for root, dirs, files in os.walk(item_path):
                                                                                for file in files:
                                                                                    file_path = os.path.join(root, file)
                                                                                    arcname = os.path.relpath(file_path, item_path)
                                                                                    zipf.write(file_path, arcname)
                                                                    messagebox.showinfo("成功", f"文件/目录 {selected_item} 压缩完成。")
                                                                    refresh()
                                                        if(姓名!=""):
                                                            uuser = Account1(name, tongy, "文件资源管理器{办公小窗口}", "操作:07自动操作{压缩文件}")
                                                            uuser.record_history()

                                                    def decompress_item():
                                                        selected_item = file_listbox.get(ACTIVE)
                                                        if selected_item:
                                                            current_dir = path_var.get()
                                                            item_path = os.path.join(current_dir, selected_item)
                                                            if os.path.isfile(item_path) and item_path.endswith('.zip'):
                                                                base_name = os.path.splitext(selected_item)[0]
                                                                extract_location = os.path.join(current_dir, base_name)
                                                                if not os.path.exists(extract_location):
                                                                    os.makedirs(extract_location)
                                                                with zipfile.ZipFile(item_path, 'r') as zipf:
                                                                    zipf.extractall(path=extract_location)
                                                                messagebox.showinfo("成功", f"文件 {selected_item} 解压完成。")
                                                                refresh()
                                                                
                                                            else:
                                                                messagebox.showerror("错误", "请选择一个 .zip 文件进行解压。")
                                                        if(姓名!=""):
                                                            uuser = Account1(name, tongy, "文件资源管理器{办公小窗口}", "操作:07自动操作{解压文档}")
                                                            uuser.record_history()
                                                    root = Tk()
                                                    root.title("OFFICE 文件资源管理器")
                                                    root.geometry("510x270")

                                                    path_var = StringVar(value=os.getcwd())

                                                    # 使用 Grid 布局
                                                    row, col = 0, 0
                                                    ttk.Label(root, text="路径:", padding=(10, 5)).grid(row=row, column=col, sticky=W)
                                                    path_entry = ttk.Entry(root, textvariable=path_var, width=80)
                                                    path_entry.grid(row=row, column=col+1, columnspan=6, sticky=EW)
                                                    path_entry.insert(0,"当前位置//:此文档中")
                                                    row += 1

                                                    button_width = 10
                                                    ttk.Button(root, text="浏览", command=browse_directory, width=button_width).grid(row=row, column=col, sticky=W, padx=(3,3))
                                                    ttk.Button(root, text="刷新", command=refresh, width=button_width).grid(row=row, column=col+1, sticky=W, padx=(3, 3))
                                                    ttk.Button(root, text="创建文件", command=create_file, width=button_width).grid(row=row, column=col+2, sticky=W, padx=(3, 3))
                                                    ttk.Button(root, text="创建文件夹", command=create_directory, width=button_width).grid(row=row, column=col+3, sticky=W, padx=(3, 3))
                                                    ttk.Button(root, text="删除", command=delete_item, width=button_width).grid(row=row, column=col+4, sticky=W, padx=(3, 3))
                                                    ttk.Button(root, text="压缩", command=compress_item, width=button_width).grid(row=row, column=col+5, sticky=W, padx=(3, 3))
                                                    ttk.Button(root, text="解压", command=decompress_item, width=button_width).grid(row=row, column=col+6, sticky=W, padx=(3, 3))
                                                    row += 1

                                                    file_listbox = Listbox(root, width=100, height=25)
                                                    file_listbox.grid(row=row, column=col, columnspan=7, sticky=NSEW, pady=(10, 0))  # 列扩展到7

                                                    # 设置列和行权重，使得Listbox可扩展
                                                    for c in range(col+7):
                                                        root.columnconfigure(c, weight=1)
                                                    root.rowconfigure(row, weight=1)

                                                    refresh()  # 初始化时刷新列表

                                                    root.mainloop()


                                            def 清理():
                                                 
                                                    global 姓名
                                                    name=姓名
                                                    if(姓名!=""):
                                                            tongy="1"
                                                            uuser = Account1(姓名, tongy, "缓存清理工具", "操作:06运行{文件清理代码}")
                                                            uuser.record_history()

                                              
                                                    def detect_cache():
                                            
                                                        cache_files = []
                                                        cache_dir = os.environ.get('TEMP')   # 获取系统临时文件夹路径 
                                                        cache_extensions = ['.tmp', '.cache', '.log', '.bak', '.old', '.dat', '.bin']
                                                        
                                                        for root, dirs, files in os.walk(cache_dir): 
                                                            for file in files:
                                                                if any(file.endswith(ext)  for ext in cache_extensions):
                                                                    cache_files.append(os.path.join(root,  file))
                                                        
                                                        text_box1.delete('1.0',  tk.END)
                                                        for file in cache_files:
                                                            text_box1.insert(tk.END,  file + '\n')
                                                        if(姓名!=""):
                                                            tongy="1"
                                                            uuser = Account1(name, tongy, "缓存清理工具", "操作:07自动操作{扫描文件}")
                                                            uuser.record_history()
                                                     
                                                    def clean_cache():
                                                        cache_files = text_box1.get('1.0',  tk.END).splitlines()
                                                        total_files = len(cache_files)
                                                        progress_bar['maximum'] = total_files 
                                                        text_box2.delete('1.0',  tk.END)
                                                        for i, file in enumerate(cache_files):
                                                            if os.path.exists(file): 
                                                                try:
                                                                    os.remove(file) 
                                                                    text_box2.insert(tk.END,  f"已删除: {file}\n")
                                                                    if(姓名!=""):
                                                                        tongy="1"
                                                                        uuser = Account1(name, tongy, "缓存清理工具{清理成功}", "操作:07自动操作{清理文件}")
                                                                        uuser.record_history()
                                                                except Exception as e:
                                                                    text_box2.insert(tk.END,  f"删除失败: {file} - {e}\n")
                                                                    if(姓名!=""):
                                                                        tongy="1"
                                                                        uuser = Account1(name, tongy, "缓存清理工具{清理失败}", "操作:07自动操作{清理文件}")
                                                                        uuser.record_history()
                                                            progress_bar['value'] = i + 1 
                                                            window.update_idletasks() 
                                                     
                                                    # 创建主窗口 
                                                    window = tk.Tk()
                                                    window.title(" OFFICE 缓存管理器")
                                                    window.geometry("320x303")
                                                    window.resizable(False, False) 
                                                    # 创建检测缓存按钮 
                                                    detect_button = ttk.Button(window, text="检测缓存", command=detect_cache)
                                                    detect_button.place(x=3,y=7)
                                                     
                                                    # 创建文本框用于显示检测到的缓存文件 
                                                    text_box1 = tk.Text(window, height=7, width=44)
                                                    text_box1.place(x=3,y=41)
                                                    
                                                     
                                                    # 创建文本框用于显示清理结果 
                                                    text_box2 = tk.Text(window, height=7, width=44)
                                                    text_box2.place(x=3,y=141)
                                                    # 创建进度条 
                                                    progress_bar = ttk.Progressbar(window, orient='horizontal', length=311, mode='determinate')
                                                    progress_bar.place(x=4,y=244)
                                                     
                                                    
                                                    # 创建清理缓存按钮 
                                                    clean_button = ttk.Button(window, text="清理缓存", command=clean_cache)
                                                    clean_button.place(x=3,y=272)




                                         
                                            fuzhu = tk.Menu(menu_bar, tearoff=0)
                                            fuzhu.add_command(label="文件管理 Alt+w",command=管理)
                                            fuzhu.add_command(label="缓存清理 Alt+q",command=清理)
                                            word.bind('<Alt-w>', lambda event: 管理())
                                            word.bind('<Alt-q>', lambda event: 清理())
                                        
     


                                            
                                                  


                                            def 输入式():
                                                from tkinter.font import Font
                                                global 姓名
                                                name=姓名
                                                if(姓名!=""):
                                                        tongy="1"
                                                        uuser = Account1(姓名, tongy, "计算器工具", "操作:06运行{计算代码}")
                                                        uuser.record_history()
                                                j=tkinter.Tk()
                                                j.title("OFFICE 计算器")
                                                j.geometry("287x420")

                                                a=tk.Label(j,text="第一个数字",font=("微软雅黑",13))
                                                a.place(x=7,y=60)
                                                b=tk.Label(j,text="第二个数字",font=("微软雅黑",13))
                                                b.place(x=7,y=130)
                                                entry11=ttk.Entry(j,text="",font=("微软雅黑",13))
                                                entry11.place(x=7,y=90,width=273,height=34)
                                                entry22=ttk.Entry(j,text="",font=("微软雅黑",13))
                                                entry22.place(x=7,y=160,width=273,height=34)
                                                s=0
                                                custom_font = Font(family="Helvetica", size=15, weight="bold")
                                                j.resizable(True, False)  # 禁止窗口调整大小
                                                # 创建样式
                                                style = ttk.Style()

                                                # 配置一个新的样式并指定字体
                                                style.configure('Custom.TButton', font=custom_font)
                                                def 加法():
                                                     nonlocal entry11,entry22,s
                                                     try:
                                                          d=float(entry11.get())
                                                          e=float(entry22.get())
                                                          s=d+e
                                                          f=tk.Label(j,text="                                                                                                                                                                                                                                                                                                                                                                                                                                      ",font=("微软雅黑",25))
                                                          f.place(x=3,y=13)
                                                          f=tk.Label(j,text=s,font=("微软雅黑",25,"bold"))
                                                          f.place(x=4,y=13)
                                                     except:
                                                          f=tk.Label(j,text="输入错误",font=("微软雅黑",22,"bold"),fg="#FF6A6A")
                                                          f.place(x=4,y=13)

                                                def 减法():
                                                     nonlocal entry11,entry22,s
                                                     try:
                                                          d=float(entry11.get())
                                                          e=float(entry22.get())
                                                          s=d-e
                                                          f=tk.Label(j,text="                                                                                                                                                                                                                                                                                                                                                                                                                                      ",font=("微软雅黑",25))
                                                          f.place(x=3,y=13)
                                                          f=tk.Label(j,text=s,font=("微软雅黑",25,"bold"))
                                                          f.place(x=4,y=13)
                                                     except:
                                                          f=tk.Label(j,text="输入错误",font=("微软雅黑",22,"bold"),fg="#FF6A6A")
                                                          f.place(x=4,y=13)

                                                def 除法():
                                                     nonlocal entry11,entry22,s
                                                     try:
                                                          d=float(entry11.get())
                                                          e=float(entry22.get())
                                                          s=d/e
                                                          f=tk.Label(j,text="                                                                                                                                                                                                                                                                                                                                                                                                                                      ",font=("微软雅黑",25))
                                                          f.place(x=3,y=13)
                                                          f=tk.Label(j,text=s,font=("微软雅黑",25,"bold"))
                                                          f.place(x=4,y=13)
                                                     except:
                                                          f=tk.Label(j,text="输入错误",font=("微软雅黑",22,"bold"),fg="#FF6A6A")
                                                          f.place(x=4,y=13)

                                                def 乘法():
                                                     nonlocal entry11,entry22,s
                                                     try:
                                                          d=float(entry11.get())
                                                          e=float(entry22.get())
                                                          s=d*e
                                                          f=tk.Label(j,text="                                                                                                                                                                                                                                                                                                                                                                                                                                      ",font=("微软雅黑",25))
                                                          f.place(x=3,y=13)
                                                          f=tk.Label(j,text=s,font=("微软雅黑",25,"bold"))
                                                          f.place(x=4,y=13)
                                                     except:
                                                          f=tk.Label(j,text="输入错误",font=("微软雅黑",22,"bold"),fg="#FF6A6A")
                                                          f.place(x=4,y=13)

                                                ja=ttk.Button(j,text="+",style="Custom.TButton",command=加法)
                                                ja.place(x=7,y=205,width=273,height=38)

                                                jj=ttk.Button(j,text="-",style="Custom.TButton",command=减法)
                                                jj.place(x=7,y=252,width=273,height=38)

                                                cf=ttk.Button(j,text="×",style="Custom.TButton",command=乘法)
                                                cf.place(x=7,y=299,width=273,height=38)

                                                cc=ttk.Button(j,text="÷",style="Custom.TButton",command=除法)
                                                cc.place(x=7,y=346,width=273,height=38)
                                                j.mainloop()


                        
                                            def 时钟():
                                                global 姓名
                                                name=姓名
                                                if(姓名!=""):
                                                        tongy="1"
                                                        uuser = Account1(姓名, tongy, "打开时钟工具", "操作:06运行{时钟代码-正计时并初始化}")
                                                        uuser.record_history()
                                                hour='00'
                                                minute='00'
                                                second='00'
                                                time=tk.Tk()
                                                time.title('OFFICE 时钟-正计时')
                                                time.geometry('320x303')
                                                time.resizable(False, False)  # 禁止窗口调整大小
                                                canva=tk.Canvas(time,width=390,height=400)
                                                canva.place(x = 0,y=0,width = 320,height = 270)


                                                theScreen=turtle.TurtleScreen(canva)
                                                asd=turtle.RawTurtle(theScreen)
                                                zxc=turtle.RawTurtle(theScreen)
                                                qwe=turtle.RawTurtle(theScreen)
                                                asd.hideturtle()
                                                qwe.hideturtle()
                                                zxc.hideturtle()
                                                qwe.speed(0)
                                                zxc.speed(0)
                                                def 初始化():
                                                     asd.clear()
                                                     zxc.clear()

                                                     
                                                     
                                                     asd.penup()
                                                     asd.goto(38,-190)
                                                     asd.pendown()
                                                     asd.color('#EDEDED')
                                                     #调试turtle的笔粗
                                                     asd.pensize(17)
                                                     #调试turtle的速度
                                                     asd.speed(0)
                                                     asd.setheading(0)
                                                     asd.circle(122)



                                                     qwe.color('grey')
                                                     qwe.penup()
                                                     qwe.goto(38,-180)
                                                     qwe.pendown()
                                                     qwe.speed(0)
                                                     qwe.pensize(1)
                                                     qwe.circle(112)

                                                     qwe.color('grey')
                                                     qwe.penup()
                                                     qwe.goto(38,-200)
                                                     qwe.pendown()
                                                     qwe.speed(0)
                                                     qwe.pensize(1)
                                                     qwe.circle(132)

                                                     zxc.speed(0)
                                                     zxc.penup()
                                                     zxc.goto(-56,-87)
                                                     zxc.pendown()
                                                     zxc.color('#7f8371')
                                                     zxc.write('00:00:00',font=('黑体',34,'bold'))

                                                style=ttk.Style()
                                                style.configure('n.TButton',font=('微软雅黑',9))
                                                模式=[1,0]
                                                停止z=0
                                                秒秒=''
                                                计时器次数=0
                                                时=0
                                                分=0
                                                秒=0
                                                判断=0
                                                #模式[正计时,倒计时]
                                                def 录入时间():
                                                      time.title('OFFICE 时钟-倒计时')
                                                      nonlocal 时,分,秒
                                                      
                                                      模式=[0,1]
                                                      录入=tk.Tk()
                                                      录入.title('OFFICE 时钟-录入')
                                                      录入.resizable(False, False)  # 禁止
                                                      录入.geometry('215x225')
                                                      label1=tkinter.Label(录入,text="请在文本中选取录入位置")
                                                      label1.place(x=20,y=18)
                                                      label2=tkinter.Label(录入,text=str(时)+"时")
                                                      label2.place(x=26,y=87)
                                                      def up():
                                                          nonlocal 时,分,秒
                                                          时+=1
                                                          时=int(时)
                                                          if(时>24):
                                                              hour=24
                                                              return
                                                          
                                                          label2=tkinter.Label(录入,text="      ")
                                                          label2.place(x=26,y=87)
                                                          label2=tkinter.Label(录入,text=str(时)+"时")
                                                          label2.place(x=26,y=87)
                                                          
                                                      def down():
                                                          nonlocal 时,分,秒
                                                     
                                                          时=int(时)
                                                          时-=1
                                                          if(时<0):
                                                              时=1
                                                              return
                                                          label2=tkinter.Label(录入,text="      ")
                                                          label2.place(x=26,y=87)
                                                          label2=tkinter.Label(录入,text=str(时)+"时")
                                                          label2.place(x=26,y=87)
                                                      
                                                      btn1=ttk.Button(录入,text="""↑""",command=up)
                                                      btn1.place(x=23,y=57,width=36)
                                                      btn2=ttk.Button(录入,text="""↓""",command=down)
                                                      btn2.place(x=23,y=117,width=36)


                                                      
                                                      label2=tkinter.Label(录入,text=str(分)+"分")
                                                      label2.place(x=91,y=87)
                                                      def upp():
                                                          nonlocal 时,分,秒
                                                          分=int(分)
                                                          分+=1
                                                          
                                                          if(分>59):
                                                              分=59
                                                              return
                                                          label2=tkinter.Label(录入,text="       ")
                                                          label2.place(x=91,y=87)
                                                          label2=tkinter.Label(录入,text=str(分)+"分")
                                                          label2.place(x=91,y=87)
                                                      def downn():
                                                          nonlocal 时,分,秒
                                                          分=int(分)
                                                          分-=1
                                                          if(分<0):
                                                              分=0
                                                              return
                                                          label2=tkinter.Label(录入,text="       ")
                                                          label2.place(x=91,y=87)
                                                          label2=tkinter.Label(录入,text=str(分)+"分")
                                                          label2.place(x=91,y=87)
                                                          
                                                      btn3=ttk.Button(录入,text="""↑""",command=upp)
                                                      btn3.place(x=88,y=57,width=36)
                                                      btn4=ttk.Button(录入,text="""↓""",command=downn)
                                                      btn4.place(x=88,y=117,width=36)
                                                      label2=tkinter.Label(录入,text=str(秒)+"秒")
                                                      label2.place(x=159,y=87)
                                                      
                                                      def upp():
                                                          nonlocal 时,分,秒
                                                          秒=int(秒)
                                                          秒+=1
                                                          
                                                          if(秒>59):
                                                              秒=59
                                                              return
                                                          label2=tkinter.Label(录入,text="       ")
                                                          label2.place(x=159,y=87)
                                                          label2=tkinter.Label(录入,text=str(秒)+"秒")
                                                          label2.place(x=159,y=87)
                                                      def downn():
                                                          nonlocal 时,分,秒
                                                          秒=int(秒)
                                                          秒-=1
                                                          if(秒<0):
                                                              秒=0
                                                              return
                                                          label2=tkinter.Label(录入,text="       ")
                                                          label2.place(x=159,y=87)
                                                          label2=tkinter.Label(录入,text=str(秒)+"秒")
                                                          label2.place(x=159,y=87)
                                                          
                                                      btn3=ttk.Button(录入,text="""↑""",command=upp)
                                                      btn3.place(x=154,y=57,width=36)
                                                      btn4=ttk.Button(录入,text="""↓""",command=downn)
                                                      btn4.place(x=154,y=117,width=36)
                                                      def OK():
                                                           nonlocal 模式,判断
                                                           模式=[0,1]
                                                           判断=1
                                                           录入.destroy()
                                                           启动_助()
                                                           
                                                      def Cencel():
                                                           nonlocal 判断
                                                           判断=0
                                                           时=0
                                                           分=0
                                                           秒=0
                                                           录入.destroy()
                                                               
                                                      btn6=ttk.Button(录入,text='OK',command=OK)
                                                      btn6.place(x=23,y=167,width=83)
                                                      btn7=ttk.Button(录入,text='Cancel',command=OK)
                                                      btn7.place(x=108,y=167,width=83)

                                                time_总=0
                                                def 启动_助():
                                                     nonlocal 模式,停止z,hour,minute,second,秒秒,zxc,计时器次数,判断,时,分,秒,time_总
                                                     
                                                     if(判断==1):
                                                          模式=[0,1]
                                                          second=int(秒)
                                                          minute=int(分)
                                                          hour=int(时)
                                                          time_总=int(时)*60*60+int(分)*60+int(second)
                                                          
                                                     if(计时器次数==0):
                                                          启动()
                                                          计时器次数+=1
                                                     else:
                                                          计时器次数+=1
                                                          停止z=0
                                                     判断=0
                                                     
                                                     时=0
                                                     分=0
                                                     秒=0
                                                     
                                                time_str=''
                                                最小化化=0
                                                def 启动():
                                                     nonlocal 模式,停止z,hour,minute,second,秒秒,zxc,时,分,秒,time_str,计时器次数,time_总,最小化化

                                                     if(停止z!=1 and 最小化化==0):
                                               
                                                          if(模式==[1,0]):
                                                               now=datetime.now()
                                                               秒秒秒={now.second}
                                                               if(秒秒!=秒秒秒):
                                                                    秒秒=秒秒秒
                                                                    second=int(second)+1
                                                                    if(int(second)<10):
                                                                         second='0'+str(second)
                                                                    if(int(second)>59):
                                                                         second=0
                                                                         minute=int(minute)+1
                                                                         if(int(minute)<10):
                                                                              minute='0'+str(minute)
                                                                         if(int(minute)>59):
                                                                              minute=0
                                                                              hour=int(hour)+1
                                                                              if(int(hour)<10):
                                                                                   hour='0'+str(hour)
                                                                    if(int(second)==0):
                                                                         second='00'
                                                                    if(int(minute)==0):
                                                                         minute='00'
                                                                    if(int(hour)==0):
                                                                         hour='00'

                                                                    asd.clear()
                                                                    asd.hideturtle()
                                                                    asd.penup()
                                                                    asd.goto(38,-190)
                                                                    asd.pendown()
                                                                    asd.color('#FFB348')
                                                                    #调试turtle的笔粗
                                                                    asd.pensize(17)
                                                                    #调试turtle的速度
                                                                    asd.speed(0)
                                                                    asd.setheading(0)
                                                                    asd.circle(122)
                                                                              
                                                                    zxc.clear()
                                                                    
                                                                    
                                                                    hour=str(hour)
                                                                    second=str(second)
                                                                    minute=str(minute)
                                                                    zxc.speed(0)
                                                                    zxc.penup()
                                                                    zxc.goto(-56,-87)
                                                                    zxc.pendown()
                                                                    zxc.color('black')
                                                                    zxc.write(hour+':'+minute+':'+second,font=('黑体',34,'bold'))
                                                          else:
                                                                    now=datetime.now()
                                                                    秒秒秒={now.second}
                                                                    
                                                                       
                                                                    if(秒秒!=秒秒秒):
                                                                         秒秒=秒秒秒
                                                                         
                                                                         hour = int(hour)
                                                                         minute = int(minute)
                                                                         second = int(second)
                                                                         
                                                                         # 自动格式化显示 
                                                                         time_str = f'{hour}:{minute}:{second}'
                                                                         
                                                                         
                                                                         # 时间递减逻辑
                                                                         if time_str == "0:0:0":
                                                                              asd.clear()
                                                                              asd.hideturtle()
                                                                              asd.penup()
                                                                              asd.goto(38,-190)
                                                                              asd.pendown()
                                                                              asd.color('#EDEDED')
                                                                              #调试turtle的笔粗
                                                                              asd.pensize(17)
                                                                              #调试turtle的速度
                                                                              asd.speed(0)
                                                                              asd.setheading(0)
                                                                              asd.circle(122)
                                                                              
                                                                              zxc.clear()
                                                                              
                                                                              hour=str(hour)
                                                                              second=str(second)
                                                                              minute=str(minute)
                                                                              zxc.speed(0)
                                                                              zxc.penup()
                                                                              zxc.goto(-56,-87)
                                                                              zxc.pendown()
                                                                              zxc.color('#7f8371')
                                                                              zxc.write('00:00:00',font=('黑体',34,'bold'))
                                                                              global 弹窗_提示窗
                                                                              if(弹窗_提示窗==[1,0]):
                                                                                    弹窗 = Tk()
                                                                                    弹窗.title("便利贴 OFFICE【PET/7.V.v】")
                                                                                    弹窗.attributes('-topmost',  True)
                                                                                    # 使用 ttk 创建一个框架 
                                                                                    frame = ttk.Frame(弹窗, padding="10 10 10 10")
                                                                                    frame.pack(fill="both",  expand=True)
                                                                                     
                                                                                    # 添加一个标签 
                                                                                    label = ttk.Label(frame, text="便利贴 OFFICE",font=("微软雅黑",13,"bold"))
                                                                                    label.place(x=3,y=1)
                                                                                    label2=ttk.Label(frame,text=f"倒计时已结束",font=("微软雅黑",11))
                                                                                    label2.place(x=3,y=38)
                                                                                    def OK():
                                                                                         弹窗.destroy()
                                                                                    def on_closing():
                                                                                                        pass  # 不执行任何操作，阻止关闭 
                                                                                                     
                                                                                                    
                                                                                    弹窗.protocol("WM_DELETE_WINDOW",  on_closing)

                                                                                    btn1=ttk.Button(frame,text="我知道了",comman=OK)
                                                                                    btn1.place(x=3,y=160,height=36,width=334)
                                                                                    # 设置窗口的初始位置（右下角坐标）
                                                                                    def place_window_to_bottom_right(root, window_width=360, window_height=220):
                                                                                                                # 获取屏幕的宽度和高度
                                                                                                                screen_width = root.winfo_screenwidth()
                                                                                                                screen_height = root.winfo_screenheight()

                                                                                                                # 计算窗口左上角的坐标
                                                                                                                x_coordinate = screen_width - window_width - 24  # 从右侧留出一点空间
                                                                                                                y_coordinate = screen_height - window_height - 94  # 从底部留出一点空间（考虑到任务栏）

                                                                                                                # 设置窗口的大小和位置
                                                                                                                弹窗.geometry(f"{window_width}x{window_height}+{x_coordinate}+{y_coordinate}")
                                                                                                               # 使用函数将窗口放置到右下角
                                                                                    place_window_to_bottom_right(弹窗)
                                                                              else:
                                                                                    tkinter. messagebox.showinfo("便利贴 OFFICE",f"倒计时已结束")
                                                                              time.title('OFFICE 时钟-正计时')
                                                                              停止()
                                                                              复位()
                                                                         else:
                                                                              if(int(second)<10):
                                                                                   second='0'+str(second)
                                                                              if(int(minute)<10):
                                                                                   minute='0'+str(minute)
                                                                              if(int(hour)<10):
                                                                                   hour='0'+str(hour)
                                                                              if(int(second)==0):
                                                                                   second='00'
                                                                              if(int(minute)==0):
                                                                                   minute='00'
                                                                              if(int(hour)==0):
                                                                                   hour='00'
                                                                              # 自动格式化显示 
                                                                              time_str = f'{hour}:{minute}:{second}'
                                                                              time_now=int(hour)*60*60+int(minute)*60+int(second)
                                                                              
                                                                              度数=360/time_总*time_now
                                                                              
                                                                              asd.clear()
                                                                              asd.hideturtle()
                                                                              asd.penup()
                                                                              asd.goto(38,-190)
                                                                              asd.pendown()
                                                                              asd.color('#FFB348')
                                                                              #调试turtle的笔粗
                                                                              asd.pensize(17)
                                                                              #调试turtle的速度
                                                                              asd.speed(0)
                                                                              度数=int(度数)
                                                                              #防止asd乱跑
                                                                              asd.setheading(0)
                                                                              
                                                                              asd.circle(122,度数)
                                                     
                                                                              zxc.clear()
                                                                              
                                                                              hour=str(hour)
                                                                              second=str(second)
                                                                              minute=str(minute)
                                                                              zxc.speed(0)
                                                                              zxc.penup()
                                                                              zxc.goto(-56,-87)
                                                                              zxc.pendown()
                                                                              zxc.color('black')
                                                                              zxc.write(hour+':'+minute+':'+second,font=('黑体',34,'bold'))

                                                                              hour = int(hour)
                                                                              minute = int(minute)
                                                                              second = int(second)
                                                                              second -= 1 
                                                                              if int(second) < 0:
                                                                                 second = 59 
                                                                                 minute -= 1 
                                                                                 if int(minute) < 0:
                                                                                     minute = 59 
                                                                                     hour -= 1 
                                                                                     if int(hour) < 0:
                                                                                         hour = 0  # 归零处理
                                                        


                                                                         
                                                     time.after(100,启动)
                                                                    
                                                def 停止():
                                                     nonlocal 停止z,时,分,秒,hour,minute,second
                                                     
                                                     时=0
                                                     分=0
                                                     秒=0
                                                     停止z=1
                                                     asd.penup()
                                                     zxc.penup()

                                                def 复位():
                                                     nonlocal 模式,停止,hour,minute,second,秒秒,zxc
                                                     模式=[1,0]
                                                     停止z=1
                                                     秒秒=''
                                                     time.title('OFFICE 计时器-正计时')
                                                     hour='00'
                                                     minute='00'
                                                     second='00'
                                                     
                                                     初始化()




                                                def 最小化():
                                                    global 状态
                                                    nonlocal 提示标签,worddd
                                                    if(提示标签!=0):
                                                        worddd.destroy()
                                                    提示标签=0
                                                    状态=1
                                                    新建()
                                                    
                                                
                                                初始化()
                                                btn1=ttk.Button(time,text='录入时间',style='n.TButton',command=录入时间)
                                                btn1.place(x=50,y=272,width=70)
                                                btn5=ttk.Button(time,text='[＋]',style='n.TButton',command=最小化)
                                                btn5.place(x=14,y=272,width=30)


                                                btn2=ttk.Button(time,text='启动',style='n.TButton',command=启动_助)
                                                btn2.place(x=145,y=272,width=50)
                                                btn3=ttk.Button(time,text='停止',style='n.TButton',command=停止)
                                                btn3.place(x=200,y=272,width=50)
                                                btn4=ttk.Button(time,text='复位',style='n.TButton',command=复位)
                                                btn4.place(x=255,y=272,width=50)


                                            fuzhu.add_command(label="计算器 Alt+j",command=输入式)
                                            fuzhu.add_command(label='时钟 Alt+t',command=时钟)
                                            word.bind('<Alt-j>', lambda event: 输入式())
                                            word.bind('<Alt-t>', lambda event:时钟())
                                            menu_bar.add_cascade(label="辅助",menu=fuzhu)
                                            
                                            # 关于菜单
                                            
                                            about_menu = tk.Menu(menu_bar, tearoff=0)
                                            about_menu.add_command(label="介绍", command=js)
                                            about_menu.add_command(label="帮助", command=帮助)
                                            menu_bar.add_cascade(label="关于", menu=about_menu)
                                            旬报=txt_edit.get('1.0',tk.END)

                                            
                                  
                                            登录=0

                                            切换_List=[0,0,0,0]
                                            def 简历():
                                                nonlocal 登录,切换_List,v_scrollbar
                                                global 频道,姓名
                                                
                                                name=姓名
                                                
                                                if 登录==1:
                                                    close()
                                                    账户()
                                                else:
                                               
                                                  
                                                  频道='02'
                                                  if(切换_List[0]==1):
                                                      return
                                                  切换_List[0]=1
                                                  切换()
                                                  label_盖住=tk.Label(text='                                                                    \n                                                                    \n                                                                    \n                                                                    \n                                                                    \n                                                                    \n                                                                    \n                                                                    \n                                                                    \n                                                                    \n                                                                    \n                                                                    \n                                                                    \n                                                                    \n                                                                    \n                                                                    \n                                                                    \n                                                                    \n                                                                    \n                                                                    \n                                                                    \n                                                                    \n                                                                    \n                                                                    \n                                                                    \n                                                                    \n                                                                    \n                                                                   \n')
                                                  label_盖住.place(x=510,y=0)
                                                  # 创建垂直滚动条并与文本编辑框关联
                                                  v_scrollbar.destroy()
                                                  v_scrollbar = tk.Scrollbar(word, orient=tk.VERTICAL, command=txt_edit.yview)
                                                  v_scrollbar.pack(side=tk.RIGHT, fill=tk.Y)
                                                  txt_edit.config(yscrollcommand=v_scrollbar.set)
                                                  word.geometry('740x417')
                                                  txt_edit.config(width=45)
                                                  
                                                  
                                                  truncated_name=''
                                                  姓名名=姓名
                                                  def truncate_name(姓名):
                                                    
                                                    if len(姓名) > 8:
                                                        return 姓名[:8] + '...'
                                                    else:
                                                        return 姓名

                                                  truncated_name = truncate_name(姓名)
                                                  name=truncated_name

                                                  truncated_name=''
                                                  with(open(姓名名+'.rtf','r'))as f:
                                                      a=f.readlines()
                                                      b=a[-1]
                                                      b=b.split(',')
                                                      passward=b[1]
                                                      passward=passward.split('密码:')
                                                      passward=passward[1]
                                                  #print(passward)
                                                  #passward=list(passward)
                                                  显示=int(len(passward)/3*2)
                                                  def truncate_name(passward):
                                                
                                                    return passward[:显示] + '...'
                                                  
                                                
                                                    # 截断名字
                                                  truncated_name = truncate_name(passward)
                                                  passward=truncated_name
                                                  #print(passward)

                                                  姓名=姓名名
                                                  uuser = Account1(姓名, '1', "个人信息{正阅览}", "操作:06运行{个人信息输出代码}")
                                                  uuser.record_history()
                                                  label1=tk.Label(word,text=name,font=('微软雅黑',13))
                                                  label1.place(x=465,y=57)
                                                  label2=tk.Label(word,text='个人信息',font=('幼圆',13,'bold'))
                                                  label2.place(x=505,y=7)
                                                  f=open(姓名+'.rtf','r')
                                                  a=f.readlines()
                                                  b=a[-1]
                                                  b=b.split(',')
                                                  c=b[1]
                                                  d=b[4]
                                                  d=d.split('\n')
                                                  d=d[0]
                                                  d=d.split('/&&')
                                                  d=d[0]
                                                  
                                                  label4=tk.Label(word,text='密码:'+str(passward),font=('微软雅黑',11))
                                                  label4.place(x=465,y=153)
                                                  label5=tk.Label(word,text=str(d),font=('微软雅黑',11))
                                                  label5.place(x=465,y=117)
                                                
                                                  
                                                  
                                                  
                                                  def 返回():
                                                      global 频道
                                                      频道='00'
                                                      btn3.destroy()
                                                      btn44.destroy()
                                                      label4.destroy()
                                                      label1.destroy()
                                                      label3.destroy()
                                                      label5.destroy()
                                                      btn6.destroy()
                                                      label.destroy()
                                                      label_盖住.destroy()
                                                      btn5.destroy()
                                                      label2.destroy()
                                                   
                                                      btn7.destroy()
                                                      label44.destroy()
                                                      word.geometry('473x417')
                                                      切换()

                                                      
                                                      return
                                                  style=ttk.Style()
                                                  style.configure('m.TButton',font=('微软雅黑',12))
                                                  style=ttk.Style()
                                                  style.configure('n.TButton',font=('微软雅黑',9))
                                                  btn3=tkinter.Button(word,text="<返回",font=("微软雅黑",11),borderwidth=-1,fg='black',bg='#EDEDED',activebackground='#cecfcb',command=返回)
                                                  btn3.place(x=461,y=3,width=45,height=33)
                                          
                                                  def 更改密码():
                                                    global 姓名
                                                    更改 = tk.Tk()
                                                    更改.title('OFFICE 安全&设置')
                                                    更改.geometry('260x270')
                                                    uuser = Account1(姓名, '1', "更改密码{正登记}", "操作:09更改{预备状态}")
                                                    uuser.record_history()
                                                    
                                                    a=0
                                                    def toggle_password_visibility():
                                                        nonlocal a
                                                        if show_password.get():

                                                            if a==1:
                                                                a-=1
                                                                entry14.config(show='') 
                                                            else:
                                                                a+=1
                                                                entry14.config(show='·') 
                                                    
                                                    entry11 = ttk.Entry(更改, font=('微软雅黑', 10))
                                                    entry11.place(x=17,  y=37, height=33, width=220)
                                                    entry14 = ttk.Entry(更改, font=('微软雅黑', 10))
                                                    entry14.place(x=17,  y=86, height=33, width=220)
                                                    entry14.insert(0,  '请输入现更改密码')
                                                    entry11.insert(0,  '请输入原密码')
                                                    
                                                    show_password = tk.BooleanVar()
                                                    show_password.set(True)   # 默认不显示密码 
                                                    
                                                    check_button = tk.Checkbutton(
                                                        更改,
                                                        text="隐藏输入框密码",
                                                        font=("april", 10),
                                                        fg="orange",
                                                        variable=show_password,
                                                        command=toggle_password_visibility 
                                                    )
                                                    check_button.place(x=17,  y=136)
                                                    
                                                    entry11.bind('<Button-1>',  lambda e: entry11.delete(0,  tk.END))
                                                    entry14.bind('<Button-1>',  lambda e: entry14.delete(0,  tk.END))
                                                    
     
                                                    cs=0
                                                    ydcs=5
                                                    def 下一步():
                                                            
                                                            nonlocal entry11,entry14,cs,ydcs
                                                            global 姓名,tongy
                                                            name=姓名
                                                            f=open(姓名+'.rtf','r')
                                                            
                                                            a=f.readlines()
                                                            b=a[-1]
                                                            c=b.split(',')
                                                            passward=c[1]
                                                            
                                                            if(entry11.get()!='' and entry11.get()!='请输入原密码' and entry14.get()!='' and entry14.get()!='请输入现更改密码'):
                                                               

                                                                
                                                                if('密码:'+entry11.get()==passward):
                                                                    passwa=entry14.get()
                                                                    entry14.destroy()
                                                                    check_button.destroy()
                                                                    btn5.destroy()
                                                                    entry11.destroy()
                                                                    entry11 = ttk.Entry(更改, font=('微软雅黑', 10))
                                                                    entry11.place(x=17,  y=77, height=33, width=220)
                                                                    entry11.insert(0,'请输入防伪码')
                                                                    entry14 = ttk.Entry(更改, font=('微软雅黑', 10))
                                                                    entry14.place(x=17,  y=126, height=33, width=220)
                                                                    entry14.insert(0,  '请再次输入更改后的密码')
                                                                    entry14.bind('<Button-1>',  lambda e: entry14.delete(0,  tk.END))
                                                    

                                                                    entry11.bind('<Button-1>',  lambda e: entry11.delete(0,  tk.END))
                                                                    随机=[]
                                                                    s=''
                                                                    for i in range(6):
                                                                        随机.append(random.randint(0,9))
                                                                        随机[i]=str(随机[i])
                                                                        s=s+随机[i]
                                                                    label1=tk.Label(更改,text=随机[0]+'%'+随机[1]+随机[2]+'[$^'+随机[3]+'*)'+随机[4]+']@#'+随机[5],font=('微软雅黑',13))
                                                                    label1.place(x=51,y=37)
                                                                    cs=0
                                                                    ydcs=5
                                                                    dagouu=0
                                                                    sssss=0
                                                                    def jiedong():
                                                                                global verification_code,姓名,弹窗_提示窗
                                                                                verification_code = ''.join([str(random.randint(0, 9)) for _ in range(6)])
                                                                                global sssss
                                                                                sssss=0
                                                                                qc = tk.Tk()
                                                                                qc.title("OFFICE 安全")
                                                                                qc.geometry("285x280")  # 进一步缩小窗口大小
                                                                                qc.resizable(False, False)
                                                                                qr_label = tk.Label(qc)
                                                                                qr_label.place(x=20, y=120)
                                                                                # 重新创建新的控件
                                                                                entry23 = ttk.Entry(qc, font=("微软雅黑", 10))
                                                                                entry23.place(x=20, y=40, width=134, height=30)
                                                                                entry23.insert(0, "请输入右式验证码")
                                                                                entry23.bind('<Button-1>', lambda e: entry23.delete(0, tk.END))

                                                                                # 生成随机数作为验证码
                                                                                #verification_code = ''.join([str(random.randint(0, 9)) for _ in range(6)])
                                                                                canva = tk.Canvas(qc, width=100, height=34)
                                                                                canva.place(x=170, y=38, width=100, height=34)

                                                                                progress = ttk.Progressbar(qc, orient="horizontal", length=248, mode='determinate')
                                                                                progress.place(x=20,y=78)


                                                                                # 可以在这里检测是否安装库等


                                                                                colours = ["red", "orange", "green", "yellow", "purple", "grey", "pink", "black"]
                                                                                theScreen = turtle.TurtleScreen(canva)
                                                                                asd = turtle.RawTurtle(theScreen)
                                                                                asd.penup()
                                                                                asd.goto(-30, -14)
                                                                                asd.pendown()
                                                                                asd.write(verification_code, font=("Arial", 13, "normal"))
                                                                                asd.penup()
                                                                                asd.goto(-33, -7)
                                                                                asd.pendown()
                                                                                b = random.randint(0, 7)
                                                                                c = random.randint(8, 15)
                                                                                asd.color(colours[b])
                                                                                asd.write("-------------", font=("Arial", 11, "normal"))
                                                                                asd.penup()
                                                                                asd.goto(-33, -14)
                                                                                asd.pendown()
                                                                                asd.color(colours[c-8])
                                                                                asd.write("————", font=("Arial", 11, "normal"))

                                                                                def toggle_password_visibilityy():
                                                                                         nonlocal dagouu
                                                                                         global sssss
                                                                                         if(sssss==0):
                                                                                             dagouu+=1
                                                                                             sssss=1
                                                                                         else:
                                                                                             dagouu-=1
                                                                                             sssss=0
                                                                                def qr():
                                                                                    
                                                                                    global namee,cs,ydcs,弹窗_提示窗,姓名
                                                                                    name=namee
                                                                                    nonlocal dagouu
                                                                                    import importlib
                                                                                    import subprocess
                                                                                    import sys
                                                                                    from tkinter import messagebox
                                                                                    global verification_code
                                                                                    def install_and_import(package, package_name_for_install=None):
                                                                                        """Install and import the given package if it's not already available."""
                                                                                        package_name_for_install = package_name_for_install or package
                                                                                        
                                                                                        try:
                                                                                            # Try to import the module
                                                                                            importlib.import_module(package)
                                                                                        except ImportError:
                                                                                            response = messagebox.askyesno("缺少库", f"库 {package} 未安装。是否要现在安装？")
                                                                                            if response:
                                                                                                try:
                                                                                                    # Install the package using pip
                                                                                                    subprocess.check_call([sys.executable, "-m", "pip", "install", package_name_for_install])
                                                                                                    #messagebox.showinfo("安装完成", f"{package_name_for_install} 安装完成")
                                                                                                    label_提=tk.Label(qc,text=f"安装完成,{package_name_for_install} 安装完成",font=('微软雅黑',8),bg='#ffe1a9',fg='black')
                                                                                                    label_提.place(x=78,y=9)
                                                                                                    qc.after(2900,label_提.destroy)
                                                                                                    
                                                                                                    # Import the module after installation
                                                                                                    globals()[package] = importlib.import_module(package)
                                                                                                except subprocess.CalledProcessError as e:
                                                                                                    #messagebox.showerror("安装错误", f"安装 {package_name_for_install} 时发生错误: {e}")
                                                                                                    label_提=tk.Label(qc,text=f"安装错误,安装 {package_name_for_install} 时发生错误",font=('微软雅黑',8),bg='#ffd4d4',fg='black')
                                                                                                    label_提.place(x=70,y=9)
                                                                                                    qc.after(3300,label_提.destroy)
                                                                                                    sys.exit(1)  # Exit program to prevent subsequent code from crashing due to missing library
                                                                                            else:
                                                                                                #messagebox.showerror("手动安装", f"请手动安装 {package_name_for_install} 后再运行此程序。")
                                                                                                label_提=tk.Label(qc,text=f"手动安装,请手动安装 {package_name_for_install} 后再运行此程序。",font=('微软雅黑',8),bg='#ffd4d4',fg='black')
                                                                                                label_提.place(x=64,y=9)
                                                                                                qc.after(3600,label_提.destroy)
                                                                                                    
                                                                                                sys.exit(1)

                                                                                    def ensure_libraries_installed():
                                                                                        """Ensure all required libraries are installed."""
                                                                                        required_libraries = {
                                                                                            'cv2': 'opencv-python',
                                                                                            'PIL': 'Pillow',  # 注意：导入时使用的是 from PIL import Image
                                                                                            'PyPDF2': 'PyPDF2',
                                                                                            'reportlab': 'reportlab'
                                                                                        }

                                                                                        for package, package_name_for_install in required_libraries.items():
                                                                                            install_and_import(package, package_name_for_install)

                                                                                    def show_message(title, message, msg_type='info'):
                                                                                        """Display a message box with the given title and message."""
                                                                                        if msg_type == 'info':
                                                                                            messagebox.showinfo(title, message)
                                                                                        elif msg_type == 'warning':
                                                                                            messagebox.showwarning(title, message)
                                                                                        elif msg_type == 'error':
                                                                                            messagebox.showerror(title, message)

                                                                                    # 在程序启动时调用该函数以确保所有必需的库都已安装
                                                                                    ensure_libraries_installed()

                                                                                    # 现在可以正常使用所需的模块
                                                                                    try:
                                                                                        from PyPDF2 import PdfWriter, PdfReader
                                                                                        import cv2
                                                                                        from PIL import Image
                                                                                        from reportlab.lib.pagesizes import letter
                                                                                        from reportlab.pdfgen import canvas
                                                                                    except ImportError as e:
                                                                                        #show_message("导入错误", f"即使尝试安装后，仍无法导入某些库。请检查您的环境配置: {e}", 'error')
                                                                                        label_提=tk.Label(qc,text=f"导入错误,即使尝试安装后，仍无法导入某些库。请检查您的环境配置。",font=('微软雅黑',8),bg='#ffd4d4',fg='black')
                                                                                        label_提.place(x=54,y=9 )
                                                                                        qc.after(4000,label_提.destroy)
                                                                                        
                                                                                        sys.exit(1)

                                                                                    # 检查并显示 OpenCV 版本信息
                                                                                    try:
                                                                                                                                                                                pass
                                                                                    except NameError:
                                                                                        #show_message("导入错误", "即使尝试安装后，仍无法导入 cv2。请检查您的环境配置。", 'error')
                                                                                        label_提=tk.Label(qc,text=f"导入错误,即使尝试安装后，仍无法导入 cv2。请检查您的环境配置。",font=('微软雅黑',8),bg='#ffd4d4',fg='black')
                                                                                        label_提.place(x=54,y=9)
                                                                                        qc.after(4000,label_提.destroy)
                                                                                        sys.exit(1)
                                                                                               
                                                                                    
                                                                                    try:
                                                                                       
                                                                                        from PyPDF2 import PdfWriter, PdfReader
                                                                                        import cv2
                                                                                        from PIL import Image
                                                                                        from reportlab.lib.pagesizes import letter
                                                                                        from reportlab.pdfgen import canvas
                                                                                        
                                                                                        
                                                                                    except ImportError as e:
                                                                                        #messagebox.showerror("导入错误", f"即使尝试安装后，仍无法导入某些库。请检查您的环境配置: {e}")
                                                                                        label_提=tk.Label(qc,text=f"导入错误,即使尝试安装后，仍无法导入 cv2。请检查您的环境配置。",font=('微软雅黑',8),bg='#ffd4d4',fg='black')
                                                                                        label_提.place(x=54,y=9)
                                                                                        qc.after(4000,label_提.destroy)
                                                                                        sys.exit(1)
                                                                                   
                                                                                    
                                                                                    name = namee
                                                                                    
                                                                                    user_input = entry23.get().strip()

                                                                                    if user_input == verification_code:
                                                                                        i = 44
                                                                                        progress['value'] = i
                                                                                        qc.update_idletasks()

                                                                                        if dagouu == 1:
                                                                                                #messagebox.showinfo("系统消息:", "正在预备中")
                                                                                                label_提=tk.Label(qc,text=f" ! 正在预备中",font=('微软雅黑',8),bg='#ffe1a9',fg='black')
                                                                                                label_提.place(x=114,y=9)
                                                                                                qc.after(2500,label_提.destroy)

                                                                                                # 打开摄像头
                                                                                                cap = cv2.VideoCapture(0)
                                                                                                if not cap.isOpened():
                                                                                                    #show_message("摄像头错误", "无法打开摄像头", 'error')
                                                                                                    label_提=tk.Label(qc,text=f"×摄像头错误,无法打开摄像头",font=('微软雅黑',8),bg='#ffd4d4',fg='black')
                                                                                                    label_提.place(x=78,y=9)
                                                                                                    qc.after(2900,label_提.destroy)
                                                                                                    sys.exit(1)

                                                                                                ret, frame = cap.read()
                                                                                                if not ret:
                                                                                                    #show_message("图像读取错误", "无法读取图像", 'error')
                                                                                                    label_提=tk.Label(qc,text=f"×图像读取错误,无法读取图像",font=('微软雅黑',8),bg='#ffd4d4',fg='black')
                                                                                                    label_提.place(x=78,y=9)
                                                                                                    qc.after(2900,label_提.destroy)
                                                                                                    sys.exit(1)

                                                                                                image_path = 'photo.jpg'
                                                                                                cv2.imwrite(image_path, frame)
                                                                                                cap.release()

                                                                                                pdf_path = f'{name} photo_protected.pdf'
                                                                                                c = canvas.Canvas(pdf_path, pagesize=letter)
                                                                                                width, height = letter
                                                                                                c.drawImage(image_path, 72, 72, width=width-144, height=height-144)
                                                                                                c.showPage()
                                                                                                c.save()

                                                                                                with open(pdf_path, 'rb') as input_pdf:
                                                                                                    pdf_reader = PdfReader(input_pdf)
                                                                                                    pdf_writer = PdfWriter()
                                                                                                    for page in pdf_reader.pages:
                                                                                                        pdf_writer.add_page(page)
                                                                                                    verification_code = ''.join([str(random.randint(0, 9)) for _ in range(8)])
                                                                                                    pdf_writer.encrypt(user_password=verification_code)
                                                                                                    print(str(verification_code))

                                                                                                    with open(pdf_path, 'wb') as output_pdf:
                                                                                                        pdf_writer.write(output_pdf)

                                                                                                i = 100
                                                                                                progress['value'] = i
                                                                                                qc.update_idletasks()
                                                                                                s = f"PDF格式密码为: {verification_code}"
                                                                                                file_listbox.insert(tk.END, s)
                                                                                                os.remove("photo.jpg")
                                                                                                if(弹窗_提示窗==[1,0]):
                                                                                                    弹窗 = Tk()
                                                                                                    弹窗.title("便利贴 OFFICE【PET/7.V.v】")
                                                                                                    弹窗.attributes('-topmost',  True)
                                                                                                  # 使用 ttk 创建一个框架 
                                                                                                    frame = ttk.Frame(弹窗, padding="10 10 10 10")
                                                                                                    frame.pack(fill="both",  expand=True)
                                                                                                
                                                                                               # 添加一个标签 
                                                                                                    label = ttk.Label(frame, text="OFFICE 安全",font=("微软雅黑",13,"bold"))
                                                                                                    label.place(x=3,y=1)
                                                                                                    label2=ttk.Label(frame,text=f"操作完成,\n备份图像已保存为带密码保护的\nPDF:{pdf_path}",font=("微软雅黑",11))
                                                                                                    label2.place(x=3,y=38)
                                                                                                    def OK():
                                                                                              
                                                                                                      弹窗.destroy()
                                                                                                    def on_closing():
                                                                                                        pass  # 不执行任何操作，阻止关闭 
                                                                                                                                
                                                                                                                                    
                                                                                                    弹窗.protocol("WM_DELETE_WINDOW",  on_closing)

                                                                                                    btn1=ttk.Button(frame,text="我知道了",comman=OK)
                                                                                                    btn1.place(x=3,y=160,height=36,width=334)
                                                                                                    # 设置窗口的初始位置（右下角坐标）

                                                                                                    def place_window_to_bottom_right(root, window_width=360, window_height=220):
                                                                                                                # 获取屏幕的宽度和高度
                                                                                                                screen_width = root.winfo_screenwidth()
                                                                                                                screen_height = root.winfo_screenheight()

                                                                                                                # 计算窗口左上角的坐标
                                                                                                                x_coordinate = screen_width - window_width - 24  # 从右侧留出一点空间
                                                                                                                y_coordinate = screen_height - window_height - 94  # 从底部留出一点空间（考虑到任务栏）

                                                                                                                # 设置窗口的大小和位置
                                                                                                                弹窗.geometry(f"{window_width}x{window_height}+{x_coordinate}+{y_coordinate}")
                                                                                                               # 使用函数将窗口放置到右下角
                                                                                                    place_window_to_bottom_right(弹窗)
                                                                                                else:
                                                                                                    messagebox.showinfo("OFFICE 安全",f"操作完成,\n备份图像已保存为带密码保护的\nPDF:{pdf_path}")
                                                                                               
                                                                                                f = open(name + ".rtf", "r")
                                                                                                ff = open(name + "主控记录" + ".rtf", "r")
                                                                                                lines = f.readlines()
                                                                                                line = lines[-1]
                                                                                                lineList = line.split(",")
                                                                                                liness = ff.readlines()
                                                                                                linee = liness[-1]
                                                                                                lineListt = linee.split(",")
                                                                                                tongy = "1"

                                                                                              
                                                                                                
                                                                                                passward=lineList[1]
                                                                                                passward=passward.split('密码:')
                                                                                                passward=passward[2]
                                                                                                ydcs=5
                                                                                  
                                                                                                cs=0
                                                                                                balance = lineList[2].replace("当前资金:", "")
                                                                                                shenfen = "用户"
                                                                                                user = Account(name, passward, balance, "已解冻", shenfen)
                                                                                                user.record()
                                                                                                uuser = Account1(name, tongy, "OFFICE 安全{已解冻}", f"操作:01解冻{{并使用相机保存图像|设置代开密钥:{verification_code}}}")
                                                                                                uuser.record_history()
                                                                                                if(弹窗_提示窗==[1,0]):
                                                                                                    弹窗c = Tk()
                                                                                                    弹窗c.title("便利贴 OFFICE【PET/7.V.v】")
                                                                                                    弹窗c.attributes('-topmost',  True)
                                                                                                  # 使用 ttk 创建一个框架 
                                                                                                    frame = ttk.Frame(弹窗c, padding="10 10 10 10")
                                                                                                    frame.pack(fill="both",  expand=True)
                                                                                                
                                                                                               # 添加一个标签 
                                                                                                    label = ttk.Label(frame, text="OFFICE 安全",font=("微软雅黑",13,"bold"))
                                                                                                    label.place(x=3,y=1)
                                                                                                    label2=ttk.Label(frame,text=f"操作完成,\n请重启程序以解冻账户",font=("微软雅黑",11))
                                                                                                    label2.place(x=3,y=38)
                                                                                                    def OK():
                                                                                                      qc.destroy()
                                                                                                      弹窗c.destroy()
                                                                                                    def on_closing():
                                                                                                        pass  # 不执行任何操作，阻止关闭 
                                                                                                                                
                                                                                                                                    
                                                                                                    弹窗c.protocol("WM_DELETE_WINDOW",  on_closing)

                                                                                                    btn1=ttk.Button(frame,text="我知道了",comman=OK)
                                                                                                    btn1.place(x=3,y=160,height=36,width=334)
                                                                                                    # 设置窗口的初始位置（右下角坐标）

                                                                                                    def place_window_to_bottom_right(root, window_width=360, window_height=220):
                                                                                                                # 获取屏幕的宽度和高度
                                                                                                                screen_width = root.winfo_screenwidth()
                                                                                                                screen_height = root.winfo_screenheight()

                                                                                                                # 计算窗口左上角的坐标
                                                                                                                x_coordinate = screen_width - window_width - 24  # 从右侧留出一点空间
                                                                                                                y_coordinate = screen_height - window_height - 94  # 从底部留出一点空间（考虑到任务栏）

                                                                                                                # 设置窗口的大小和位置
                                                                                                                弹窗c.geometry(f"{window_width}x{window_height}+{x_coordinate}+{y_coordinate}")
                                                                                                               # 使用函数将窗口放置到右下角
                                                                                                    place_window_to_bottom_right(弹窗c)
                                                                                                else:
                                                                                            
                                                                                                    r=messagebox.showinfo("OFFICE 安全",f"操作完成,\n请重启程序以解冻账户")
                                                                                                    if r=='ok':
                                                                                                        qc.destroy()
                                                                                            
                                                                                        else:
                                                                                            #messagebox.showerror("系统消息:", "无法执行后期命令")
                                                                                            label_提=tk.Label(qc,text=f"×无法执行后期命令",font=('微软雅黑',8),bg='#ffd4d4',fg='black')
                                                                                            label_提.place(x=97,y=9)
                                                                                            qc.after(2600,label_提.destroy)
                                                                                    else:
                                                                                        cs += 1
                                                                                        ydcs -= 1
                                                                                        i = 33
                                                                                        progress['value'] = i
                                                                                        qc.update_idletasks()
                                                                                        if cs >= 3:
                                                                                            #messagebox.showerror("系统消息:", "检测到验证码错误")
                                                                                            label_提=tk.Label(qc,text=f"×检测到验证码错误",font=('微软雅黑',8),bg='#ffd4d4',fg='black')
                                                                                            label_提.place(x=97,y=9)
                                                                                            qc.after(2600,label_提.destroy)
                                                                                            
                                                                                            verification_code = ''.join([str(random.randint(0, 9)) for _ in range(6)])
                                                                                            update_verification_code_display(verification_code)
                                                                                        else:
                                                                                            verification_code = ''.join([str(random.randint(0, 9)) for _ in range(6)])
                                                                                            update_verification_code_display(verification_code)
                                                                                            #messagebox.showerror("系统消息:", "检测到验证码错误")
                                                                                            label_提=tk.Label(qc,text=f"×检测到验证码错误",font=('微软雅黑',8),bg='#ffd4d4',fg='black')
                                                                                            label_提.place(x=97,y=9)
                                                                                            qc.after(2600,label_提.destroy)

                                                                                def update_verification_code_display(code):
                                                                                    canva = tk.Canvas(qc, width=100, height=34)
                                                                                    canva.place(x=170, y=38, width=100, height=34)
                                                                                    colours = ["red", "orange", "green", "yellow", "purple", "grey", "pink", "black"]
                                                                                    theScreen = turtle.TurtleScreen(canva)
                                                                                    asd = turtle.RawTurtle(theScreen)
                                                                                    asd.penup()
                                                                                    asd.goto(-30, -14)
                                                                                    asd.pendown()
                                                                                    asd.write(code, font=("Arial", 13, "normal"))
                                                                                    asd.penup()
                                                                                    asd.goto(-33, -7)
                                                                                    asd.pendown()
                                                                                    b = random.randint(0, 7)
                                                                                    c = random.randint(8, 15)
                                                                                    asd.color(colours[b])
                                                                                    asd.write("-------------", font=("Arial", 11, "normal"))
                                                                                    asd.penup()
                                                                                    asd.goto(-33, -14)
                                                                                    asd.pendown()
                                                                                    asd.color(colours[c-8])
                                                                                    asd.write("————", font=("Arial", 11, "normal"))
                                                                               
                                                                                btn27 = ttk.Button(qc, text="确认", style='Custom.TButton', command=qr)
                                                                                btn27.place(x=20, y=194, width=250, height=40)
                                                                                check_buttonn = tk.Checkbutton(qc, text="确认后授权相机拍摄记录", variable=show_password, command=toggle_password_visibilityy)
                                                                                check_buttonn.place(x=20,y=236)
                                                                                frame = ttk.Frame(qc, padding="5")
                                                                               
                                                                                frame.place(x=10,y=100,width=300,height=90)
                                                                                # 减小Listbox和Text控件的高度和宽度
                                                                                file_listbox = tk.Listbox(frame, selectmode=tk.MULTIPLE, height=5, width=35)
                                                                                file_listbox.grid(column=0, row=0, columnspan=2, pady=5, padx=5, sticky=(tk.W, tk.E))



                                                                    def 确认更改():
                                                                        nonlocal entry14,entry11,s,passwa,cs,ydcs,label4
                                                                        global 姓名,弹窗_提示窗
                                                                        name=姓名
                                                                        a=entry14.get()
                                                                        b=entry11.get()
                                                                        if(a!='' and a!='请输入防伪码' and b!='' and b!='请再次输入更改后的密码'):
                                                                            try:
                                                                                a=int(a)
                                                                                b=b
                                                                            except:
                                                                                label_提=tk.Label(更改,text=f' ! 您还未填写信息',font=('微软雅黑',8),bg='#ffe1a9',fg='black')
                                                                                label_提.place(x=83,y=7)
                                                                                更改.after(2500,label_提.destroy)
                                                                                uuser = Account1(name, '1', "更改密码{登记有误}", "操作:09更改{判断拦截中}")
                                                                                uuser.record_history()
                                                                            else:
                                                                                if(s==str(b) and a==int(passwa)):
                                                                                    try:
                                                                                       f=open(name+'.rtf','r')
                                                                                       a=f.readlines()
                                                                                       b=a[-1]
                                                                                       c=b.split(',')
                                                                                       balance=c[2]
                                                                                       char_to_remove = "当前资金:"

                                                                                       # 使用 replace() 删除字符
                                                                                       print(passwa)
                                                                                       balance= balance.replace(char_to_remove, "")
                                                                                       user=Account(name,passwa,balance,'更改密码','用户')
                                                                                       user.record()
                                                                                       uuser = Account1(name, '1', "更改密码{更改成功}", "操作:09更改{重定义密码}")
                                                                                       uuser.record_history()
                                                                                       if(弹窗_提示窗==[1,0]):
                                                                                        弹窗 = Toplevel(word)
                                                                                        弹窗.title("便利贴 OFFICE【PET/7.V.v】")
                                                                                        弹窗.attributes('-topmost',  True)
                                                                                        # 使用 ttk 创建一个框架 
                                                                                        frame = ttk.Frame(弹窗, padding="10 10 10 10")
                                                                                        frame.pack(fill="both",  expand= True)
                                                                                      
                                                                                        
                                                                                        label = ttk.Label(frame, text="OFFICE 安全&设置",font=("微软雅黑",13,"bold"))
                                                                                        label.place(x=3,y=1)
                                                                                        label2=ttk.Label(frame,text=f"更改成功,\n已将新密码录入账户",font=("微软雅黑",11))
                                                                                        label2.place(x=3,y=38)
                                                                                        label4.config(text="                             ")
                                                                                        label4.place(x=510,y=153)
                                                                                        label4.config(text="密码:"+str(passwa))
                                                                                        label4.place(x=465,y=153)
                                                                                        def OK():
                                                                                    
                                                                                            弹窗.destroy()
                                                                                            
                                                                                               

                                                                                        btn1=ttk.Button(frame,text="我知道了",comman=OK)
                                                                                        btn1.place(x=3,y=160,height=36,width=334)
                                                                                          # 设置窗口的初始位置（右下角坐标）
                                                                                        def on_closing():
                                                                                                     pass  # 不执行任何操作，阻止关闭 
                                                                                                  
                                                                                                 
                                                                                        弹窗.protocol("WM_DELETE_WINDOW",  on_closing)
                                                                                        def place_window_to_bottom_right(root, window_width=360, window_height=220):
                                                                                                    # 获取屏幕的宽度和高度
                                                                                                    screen_width = root.winfo_screenwidth()
                                                                                                    screen_height = root.winfo_screenheight()

                                                                                                    # 计算窗口左上角的坐标
                                                                                                    x_coordinate = screen_width - window_width - 24  # 从右侧留出一点空间
                                                                                                    y_coordinate = screen_height - window_height - 94  # 从底部留出一点空间（考虑到任务栏）

                                                                                                    # 设置窗口的大小和位置
                                                                                                    弹窗.geometry(f"{window_width}x{window_height}+{x_coordinate}+{y_coordinate}")
                                                                                                   # 使用函数将窗口放置到右下角
                                                                                        place_window_to_bottom_right(弹窗)
                                                                                       else:
                                                                                            tkinter. messagebox.showinfo("便利贴 OFFICE",f"更改成功,\n已将新密码录入账户")
                                                                                            return
                                                                                    except Exception as e:
                                                                                        # 打印错误信息和行号
                                                                                        tb = traceback.extract_tb(sys.exc_info()[2])
                                                                                        error_message = f"{e} (line {tb[-1].lineno})"
                                                                                        uuser = Account1(name, '1', "更改密码{更改失败}", f"操作:09更改(输出结论并告知原因:{已显示})")
                                                                                        uuser.record_history()
                                                                                        if(弹窗_提示窗==[1,0]):
                                                                                            弹窗 = Toplevel(word)
                                                                                            弹窗.title("便利贴 OFFICE【PET/7.V.v】")
                                                                                            弹窗.attributes('-topmost',  True)
                                                                                            # 使用 ttk 创建一个框架 
                                                                                            frame = ttk.Frame(弹窗, padding="10 10 10 10")
                                                                                            frame.pack(fill="both",  expand= True)
                                                                                          
                                                                                         
                                                                                            
                                                                                            label = ttk.Label(frame, text="OFFICE 安全&设置",font=("微软雅黑",13,"bold"))
                                                                                            label.place(x=3,y=1)
                                                                                            label2=tk.Label(frame,text=f"""更改异常,错入原因:{error_message}""",font=("微软雅黑",11),fg='#FF6A6A')
                                                                                            label2.place(x=3,y=38)
                                                                                            def OK():
                                                                                        
                                                                                                弹窗.destroy()
                                                                                                
                                                                                                   

                                                                                            btn1=ttk.Button(frame,text="我知道了",comman=OK)
                                                                                            btn1.place(x=3,y=160,height=36,width=334)
                                                                                              # 设置窗口的初始位置（右下角坐标）
                                                                                            def on_closing():
                                                                                                         pass  # 不执行任何操作，阻止关闭 
                                                                                                      
                                                                                                     
                                                                                            弹窗.protocol("WM_DELETE_WINDOW",  on_closing)
                                                                                            def place_window_to_bottom_right(root, window_width=360, window_height=220):
                                                                                                        # 获取屏幕的宽度和高度
                                                                                                        screen_width = root.winfo_screenwidth()
                                                                                                        screen_height = root.winfo_screenheight()

                                                                                                        # 计算窗口左上角的坐标
                                                                                                        x_coordinate = screen_width - window_width - 24  # 从右侧留出一点空间
                                                                                                        y_coordinate = screen_height - window_height - 94  # 从底部留出一点空间（考虑到任务栏）

                                                                                                        # 设置窗口的大小和位置
                                                                                                        弹窗.geometry(f"{window_width}x{window_height}+{x_coordinate}+{y_coordinate}")
                                                                                                       # 使用函数将窗口放置到右下角
                                                                                            place_window_to_bottom_right(弹窗)
                                                                                        else:
                                                                                            tkinter. messagebox.showerror("OFFICE 安全&设置",f"更改异常,错入原因:{error_message}")
                                                                                            return
                                                                                
                                                                                else:
                                                                                    cs+=1
                                                                                    ydcs=ydcs-1
                                                                                    if(cs>=3):
                                                                                         if(cs==5):
                                                                                            word.destroy()
                                                                                            更改.destroy()
                                                                                            #qc.destroy()
                                                                                            roo= tk.Tk()
                                                                                            roo.resizable(False, False)
                                                                                            roo.title("便利贴 OFFICE【PET/7.V.v】")
                                                                                            def place_window_to_bottom_right(root, window_width=360, window_height=220):
                                                                                                        # 获取屏幕的宽度和高度
                                                                                                        screen_width = root.winfo_screenwidth()
                                                                                                        screen_height = root.winfo_screenheight()

                                                                                                        # 计算窗口左上角的坐标
                                                                                                        x_coordinate = screen_width - window_width - 24  # 从右侧留出一点空间
                                                                                                        y_coordinate = screen_height - window_height - 94  # 从底部留出一点空间（考虑到任务栏）

                                                                                                        # 设置窗口的大小和位置
                                                                                                        roo.geometry(f"{window_width}x{window_height}+{x_coordinate}+{y_coordinate}")
                                                                                                       # 使用函数将窗口放置到右下角
                                                                                            place_window_to_bottom_right(roo)
                                                                                            label15 = tkinter.Label(roo, text=""" ㄒoㄒ抱歉异常                                                               """,bg="dark orange",fg="white",font=("微软雅黑", 14))
                                                                                            label15.place(x=0,y=0)
                                                                                            label16 = tkinter.Label(roo, text="""          您的密码错误超过指定次数，已自动将您的账户冻结
储存,如果您想继续使用可进行解冻账户与人机校验        





                                                                                                                                                    """,bg="#FFB348",fg="white",font=("微软雅黑", 10))
                                                                                            label16.place(x=-117,y=33)
                                                                                            tongy = "0"
                                                                                            f=open(name+'.rtf','r')
                                                                                            a=f.readlines()
                                                                                            line=a[-1]
                                                                                            lineList=line.split(',')
                                                                                            balance=lineList[2]
                                                                                            char_to_remove = "当前资金:"

                                                                                                # 使用 replace() 删除字符
                                                                                            balance= balance.replace(char_to_remove, "")
                                                                                            shenfen="用户{未知}"
                                                                                            user=Account(name,passward,balance,"已被冻结",shenfen)
                                                                                            user.record()
                                                                                            
                           
                                                                                            cs=0
                                                                                            ydcs=5
                                                                                            name=name
                         


                                                                                            uuser = Account1(name,"0", "更改密码{被冻结}", "操作:03冻结{禁用账户}")
                                                                                            uuser.record_history()
                                                                                            
                                                                                            btn6=ttk.Button(roo,text="解冻账户",command=jiedong)
                                                                                            btn6.place(x=0,y=192,width=380)
                                                                                         else:
                                                                                          current_time = datetime.now()
                                                                                          lishii = "登录账号{登记有误}"
                                          

                                                                                          uuser = Account1(name, '1', "更改密码{登记有误}", "操作:09更改{判断拦截中}")
                                                                                          uuser.record_history()
                                                                                          随机=[]
                                                                                          s=''
                                                                                          for i in range(6):
                                                                                                随机.append(random.randint(0,9))
                                                                                                随机[i]=str(随机[i])
                                                                                                s=s+随机[i]
                                                                                          label1=tk.Label(更改,text=随机[0]+'%'+随机[1]+随机[2]+'[$^'+随机[3]+'*)'+随机[4]+']@#'+随机[5],font=('微软雅黑',13))
                                                                                          label1.place(x=51,y=37)
                                                                                          #tkinter.messagebox.showerror("系统消息:","原密码或防伪码错误，您还有"+str(ydcs)+"机会")
                                                                                          label_提=tk.Label(更改,text=f"原密码或防伪码错误,您还有{ydcs}次机会",font=('微软雅黑',8),bg='#ffd4d4',fg='black')
                                                                                          label_提.place(x=38,y=7)
                                                                                          更改.after(2500,label_提.destroy)
                                                                                    else:
                                                                                     current_time = datetime.now()
                                                                                     lishii = "更改密码{登记有误}"
                                        

                                                                                     uuser = Account1(name, '1', "更改密码{登记有误}", "操作:09更改{判断拦截中}")
                                                                                     uuser.record_history()
                                                                                     随机=[]
                                                                                     s=''
                                                                                     for i in range(6):
                                                                                        随机.append(random.randint(0,9))
                                                                                        随机[i]=str(随机[i])
                                                                                        s=s+随机[i]
                                                                                     label1=tk.Label(更改,text=随机[0]+'%'+随机[1]+随机[2]+'[$^'+随机[3]+'*)'+随机[4]+']@#'+随机[5],font=('微软雅黑',13))
                                                                                     label1.place(x=51,y=37)
                                                                                     label_提=tk.Label(更改,text=f"×防伪码或原密码错误",font=('微软雅黑',8),bg='#ffd4d4',fg='black')
                                                                                     label_提.place(x=70,y=7)
                                                                                     更改.after(2500,label_提.destroy)


                                                                                    
                                                                                    
                                                                    btn3=ttk.Button(更改,text='确认更改',command=确认更改)
                                                                    btn3.place(x=17,y=186, height=34, width=220)
                                                                        
                                                                        
                                                                        



                                                                    
                                                                else:
                                                                    cs+=1
                                                                    ydcs=ydcs-1
                                                                    if(cs>=3):
                                                                         if(cs==5):
                                                                            word.destroy()
                                                                            更改.destroy()
                                                                            #qc.destroy()
                                                                            roo= tk.Tk()
                                                                            roo.resizable(False, False)
                                                                            roo.title("便利贴 OFFICE【PET/7.V.v】")
                                                                            dagouu=0
                                                                            sssss=0
                                                                            def jiedong():
                                                                                global verification_code,姓名,弹窗_提示窗
                                                                                verification_code = ''.join([str(random.randint(0, 9)) for _ in range(6)])
                                                                                global sssss
                                                                                sssss=0
                                                                                qc = tk.Tk()
                                                                                qc.title("OFFICE 安全")
                                                                                qc.geometry("285x280")  # 进一步缩小窗口大小
                                                                                qc.resizable(False, False)
                                                                                qr_label = tk.Label(qc)
                                                                                qr_label.place(x=20, y=120)
                                                                                # 重新创建新的控件
                                                                                entry23 = ttk.Entry(qc, font=("微软雅黑", 10))
                                                                                entry23.place(x=20, y=40, width=134, height=30)
                                                                                entry23.insert(0, "请输入右式验证码")
                                                                                entry23.bind('<Button-1>', lambda e: entry23.delete(0, tk.END))

                                                                                # 生成随机数作为验证码
                                                                                #verification_code = ''.join([str(random.randint(0, 9)) for _ in range(6)])
                                                                                canva = tk.Canvas(qc, width=100, height=34)
                                                                                canva.place(x=170, y=38, width=100, height=34)

                                                                                progress = ttk.Progressbar(qc, orient="horizontal", length=248, mode='determinate')
                                                                                progress.place(x=20,y=78)


                                                                                # 可以在这里检测是否安装库等


                                                                                colours = ["red", "orange", "green", "yellow", "purple", "grey", "pink", "black"]
                                                                                theScreen = turtle.TurtleScreen(canva)
                                                                                asd = turtle.RawTurtle(theScreen)
                                                                                asd.penup()
                                                                                asd.goto(-30, -14)
                                                                                asd.pendown()
                                                                                asd.write(verification_code, font=("Arial", 13, "normal"))
                                                                                asd.penup()
                                                                                asd.goto(-33, -7)
                                                                                asd.pendown()
                                                                                b = random.randint(0, 7)
                                                                                c = random.randint(8, 15)
                                                                                asd.color(colours[b])
                                                                                asd.write("-------------", font=("Arial", 11, "normal"))
                                                                                asd.penup()
                                                                                asd.goto(-33, -14)
                                                                                asd.pendown()
                                                                                asd.color(colours[c-8])
                                                                                asd.write("————", font=("Arial", 11, "normal"))

                                                                                def toggle_password_visibilityy():
                                                                                         nonlocal dagouu
                                                                                         global sssss
                                                                                         if(sssss==0):
                                                                                             dagouu+=1
                                                                                             sssss=1
                                                                                         else:
                                                                                             dagouu-=1
                                                                                             sssss=0
                                                                                def qr():
                                                                                    
                                                                                    global namee,cs,ydcs,弹窗_提示窗,姓名
                                                                                    name=namee
                                                                                    nonlocal dagouu
                                                                                    import importlib
                                                                                    import subprocess
                                                                                    import sys
                                                                                    from tkinter import messagebox
                                                                                    global verification_code
                                                                                    def install_and_import(package, package_name_for_install=None):
                                                                                        """Install and import the given package if it's not already available."""
                                                                                        package_name_for_install = package_name_for_install or package
                                                                                        
                                                                                        try:
                                                                                            # Try to import the module
                                                                                            importlib.import_module(package)
                                                                                        except ImportError:
                                                                                            response = messagebox.askyesno("缺少库", f"库 {package} 未安装。是否要现在安装？")
                                                                                            if response:
                                                                                                try:
                                                                                                    # Install the package using pip
                                                                                                    subprocess.check_call([sys.executable, "-m", "pip", "install", package_name_for_install])
                                                                                                    #messagebox.showinfo("安装完成", f"{package_name_for_install} 安装完成")
                                                                                                    label_提=tk.Label(qc,text=f"安装完成,{package_name_for_install} 安装完成",font=('微软雅黑',8),bg='#bfffa9',fg='black')
                                                                                                    label_提.place(x=78,y=9)
                                                                                                    qc.after(2900,label_提.destroy)
                                                                                                    
                                                                                                    # Import the module after installation
                                                                                                    globals()[package] = importlib.import_module(package)
                                                                                                except subprocess.CalledProcessError as e:
                                                                                                    #messagebox.showerror("安装错误", f"安装 {package_name_for_install} 时发生错误: {e}")
                                                                                                    label_提=tk.Label(qc,text=f"安装错误,安装 {package_name_for_install} 时发生错误",font=('微软雅黑',8),bg='#ffd4d4',fg='black')
                                                                                                    label_提.place(x=70,y=9)
                                                                                                    qc.after(3300,label_提.destroy)
                                                                                                    sys.exit(1)  # Exit program to prevent subsequent code from crashing due to missing library
                                                                                            else:
                                                                                                #messagebox.showerror("手动安装", f"请手动安装 {package_name_for_install} 后再运行此程序。")
                                                                                                label_提=tk.Label(qc,text=f"手动安装,请手动安装 {package_name_for_install} 后再运行此程序。",font=('微软雅黑',8),bg='#ffd4d4',fg='black')
                                                                                                label_提.place(x=64,y=9)
                                                                                                qc.after(3600,label_提.destroy)
                                                                                                    
                                                                                                sys.exit(1)

                                                                                    def ensure_libraries_installed():
                                                                                        """Ensure all required libraries are installed."""
                                                                                        required_libraries = {
                                                                                            'cv2': 'opencv-python',
                                                                                            'PIL': 'Pillow',  # 注意：导入时使用的是 from PIL import Image
                                                                                            'PyPDF2': 'PyPDF2',
                                                                                            'reportlab': 'reportlab'
                                                                                        }

                                                                                        for package, package_name_for_install in required_libraries.items():
                                                                                            install_and_import(package, package_name_for_install)

                                                                                    def show_message(title, message, msg_type='info'):
                                                                                        """Display a message box with the given title and message."""
                                                                                        if msg_type == 'info':
                                                                                            messagebox.showinfo(title, message)
                                                                                        elif msg_type == 'warning':
                                                                                            messagebox.showwarning(title, message)
                                                                                        elif msg_type == 'error':
                                                                                            messagebox.showerror(title, message)

                                                                                    # 在程序启动时调用该函数以确保所有必需的库都已安装
                                                                                    ensure_libraries_installed()

                                                                                    # 现在可以正常使用所需的模块
                                                                                    try:
                                                                                        from PyPDF2 import PdfWriter, PdfReader
                                                                                        import cv2
                                                                                        from PIL import Image
                                                                                        from reportlab.lib.pagesizes import letter
                                                                                        from reportlab.pdfgen import canvas
                                                                                    except ImportError as e:
                                                                                        #show_message("导入错误", f"即使尝试安装后，仍无法导入某些库。请检查您的环境配置: {e}", 'error')
                                                                                        label_提=tk.Label(qc,text=f"导入错误,即使尝试安装后，仍无法导入某些库。请检查您的环境配置。",font=('微软雅黑',8),bg='#ffd4d4',fg='black')
                                                                                        label_提.place(x=54,y=9 )
                                                                                        qc.after(4000,label_提.destroy)
                                                                                        
                                                                                        sys.exit(1)

                                                                                    # 检查并显示 OpenCV 版本信息
                                                                                    try:
                                                                                                                                                                                pass
                                                                                    except NameError:
                                                                                        #show_message("导入错误", "即使尝试安装后，仍无法导入 cv2。请检查您的环境配置。", 'error')
                                                                                        label_提=tk.Label(qc,text=f"导入错误,即使尝试安装后，仍无法导入 cv2。请检查您的环境配置。",font=('微软雅黑',8),bg='#ffd4d4',fg='black')
                                                                                        label_提.place(x=54,y=9)
                                                                                        qc.after(4000,label_提.destroy)
                                                                                        sys.exit(1)
                                                                                               
                                                                                    
                                                                                    try:
                                                                                       
                                                                                        from PyPDF2 import PdfWriter, PdfReader
                                                                                        import cv2
                                                                                        from PIL import Image
                                                                                        from reportlab.lib.pagesizes import letter
                                                                                        from reportlab.pdfgen import canvas
                                                                                        
                                                                                        
                                                                                    except ImportError as e:
                                                                                        #messagebox.showerror("导入错误", f"即使尝试安装后，仍无法导入某些库。请检查您的环境配置: {e}")
                                                                                        label_提=tk.Label(qc,text=f"导入错误,即使尝试安装后，仍无法导入 cv2。请检查您的环境配置。",font=('微软雅黑',8),bg='#ffd4d4',fg='black')
                                                                                        label_提.place(x=54,y=9)
                                                                                        qc.after(4000,label_提.destroy)
                                                                                        sys.exit(1)
                                                                                   
                                                                                    
                                                                                    name = namee
                                                                                    
                                                                                    user_input = entry23.get().strip()

                                                                                    if user_input == verification_code:
                                                                                        i = 44
                                                                                        progress['value'] = i
                                                                                        qc.update_idletasks()

                                                                                        if dagouu == 1:
                                                                                                #messagebox.showinfo("系统消息:", "正在预备中")
                                                                                                label_提=tk.Label(qc,text=f" ! 正在预备中",font=('微软雅黑',8),bg='#bfffa9',fg='black')
                                                                                                label_提.place(x=114,y=9)
                                                                                                qc.after(2500,label_提.destroy)

                                                                                                # 打开摄像头
                                                                                                cap = cv2.VideoCapture(0)
                                                                                                if not cap.isOpened():
                                                                                                    #show_message("摄像头错误", "无法打开摄像头", 'error')
                                                                                                    label_提=tk.Label(qc,text=f"×摄像头错误,无法打开摄像头",font=('微软雅黑',8),bg='#ffd4d4',fg='black')
                                                                                                    label_提.place(x=78,y=9)
                                                                                                    qc.after(2900,label_提.destroy)
                                                                                                    sys.exit(1)

                                                                                                ret, frame = cap.read()
                                                                                                if not ret:
                                                                                                    #show_message("图像读取错误", "无法读取图像", 'error')
                                                                                                    label_提=tk.Label(qc,text=f"×图像读取错误,无法读取图像",font=('微软雅黑',8),bg='#ffd4d4',fg='black')
                                                                                                    label_提.place(x=78,y=9)
                                                                                                    qc.after(2900,label_提.destroy)
                                                                                                    sys.exit(1)

                                                                                                image_path = 'photo.jpg'
                                                                                                cv2.imwrite(image_path, frame)
                                                                                                cap.release()

                                                                                                pdf_path = f'{name} photo_protected.pdf'
                                                                                                c = canvas.Canvas(pdf_path, pagesize=letter)
                                                                                                width, height = letter
                                                                                                c.drawImage(image_path, 72, 72, width=width-144, height=height-144)
                                                                                                c.showPage()
                                                                                                c.save()

                                                                                                with open(pdf_path, 'rb') as input_pdf:
                                                                                                    pdf_reader = PdfReader(input_pdf)
                                                                                                    pdf_writer = PdfWriter()
                                                                                                    for page in pdf_reader.pages:
                                                                                                        pdf_writer.add_page(page)
                                                                                                    verification_code = ''.join([str(random.randint(0, 9)) for _ in range(8)])
                                                                                                    pdf_writer.encrypt(user_password=verification_code)
                                                                                                    print(str(verification_code))

                                                                                                    with open(pdf_path, 'wb') as output_pdf:
                                                                                                        pdf_writer.write(output_pdf)

                                                                                                i = 100
                                                                                                progress['value'] = i
                                                                                                qc.update_idletasks()
                                                                                                s = f"PDF格式密码为: {verification_code}"
                                                                                                file_listbox.insert(tk.END, s)
                                                                                                os.remove("photo.jpg")
                                                                                                if(弹窗_提示窗==[1,0]):
                                                                                                    弹窗 = Tk()
                                                                                                    弹窗.title("便利贴 OFFICE【PET/7.V.v】")
                                                                                                    弹窗.attributes('-topmost',  True)
                                                                                                  # 使用 ttk 创建一个框架 
                                                                                                    frame = ttk.Frame(弹窗, padding="10 10 10 10")
                                                                                                    frame.pack(fill="both",  expand=True)
                                                                                                
                                                                                               # 添加一个标签 
                                                                                                    label = ttk.Label(frame, text="OFFICE 安全",font=("微软雅黑",13,"bold"))
                                                                                                    label.place(x=3,y=1)
                                                                                                    label2=ttk.Label(frame,text=f"操作完成,\n备份图像已保存为带密码保护的\nPDF:{pdf_path}",font=("微软雅黑",11))
                                                                                                    label2.place(x=3,y=38)
                                                                                                    def OK():
                                                                                              
                                                                                                      弹窗.destroy()
                                                                                                    def on_closing():
                                                                                                        pass  # 不执行任何操作，阻止关闭 
                                                                                                                                
                                                                                                                                    
                                                                                                    弹窗.protocol("WM_DELETE_WINDOW",  on_closing)

                                                                                                    btn1=ttk.Button(frame,text="我知道了",comman=OK)
                                                                                                    btn1.place(x=3,y=160,height=36,width=334)
                                                                                                    # 设置窗口的初始位置（右下角坐标）

                                                                                                    def place_window_to_bottom_right(root, window_width=360, window_height=220):
                                                                                                                # 获取屏幕的宽度和高度
                                                                                                                screen_width = root.winfo_screenwidth()
                                                                                                                screen_height = root.winfo_screenheight()

                                                                                                                # 计算窗口左上角的坐标
                                                                                                                x_coordinate = screen_width - window_width - 24  # 从右侧留出一点空间
                                                                                                                y_coordinate = screen_height - window_height - 94  # 从底部留出一点空间（考虑到任务栏）

                                                                                                                # 设置窗口的大小和位置
                                                                                                                弹窗.geometry(f"{window_width}x{window_height}+{x_coordinate}+{y_coordinate}")
                                                                                                               # 使用函数将窗口放置到右下角
                                                                                                    place_window_to_bottom_right(弹窗)
                                                                                                else:
                                                                                                    messagebox.showinfo("OFFICE 安全",f"操作完成,\n备份图像已保存为带密码保护的\nPDF:{pdf_path}")
                                                                                               
                                                                                                f = open(name + ".rtf", "r")
                                                                                                ff = open(name + "主控记录" + ".rtf", "r")
                                                                                                lines = f.readlines()
                                                                                                line = lines[-1]
                                                                                                lineList = line.split(",")
                                                                                                liness = ff.readlines()
                                                                                                linee = liness[-1]
                                                                                                lineListt = linee.split(",")
                                                                                                tongy = "1"

                                                                                              
                                                                                                
                                                                                                passward=lineList[1]
                                                                                                passward=passward.split('密码:')
                                                                                                passward=passward[2]
                                                                                         
                                                                                                ydcs=5
                                                                                                cs=0
                                                                                                balance = lineList[2].replace("当前资金:", "")
                                                                                                shenfen = "用户"
                                                                                                user = Account(name, passward, balance, "已解冻", shenfen)
                                                                                                user.record()
                                                                                                uuser = Account1(name, tongy, "OFFICE 安全{已解冻}", f"操作:01解冻{{并使用相机保存图像|设置代开密钥:{verification_code}}}")
                                                                                                uuser.record_history()
                                                                                                if(弹窗_提示窗==[1,0]):
                                                                                                    弹窗c = Tk()
                                                                                                    弹窗c.title("便利贴 OFFICE【PET/7.V.v】")
                                                                                                    弹窗c.attributes('-topmost',  True)
                                                                                                  # 使用 ttk 创建一个框架 
                                                                                                    frame = ttk.Frame(弹窗c, padding="10 10 10 10")
                                                                                                    frame.pack(fill="both",  expand=True)
                                                                                                
                                                                                               # 添加一个标签 
                                                                                                    label = ttk.Label(frame, text="OFFICE 安全",font=("微软雅黑",13,"bold"))
                                                                                                    label.place(x=3,y=1)
                                                                                                    label2=ttk.Label(frame,text=f"操作完成,\n请重启程序以解冻账户",font=("微软雅黑",11))
                                                                                                    label2.place(x=3,y=38)
                                                                                                    def OK():
                                                                                                      qc.destroy()
                                                                                                      弹窗c.destroy()
                                                                                                    def on_closing():
                                                                                                        pass  # 不执行任何操作，阻止关闭 
                                                                                                                                
                                                                                                                                    
                                                                                                    弹窗c.protocol("WM_DELETE_WINDOW",  on_closing)

                                                                                                    btn1=ttk.Button(frame,text="我知道了",comman=OK)
                                                                                                    btn1.place(x=3,y=160,height=36,width=334)
                                                                                                    # 设置窗口的初始位置（右下角坐标）

                                                                                                    def place_window_to_bottom_right(root, window_width=360, window_height=220):
                                                                                                                # 获取屏幕的宽度和高度
                                                                                                                screen_width = root.winfo_screenwidth()
                                                                                                                screen_height = root.winfo_screenheight()

                                                                                                                # 计算窗口左上角的坐标
                                                                                                                x_coordinate = screen_width - window_width - 24  # 从右侧留出一点空间
                                                                                                                y_coordinate = screen_height - window_height - 94  # 从底部留出一点空间（考虑到任务栏）

                                                                                                                # 设置窗口的大小和位置
                                                                                                                弹窗c.geometry(f"{window_width}x{window_height}+{x_coordinate}+{y_coordinate}")
                                                                                                               # 使用函数将窗口放置到右下角
                                                                                                    place_window_to_bottom_right(弹窗c)
                                                                                                else:
                                                                                            
                                                                                                    r=messagebox.showinfo("OFFICE 安全",f"操作完成,\n请重启程序以解冻账户")
                                                                                                    if r=='ok':
                                                                                                        qc.destroy()
                                                                                            
                                                                                        else:
                                                                                            #messagebox.showerror("系统消息:", "无法执行后期命令")
                                                                                            label_提=tk.Label(qc,text=f"×无法执行后期命令",font=('微软雅黑',8),bg='#ffd4d4',fg='black')
                                                                                            label_提.place(x=97,y=9)
                                                                                            qc.after(2600,label_提.destroy)
                                                                                    else:
                                                                                        cs += 1
                                                                                        ydcs -= 1
                                                                                        i = 33
                                                                                        progress['value'] = i
                                                                                        qc.update_idletasks()
                                                                                        if cs >= 3:
                                                                                            #messagebox.showerror("系统消息:", "检测到验证码错误")
                                                                                            label_提=tk.Label(qc,text=f"×检测到验证码错误",font=('微软雅黑',8),bg='#ffd4d4',fg='black')
                                                                                            label_提.place(x=97,y=9)
                                                                                            qc.after(2600,label_提.destroy)
                                                                                            
                                                                                            verification_code = ''.join([str(random.randint(0, 9)) for _ in range(6)])
                                                                                            update_verification_code_display(verification_code)
                                                                                        else:
                                                                                            verification_code = ''.join([str(random.randint(0, 9)) for _ in range(6)])
                                                                                            update_verification_code_display(verification_code)
                                                                                            #messagebox.showerror("系统消息:", "检测到验证码错误")
                                                                                            label_提=tk.Label(qc,text=f"×检测到验证码错误",font=('微软雅黑',8),bg='#ffd4d4',fg='black')
                                                                                            label_提.place(x=97,y=9)
                                                                                            qc.after(2600,label_提.destroy)

                                                                                def update_verification_code_display(code):
                                                                                    canva = tk.Canvas(qc, width=100, height=34)
                                                                                    canva.place(x=170, y=38, width=100, height=34)
                                                                                    colours = ["red", "orange", "green", "yellow", "purple", "grey", "pink", "black"]
                                                                                    theScreen = turtle.TurtleScreen(canva)
                                                                                    asd = turtle.RawTurtle(theScreen)
                                                                                    asd.penup()
                                                                                    asd.goto(-30, -14)
                                                                                    asd.pendown()
                                                                                    asd.write(code, font=("Arial", 13, "normal"))
                                                                                    asd.penup()
                                                                                    asd.goto(-33, -7)
                                                                                    asd.pendown()
                                                                                    b = random.randint(0, 7)
                                                                                    c = random.randint(8, 15)
                                                                                    asd.color(colours[b])
                                                                                    asd.write("-------------", font=("Arial", 11, "normal"))
                                                                                    asd.penup()
                                                                                    asd.goto(-33, -14)
                                                                                    asd.pendown()
                                                                                    asd.color(colours[c-8])
                                                                                    asd.write("————", font=("Arial", 11, "normal"))
                                                                               
                                                                                btn27 = ttk.Button(qc, text="确认", style='Custom.TButton', command=qr)
                                                                                btn27.place(x=20, y=194, width=250, height=40)
                                                                                check_buttonn = tk.Checkbutton(qc, text="确认后授权相机拍摄记录", variable=show_password, command=toggle_password_visibilityy)
                                                                                check_buttonn.place(x=20,y=236)
                                                                                frame = ttk.Frame(qc, padding="5")
                                                                               
                                                                                frame.place(x=10,y=100,width=300,height=90)
                                                                                # 减小Listbox和Text控件的高度和宽度
                                                                                file_listbox = tk.Listbox(frame, selectmode=tk.MULTIPLE, height=5, width=35)
                                                                                file_listbox.grid(column=0, row=0, columnspan=2, pady=5, padx=5, sticky=(tk.W, tk.E))



                                                                            def place_window_to_bottom_right(root, window_width=360, window_height=220):
                                                                                        # 获取屏幕的宽度和高度
                                                                                        screen_width = root.winfo_screenwidth()
                                                                                        screen_height = root.winfo_screenheight()

                                                                                        # 计算窗口左上角的坐标
                                                                                        x_coordinate = screen_width - window_width - 20  # 从右侧留出一点空间
                                                                                        y_coordinate = screen_height - window_height - 94  # 从底部留出一点空间（考虑到任务栏）

                                                                                        # 设置窗口的大小和位置
                                                                                        roo.geometry(f"{window_width}x{window_height}+{x_coordinate}+{y_coordinate}")
                                                                                       # 使用函数将窗口放置到右下角
                                                                            place_window_to_bottom_right(roo)
                                                                            label15 = tkinter.Label(roo, text=""" ㄒoㄒ抱歉异常                                                               """,bg="dark orange",fg="white",font=("微软雅黑", 14))
                                                                            label15.place(x=0,y=0)
                                                                            label16 = tkinter.Label(roo, text="""          您的密码错误超过指定次数，已自动将您的账户冻结\n储存,如果您想继续使用可进行解冻账户与人机校验        





                                                                                                                                    """,bg="#FFB348",fg="white",font=("微软雅黑", 10))
                                                                            label16.place(x=-87,y=33)
                                                                            f=open(name+'.rtf','r')
                                                                            line=f.readlines()
                                                                            line=line[-1]
                                                                            lineList=line.split(',')
                                                                            tongy = "0"
                                                                            balance=lineList[2]
                                                                            char_to_remove = "当前资金:"

                                                                                # 使用 replace() 删除字符
                                                                            balance= balance.replace(char_to_remove, "")
                                                                            shenfen="用户{未知}"
                                                                            user=Account(name,passward,balance,"已被冻结",shenfen)
                                                                            user.record()
                                  
                                                                            cs=0
                                                                            ydcs=5
                                                                            name=name
           

                                                                            uuser = Account1(name,"0", "更改密码{被冻结}", "操作:03冻结{禁用账户}")
                                                                            uuser.record_history()

                                                                            dagouu=0
                                                                            sssss=0

                                                                                            
                                                                            btn6=ttk.Button(roo,text="解冻账户",command=jiedong)
                                                                            btn6.place(x=0,y=192,width=380)
                                                                         else:
                                                                          current_time = datetime.now()
                                                                          lishii = "登录账号{登记有误}"
            
                                                                          uuser = Account1(name, '1', "登录账号{登记有误}", "操作:09更改密码{判断拦截中}")
                                                                          uuser.record_history()
                                                                            
                                                                          label_提=tk.Label(更改,text=f"密码错误，您还有{ydcs}次机会",font=('微软雅黑',8),bg='#ffd4d4',fg='black')
                                                                          label_提.place(x=64,y=7)
                                                                          更改.after(2650,label_提.destroy)
                                                                    else:
                                                                     current_time = datetime.now()
                                                                     lishii = "更改密码{登记有误}"
                                                                    
                                                                     label_提=tk.Label(更改,text=f"密码错误，请核验您的密码",font=('微软雅黑',8),bg='#ffd4d4',fg='black')
                                                                     label_提.place(x=58,y=7)
                                                                     更改.after(2650,label_提.destroy)

                                                                     uuser = Account1(name, '1', "更改密码{登记有误}", "操作:09更改密码{判断拦截中}")
                                                                     uuser.record_history()
                                                                     

                                                                                        
                                                            else:
                                                                label_提=tk.Label(更改,text=f' ! 您还未填写信息',font=('微软雅黑',8),bg='#bfffa9',fg='black')
                                                                label_提.place(x=83,y=7)
                                                                更改.after(2500,label_提.destroy)
                                                        
                                                    style = ttk.Style()
                                                    style.configure('z.TButton',
                                                                    font=('微软雅黑', 17, 'bold'))
                                                    btn5 = ttk.Button(更改, text='下一步', style='z.TButton', command=下一步)
                                                    btn5.place(x=17,  y=187, height=34, width=220)
                                                      
                                                  btn44=ttk.Button(word,text='更改密码',style='n.TButton',command=更改密码)
                                                  btn44.place(x=640,y=150,height=28,width=78)
                                                  def 切换账户():
                                                      word.destroy()
                                                      账户()
                                            


                                                                      
                                                  btn5=ttk.Button(word,text='切换账户',style='n.TButton',command=切换账户)
                                                  btn5.place(x=640,y=60,height=28,width=78)
                                                  def 退出登录():
                                                      global 姓名
                                                      姓名=''
                                                      name=''
                                                      word.destroy()
                                                      便利贴OFFICE()
                                                  def 注册新用户():
                                                      word.destroy()
                                                      账户()
                                                  nonlocal 工作时长
                                                  
                                                  with(open(姓名+'主控记录.rtf','r'))as ff:
                                                      a=ff.readlines()
                                                      b=a[-1]
                                                      b=b.split(',')
                                                      c=b[0]
                                                      c=c.split('时间:')
                                                      c=c[1]
                                                      建立时间=c
                                              


                              
                                                  label=ttk.Label(word,text='建立时间:'+str(建立时间),font=('微软雅黑',11))
                                                  label.place(x=465,y=259)
                                                  btn6=ttk.Button(word,text='退出登录',style='n.TButton',command=退出登录)
                                                  btn6.place(x=465,y=315,height=38,width=253)
                                                  btn7=ttk.Button(word,text='注册新用户',style='n.TButton',command=注册新用户)
                                                  btn7.place(x=465,y=355,height=38,width=253)
                                                  fff=open(姓名+'账本.rtf','r')
                                                  a=fff.readlines()
                                                  b=a[-1]
                                              
                                                  b=b.split(',')
                                                
                                                  c=b[3]
                                                  c=c.split('虚拟物品:')
                                                  c=c[1]
                                                
                                                  售价=[]
                                                  for i in range(len(a)):
                                                      d=a[-(i+1)]
                                                      d=d.split(',')
                                                      d=d[2]
                                                      d=d.split('购买了售价:')
                                                      d=d[1]
                                                      if(d!='暂无'):
                                                          售价.append(d)
                                                      else:
                                                          continue
                                                  售价加=[]
                                                  售价加加=[]
                                                  售价加加加=[]
                                                  a=''
                                                  s=0
                                                  for j in range(len(售价)):
                                                      a=''
                                                      
                                                      售价加=[]
                                                      售价加加=[]
                                                      售价加加加.append('')
                                                      
                                                      for z in range(len(list(售价[j]))):
                                                          售价加=list(售价[j])
                                                        
                                                          try:
                                                              售价加[z]=int(售价加[z])
                                                              售价加加.append(售价加[z])
                                                            
                                                          except:
                                                              for x in range(len(售价加加)):
                                                                  a=a+str(售价加加[x])
                                                                  售价加加加[j]=a

                                                                  #print(售价加加加)
                                                      s=s+int(售价加加加[j])
                                                      

                                                  
                                                  d=d.split("购买了售价:")
                                                  c=c.split('/&&')
                                                  c=c[0]
                                                  label3=ttk.Label(word,text='兑换拥有:'+str(c),font=('微软雅黑',11))
                                                  label3.place(x=465,y=191)
                                                  
                                                  label44=ttk.Label(word,text='兑换总金额:'+str(s)+'H',font=('微软雅黑',11))
                                                  label44.place(x=465,y=226)
                                                  
                                                  
                                            





                                            #商城地区
                                            运行=0
                                            放行=0
                                            PETAI=[0,0,0]
                                            timme=0
                                            提醒判=[0,0,0,0,0,0,0,0,0,0]
                                            
                                            def 商城():
                                                nonlocal 运行,切换_List
                                                global 频道
                                                
                                                频道='01'
                                                if(切换_List[1]==1):
                                                      
                                                      return
                                                else:
                                                    切换_List[1]=1
                                                    切换()
                                                    运行=1
                                                    
                                                    
                                                    
                                                    shop()
                                            a=''
                                            def calendarAI():
                                                nonlocal PETAI,提醒判,a
                                                global 姓名,频道,弹窗_提示窗
                                                name=姓名
                                               
                                                try:
                                                  if(a==''):
                                                      uuser = Account1(name, '1', "Calendar AI自动对话{状态:等待}", "操作:08自动操作{检测状态}")
                                                      uuser.record_history()
                                                  a='1'
                                                  
                                                  
                                                  if(PETAI==[1,0,0]):
                                                      if(弹窗_提示窗==[1,0]):
                                                       弹窗 = Toplevel(word)
                                                       弹窗.title("便利贴 OFFICE【PET/7.V.v】")
                                                       弹窗.attributes('-topmost',  True)
                                                       # 使用 ttk 创建一个框架 
                                                       frame = ttk.Frame(弹窗, padding="10 10 10 10")
                                                       frame.pack(fill="both",  expand= True)
                                                     
                                                    # 添加一个标签
                                                       image = Image.open('PET - 副本.png') 
                                                       
                                                      # 设置新的图像尺寸 
                                                       new_width = 120 
                                                       new_height = 130 
                                                       
                                                      # 调整图像大小，使用高质量的重采样方法 
                                                       resized_image = image.resize((new_width,  new_height), Image.LANCZOS)
                                                       
                                                      # 保存调整大小后的图像 
                                                       resized_image.save('PET - 副本.png') 
                                                       image_path = "PET - 副本.png" 
                                                       original_image = Image.open(image_path) 
                                                       photo2 = ImageTk.PhotoImage(original_image)
                                                       label3 = tk.Label(弹窗, image = photo2)
                                                       label3.image  = photo2  
                                                       label3.place(x=220,y=25)
                                                       
                                                       label = ttk.Label(frame, text="便利贴 OFFICE",font=("微软雅黑",13,"bold"))
                                                       label.place(x=3,y=1)
                                                       label2=ttk.Label(frame,text=f"你好,\n我是Calendar AI,中文名:日历\n你的专属AI PET\n我可以帮您规划时间上的问题\n期待与你同行",font=("微软雅黑",11))
                                                       label2.place(x=3,y=38)
                                                       def OK():
                                                   
                                                           弹窗.destroy()
                                                              

                                                       btn1=ttk.Button(frame,text="很高兴认识你",comman=OK)
                                                       btn1.place(x=3,y=160,height=36,width=334)
                                                         # 设置窗口的初始位置（右下角坐标）
                                                       def on_closing():
                                                                    pass  # 不执行任何操作，阻止关闭 
                                                                 
                                                                
                                                       弹窗.protocol("WM_DELETE_WINDOW",  on_closing)
                                                       def place_window_to_bottom_right(root, window_width=360, window_height=220):
                                                                            # 获取屏幕的宽度和高度
                                                                            screen_width = root.winfo_screenwidth()
                                                                            screen_height = root.winfo_screenheight()

                                                                            # 计算窗口左上角的坐标
                                                                            x_coordinate = screen_width - window_width - 24  # 从右侧留出一点空间
                                                                            y_coordinate = screen_height - window_height - 94  # 从底部留出一点空间（考虑到任务栏）

                                                                            # 设置窗口的大小和位置
                                                                            弹窗.geometry(f"{window_width}x{window_height}+{x_coordinate}+{y_coordinate}")
                                                                           # 使用函数将窗口放置到右下角
                                                       place_window_to_bottom_right(弹窗)

                                                       
                                                      else:
                                                        tkinter.messagebox.showinfo("Calendar AI","你好,\n我是Calendar AI,中文名:日历\n你的专属AI PET\n我可以帮您规划时间上的问题\n期待与你同行")
                                               
                                                      PETAI=[0,0,2]
                                                      uuser = Account1(name, '1', "Calendar AI自动对话{状态:初次见面}", "操作:08自动操作{检测状态}")
                                                      uuser.record_history()





















                                                         
                                                  elif PETAI==[0,1,0]:
                                                    
                                                        now=datetime.now()
                                                        hour=int(f'{now.hour}')
                                                        minute=int(f'{now.minute}')
                                                        second=int(f'{now.second}')
                                                        时间=str(hour)+'时'+str(minute)+'分'
                                                        
                                                        with(open(name+'主控记录.rtf','r'))as ff:
                                                            a=ff.readlines()
                                                            cc=''
                                                            c=''
                                                            ccc=1
                                                            检测备份_文本=''
                                                            for i in range(len(a)-1,-1,-1):
                                                                b=a[-(i+1)]
                                                                #print(b)
                                                                备份b=b
                                                                #b=b.split(',')
                                                                try:
                                                                    备份b=备份b.split('/&&')
                                                                except:
                                                                    检测备份_文本=备份b

                                                                else:
                                                                    cc=b
                                                                    cc=b+检测备份_文本
                                                                    cc=cc.split(',')
                                                                    cc=cc[4]
                                                                    
                                                                    cc=cc.split('操作:')
                                                                    cc=cc[1]
                                                                    #print(cc)
                                                                    检测备份_文本=''
                                                                if(cc=='06运行{AI关闭待机代码}/&&\n'):
                                                                    ccc=1
                                                                elif(cc=='06运行{AI启动待机代码}/&&\n'or cc=='07自动操作{AI启动待机代码}/&&\n'):
                                                                    ccc=2
                                                              
                                                                
                                                            if(ccc==1):
                                                                关闭=1
                                                                
                                                            elif(ccc==2):
                                                                关闭=0
                                                   
                                                        if(关闭==0):
                                                            
                                                            if(hour>=7 and hour<=9 and 提醒判[0]==0):
                                                             uuser = Account1(name, '1', "Calendar AI自动对话{状态:关心}", "操作:08自动操作{检测状态}")
                                                             uuser.record_history()
                                                             提醒判[0]=1
                                                             if(弹窗_提示窗==[1,0]):
                                                                
                                                                 #开始工作了，又是活力满满的一天
                                                                
                                                                弹窗 = Toplevel(word)
                                                                弹窗.title("便利贴 OFFICE【PET/7.V.v】")
                                                                弹窗.attributes('-topmost',  True)
                                                                # 使用 ttk 创建一个框架 
                                                                frame = ttk.Frame(弹窗, padding="10 10 10 10")
                                                                frame.pack(fill="both",  expand= True)
                                                              
                                                             # 添加一个标签
                                                                image = Image.open('PET - 副本.png') 
                                                                
                                                               # 设置新的图像尺寸 
                                                                new_width = 120 
                                                                new_height = 130 
                                                                
                                                               # 调整图像大小，使用高质量的重采样方法 
                                                                resized_image = image.resize((new_width,  new_height), Image.LANCZOS)
                                                                
                                                               # 保存调整大小后的图像 
                                                                resized_image.save('PET - 副本.png') 
                                                                image_path = "PET - 副本.png" 
                                                                original_image = Image.open(image_path) 
                                                                photo2 = ImageTk.PhotoImage(original_image)
                                                                label3 = tk.Label(弹窗, image = photo2)
                                                                label3.image  = photo2  
                                                                label3.place(x=220,y=25)
                                                                
                                                                label = ttk.Label(frame, text="Calendar AI",font=("微软雅黑",13,"bold"))
                                                                label.place(x=3,y=1)
                                                                label2=ttk.Label(frame,text=f"早上好,现在是 {时间}\n开始工作了,又是元气满满的\n一天",font=("微软雅黑",11))
                                                                label2.place(x=3,y=38)
                                                                def OK():
                                                            
                                                                    弹窗.destroy()
                                                                    
                                                                       

                                                                btn1=ttk.Button(frame,text="OK",comman=OK)
                                                                btn1.place(x=3,y=160,height=36,width=334)
                                                                  # 设置窗口的初始位置（右下角坐标）
                                                                def on_closing():
                                                                             pass  # 不执行任何操作，阻止关闭 
                                                                          
                                                                         
                                                                弹窗.protocol("WM_DELETE_WINDOW",  on_closing)
                                                                def place_window_to_bottom_right(root, window_width=360, window_height=220):
                                                                            # 获取屏幕的宽度和高度
                                                                            screen_width = root.winfo_screenwidth()
                                                                            screen_height = root.winfo_screenheight()

                                                                            # 计算窗口左上角的坐标
                                                                            x_coordinate = screen_width - window_width - 24  # 从右侧留出一点空间
                                                                            y_coordinate = screen_height - window_height - 94  # 从底部留出一点空间（考虑到任务栏）

                                                                            # 设置窗口的大小和位置
                                                                            弹窗.geometry(f"{window_width}x{window_height}+{x_coordinate}+{y_coordinate}")
                                                                           # 使用函数将窗口放置到右下角
                                                                place_window_to_bottom_right(弹窗)
                                                             else:
                                                                 tkinter. messagebox.showinfo("Calendar AI",f"早上好,现在是 {时间}\n开始工作了,又是元气满满的\n一天")
                                                                




                                                                     
                                                            if(hour<7 and hour>=6 and 提醒判[1]==0):
                                                             uuser = Account1(name, '1', "Calendar AI自动对话{状态:关心}", "操作:08自动操作{检测状态}")
                                                             uuser.record_history()
                                                             提醒判[1]=1
                                                             if(弹窗_提示==[1,0]):
                                                                 #起这么早啊，我还没睡醒呢
                                                                
                                                                弹窗 = Toplevel(word)
                                                                弹窗.title("便利贴 OFFICE【PET/7.V.v】")
                                                                弹窗.attributes('-topmost',  True)
                                                                # 使用 ttk 创建一个框架 
                                                                frame = ttk.Frame(弹窗, padding="10 10 10 10")
                                                                frame.pack(fill="both",  expand= True)
                                                              
                                                             # 添加一个标签
                                                                image = Image.open('PET - 副本.png') 
                                                                
                                                               # 设置新的图像尺寸 
                                                                new_width = 120 
                                                                new_height = 130 
                                                                
                                                               # 调整图像大小，使用高质量的重采样方法 
                                                                resized_image = image.resize((new_width,  new_height), Image.LANCZOS)
                                                                
                                                               # 保存调整大小后的图像 
                                                                resized_image.save('PET - 副本.png') 
                                                                image_path = "PET - 副本.png" 
                                                                original_image = Image.open(image_path) 
                                                                photo2 = ImageTk.PhotoImage(original_image)
                                                                label3 = tk.Label(弹窗, image = photo2)
                                                                label3.image  = photo2  
                                                                label3.place(x=220,y=25)
                                                                
                                                                label = ttk.Label(frame, text="Calendar AI",font=("微软雅黑",13,"bold"))
                                                                label.place(x=3,y=1)
                                                                
                                                                label2=ttk.Label(frame,text=f"哇,现在是{时间}\n太阳才刚刚升起呢",font=("微软雅黑",11))
                                                                label2.place(x=3,y=38)
                                                                def OK():
                                                            
                                                                    弹窗.destroy()
                                                                    
                                                                       

                                                                btn1=ttk.Button(frame,text="OK",comman=OK)
                                                                btn1.place(x=3,y=160,height=36,width=334)
                                                                  # 设置窗口的初始位置（右下角坐标）
                                                                def on_closing():
                                                                             pass  # 不执行任何操作，阻止关闭 
                                                                          
                                                                         
                                                                弹窗.protocol("WM_DELETE_WINDOW",  on_closing)
                                                                def place_window_to_bottom_right(root, window_width=360, window_height=220):
                                                                            # 获取屏幕的宽度和高度
                                                                            screen_width = root.winfo_screenwidth()
                                                                            screen_height = root.winfo_screenheight()

                                                                            # 计算窗口左上角的坐标
                                                                            x_coordinate = screen_width - window_width - 24 # 从右侧留出一点空间
                                                                            y_coordinate = screen_height - window_height - 94  # 从底部留出一点空间（考虑到任务栏）

                                                                            # 设置窗口的大小和位置
                                                                            弹窗.geometry(f"{window_width}x{window_height}+{x_coordinate}+{y_coordinate}")
                                                                           # 使用函数将窗口放置到右下角
                                                                place_window_to_bottom_right(弹窗)
                                                             else:
                                                                 tkinter. messagebox.showinfo("Calendar AI",f"哇,现在是{时间}\n太阳才刚刚升起呢")
                                                               

                                                    

                                                            elif(hour<13 and hour>=11 and minute>=30 and 提醒判[5]==0):
                                                             uuser = Account1(name, '1', "Calendar AI自动对话{状态:关心}", "操作:08自动操作{检测状态}")
                                                             uuser.record_history()
                                                             提醒判[5]=1
                                                             if(弹窗_提示窗==[1,0]):
                                                                
                                                                
                                                                
                                                                弹窗 = Toplevel(word)
                                                                弹窗.title("便利贴 OFFICE【PET/7.V.v】")
                                                                弹窗.attributes('-topmost',  True)
                                                                # 使用 ttk 创建一个框架 
                                                                frame = ttk.Frame(弹窗, padding="10 10 10 10")
                                                                frame.pack(fill="both",  expand= True)
                                                              
                                                             # 添加一个标签
                                                                image = Image.open('PET - 副本.png') 
                                                                
                                                               # 设置新的图像尺寸 
                                                                new_width = 120 
                                                                new_height = 130 
                                                                
                                                               # 调整图像大小，使用高质量的重采样方法 
                                                                resized_image = image.resize((new_width,  new_height), Image.LANCZOS)
                                                                
                                                               # 保存调整大小后的图像 
                                                                resized_image.save('PET - 副本.png') 
                                                                image_path = "PET - 副本.png" 
                                                                original_image = Image.open(image_path) 
                                                                photo2 = ImageTk.PhotoImage(original_image)
                                                                label3 = tk.Label(弹窗, image = photo2)
                                                                label3.image  = photo2  
                                                                label3.place(x=220,y=25)
                                                                
                                                                label = ttk.Label(frame, text="Calendar AI",font=("微软雅黑",13,"bold"))
                                                                label.place(x=3,y=1)
                                                                label2=ttk.Label(frame,text=f"中午好,现在是{时间}\n可以休息一会喽",font=("微软雅黑",11))
                                                                label2.place(x=3,y=38)
                                                                def OK():
                                                            
                                                                    弹窗.destroy()
                                                                    
                                                                       

                                                                btn1=ttk.Button(frame,text="OK",comman=OK)
                                                                btn1.place(x=3,y=160,height=36,width=334)
                                                                  # 设置窗口的初始位置（右下角坐标）
                                                                def on_closing():
                                                                             pass  # 不执行任何操作，阻止关闭 
                                                                          
                                                                         
                                                                弹窗.protocol("WM_DELETE_WINDOW",  on_closing)
                                                                def place_window_to_bottom_right(root, window_width=360, window_height=220):
                                                                            # 获取屏幕的宽度和高度
                                                                            screen_width = root.winfo_screenwidth()
                                                                            screen_height = root.winfo_screenheight()

                                                                            # 计算窗口左上角的坐标
                                                                            x_coordinate = screen_width - window_width - 24  # 从右侧留出一点空间
                                                                            y_coordinate = screen_height - window_height - 94  # 从底部留出一点空间（考虑到任务栏）

                                                                            # 设置窗口的大小和位置
                                                                            弹窗.geometry(f"{window_width}x{window_height}+{x_coordinate}+{y_coordinate}")
                                                                           # 使用函数将窗口放置到右下角
                                                                place_window_to_bottom_right(弹窗)
                                                             else:
                                                                 tkinter. messagebox.showinfo("Calendar AI",f"中午好,现在是{时间}\n可以休息一会喽")
                                                             
                                                            elif(hour==13 and minute>=15 and 提醒判[6]==0):
                                                             uuser = Account1(name, '1', "Calendar AI自动对话{状态:关心}", "操作:08自动操作{检测状态}")
                                                             uuser.record_history()
                                                             #起这么早啊，我还没睡醒呢
                                                             提醒判[6]=1
                                                             if(弹窗_提示窗==[1,0]):
                                                                弹窗 = Toplevel(word)
                                                                弹窗.title("便利贴 OFFICE【PET/7.V.v】")
                                                                弹窗.attributes('-topmost',  True)
                                                                # 使用 ttk 创建一个框架 
                                                                frame = ttk.Frame(弹窗, padding="10 10 10 10")
                                                                frame.pack(fill="both",  expand= True)
                                                              
                                                             # 添加一个标签
                                                                image = Image.open('PET - 副本.png') 
                                                                
                                                               # 设置新的图像尺寸 
                                                                new_width = 120 
                                                                new_height = 130 
                                                                
                                                               # 调整图像大小，使用高质量的重采样方法 
                                                                resized_image = image.resize((new_width,  new_height), Image.LANCZOS)
                                                                
                                                               # 保存调整大小后的图像 
                                                                resized_image.save('PET - 副本.png') 
                                                                image_path = "PET - 副本.png" 
                                                                original_image = Image.open(image_path) 
                                                                photo2 = ImageTk.PhotoImage(original_image)
                                                                label3 = tk.Label(弹窗, image = photo2)
                                                                label3.image  = photo2  
                                                                label3.place(x=220,y=25)
                                                                
                                                                label = ttk.Label(frame, text="Calendar AI",font=("微软雅黑",13,"bold"))
                                                                label.place(x=3,y=1)
                                                                label2=ttk.Label(frame,text=f"下午好,现在是{时间}\n继续工作吧",font=("微软雅黑",11))
                                                                label2.place(x=3,y=38)
                                                                def OK():
                                                            
                                                                    弹窗.destroy()
                                                                    
                                                                       

                                                                btn1=ttk.Button(frame,text="OK",comman=OK)
                                                                btn1.place(x=3,y=160,height=36,width=334)
                                                                  # 设置窗口的初始位置（右下角坐标）
                                                                def on_closing():
                                                                             pass  # 不执行任何操作，阻止关闭 
                                                                          
                                                                         
                                                                弹窗.protocol("WM_DELETE_WINDOW",  on_closing)
                                                                def place_window_to_bottom_right(root, window_width=360, window_height=220):
                                                                            # 获取屏幕的宽度和高度
                                                                            screen_width = root.winfo_screenwidth()
                                                                            screen_height = root.winfo_screenheight()

                                                                            # 计算窗口左上角的坐标
                                                                            x_coordinate = screen_width - window_width - 24  # 从右侧留出一点空间
                                                                            y_coordinate = screen_height - window_height - 94  # 从底部留出一点空间（考虑到任务栏）

                                                                            # 设置窗口的大小和位置
                                                                            弹窗.geometry(f"{window_width}x{window_height}+{x_coordinate}+{y_coordinate}")
                                                                           # 使用函数将窗口放置到右下角
                                                                place_window_to_bottom_right(弹窗)
                                                             else:
                                                                 tkinter. messagebox.showinfo("Calendar AI",f"下午好,现在是{时间}\n继续工作吧")
                                                             

                                                                
                                                            elif(hour<6  and hour>4 and  minute>=30 and 提醒判[2]==0):
                                                             uuser = Account1(name, '1', "Calendar AI自动对话{状态:关心}", "操作:08自动操作{检测状态}")
                                                             uuser.record_history()
                                                              #这也起太早了吧，注意身体呦
                                                             提醒判[2]=1
                                                             if(弹窗_提示窗):
                                                                弹窗 = Toplevel(word)
                                                                弹窗.title("便利贴 OFFICE【PET/7.V.v】")
                                                                弹窗.attributes('-topmost',  True)
                                                                # 使用 ttk 创建一个框架 
                                                                frame = ttk.Frame(弹窗, padding="10 10 10 10")
                                                                frame.pack(fill="both",  expand= True)
                                                              
                                                             # 添加一个标签
                                                                image = Image.open('PET - 副本.png') 
                                                                
                                                               # 设置新的图像尺寸 
                                                                new_width = 120 
                                                                new_height = 130 
                                                                
                                                               # 调整图像大小，使用高质量的重采样方法 
                                                                resized_image = image.resize((new_width,  new_height), Image.LANCZOS)
                                                                
                                                               # 保存调整大小后的图像 
                                                                resized_image.save('PET - 副本.png') 
                                                                image_path = "PET - 副本.png" 
                                                                original_image = Image.open(image_path) 
                                                                photo2 = ImageTk.PhotoImage(original_image)
                                                                label3 = tk.Label(弹窗, image = photo2)
                                                                label3.image  = photo2  
                                                                label3.place(x=220,y=25)
                                                                
                                                                label = ttk.Label(frame, text="Calendar AI",font=("微软雅黑",13,"bold"))
                                                                label.place(x=3,y=1)
                                                                label2=ttk.Label(frame,text=f"Hi,现在是{时间}\n这也起太早了吧，注意身体呦",font=("微软雅黑",11))
                                                                label2.place(x=3,y=38)
                                                                def OK():
                                                            
                                                                    弹窗.destroy()
                                                                    
                                                                       

                                                                btn1=ttk.Button(frame,text="OK",comman=OK)
                                                                btn1.place(x=3,y=160,height=36,width=334)
                                                                  # 设置窗口的初始位置（右下角坐标）
                                                                def on_closing():
                                                                             pass  # 不执行任何操作，阻止关闭 
                                                                          
                                                                         
                                                                弹窗.protocol("WM_DELETE_WINDOW",  on_closing)
                                                                def place_window_to_bottom_right(root, window_width=360, window_height=220):
                                                                            # 获取屏幕的宽度和高度
                                                                            screen_width = root.winfo_screenwidth()
                                                                            screen_height = root.winfo_screenheight()

                                                                            # 计算窗口左上角的坐标
                                                                            x_coordinate = screen_width - window_width - 24  # 从右侧留出一点空间
                                                                            y_coordinate = screen_height - window_height - 94  # 从底部留出一点空间（考虑到任务栏）

                                                                            # 设置窗口的大小和位置
                                                                            弹窗.geometry(f"{window_width}x{window_height}+{x_coordinate}+{y_coordinate}")
                                                                           # 使用函数将窗口放置到右下角
                                                                place_window_to_bottom_right(弹窗)
                                                             else:
                                                                 tkinter. messagebox.showinfo("Calendar AI",f"Hi,现在是{时间}\n这也起太早了吧，注意身体呦")
                                                                 


                                                            elif(hour>=20  and hour<22 and minute<45 and 提醒判[3]==0):
                                                             uuser = Account1(name, '1', "Calendar AI自动对话{状态:关心}", "操作:08自动操作{检测状态}")
                                                             uuser.record_history()
                                                             提醒判[3]=1
                                                             if(弹窗_提示窗==[1,0]):
                                                                 #要注意休息呦
                                                                弹窗 = Toplevel(word)
                                                                弹窗.title("便利贴 OFFICE【PET/7.V.v】")
                                                                弹窗.attributes('-topmost',  True)
                                                                # 使用 ttk 创建一个框架 
                                                                frame = ttk.Frame(弹窗, padding="10 10 10 10")
                                                                frame.pack(fill="both",  expand= True)
                                                              
                                                             # 添加一个标签
                                                                image = Image.open('PET - 副本.png') 
                                                                
                                                               # 设置新的图像尺寸 
                                                                new_width = 120 
                                                                new_height = 130 
                                                                
                                                               # 调整图像大小，使用高质量的重采样方法 
                                                                resized_image = image.resize((new_width,  new_height), Image.LANCZOS)
                                                                
                                                               # 保存调整大小后的图像 
                                                                resized_image.save('PET - 副本.png') 
                                                                image_path = "PET - 副本.png" 
                                                                original_image = Image.open(image_path) 
                                                                photo2 = ImageTk.PhotoImage(original_image)
                                                                label3 = tk.Label(弹窗, image = photo2)
                                                                label3.image  = photo2  
                                                                label3.place(x=220,y=25)
                                                                
                                                                label = ttk.Label(frame, text="Calendar AI",font=("微软雅黑",13,"bold"))
                                                                label.place(x=3,y=1)
                                                                label2=ttk.Label(frame,text=f"晚上了,现在是 {时间}\n要注意休息呦",font=("微软雅黑",11))
                                                                label2.place(x=3,y=38)
                                                                def OK():
                                                            
                                                                    弹窗.destroy()
                                                                    
                                                                       

                                                                btn1=ttk.Button(frame,text="OK",comman=OK)
                                                                btn1.place(x=3,y=160,height=36,width=334)
                                                                  # 设置窗口的初始位置（右下角坐标）
                                                                def on_closing():
                                                                             pass  # 不执行任何操作，阻止关闭 
                                                                          
                                                                         
                                                                弹窗.protocol("WM_DELETE_WINDOW",  on_closing)
                                                                def place_window_to_bottom_right(root, window_width=360, window_height=220):
                                                                            # 获取屏幕的宽度和高度
                                                                            screen_width = root.winfo_screenwidth()
                                                                            screen_height = root.winfo_screenheight()

                                                                            # 计算窗口左上角的坐标
                                                                            x_coordinate = screen_width - window_width - 24  # 从右侧留出一点空间
                                                                            y_coordinate = screen_height - window_height - 94  # 从底部留出一点空间（考虑到任务栏）

                                                                            # 设置窗口的大小和位置
                                                                            弹窗.geometry(f"{window_width}x{window_height}+{x_coordinate}+{y_coordinate}")
                                                                           # 使用函数将窗口放置到右下角
                                                                place_window_to_bottom_right(弹窗)
                                                             else:
                                                                 tkinter. messagebox.showinfo("Calendar AI",f"晚上了,现在是 {时间}\n要注意休息呦")
                                                                 

                                                            elif(hour>=17  and hour<19 and minute>0  and 提醒判[7]==0):
                                                             uuser = Account1(name, '1', "Calendar AI自动对话{状态:关心}", "操作:08自动操作{检测状态}")
                                                             uuser.record_history()
                                                             提醒判[7]=1
                                                             if(弹窗_提示窗==[1,0]):
                                                                 #要注意休息呦
                                                                弹窗 = Toplevel(word)
                                                                弹窗.title("便利贴 OFFICE【PET/7.V.v】")
                                                                弹窗.attributes('-topmost',  True)
                                                                # 使用 ttk 创建一个框架 
                                                                frame = ttk.Frame(弹窗, padding="10 10 10 10")
                                                                frame.pack(fill="both",  expand= True)
                                                              
                                                             # 添加一个标签
                                                                image = Image.open('PET - 副本.png') 
                                                                
                                                               # 设置新的图像尺寸 
                                                                new_width = 120 
                                                                new_height = 130 
                                                                
                                                               # 调整图像大小，使用高质量的重采样方法 
                                                                resized_image = image.resize((new_width,  new_height), Image.LANCZOS)
                                                                
                                                               # 保存调整大小后的图像 
                                                                resized_image.save('PET - 副本.png') 
                                                                image_path = "PET - 副本.png" 
                                                                original_image = Image.open(image_path) 
                                                                photo2 = ImageTk.PhotoImage(original_image)
                                                                label3 = tk.Label(弹窗, image = photo2)
                                                                label3.image  = photo2  
                                                                label3.place(x=220,y=25)
                                                                
                                                                label = ttk.Label(frame, text="Calendar AI",font=("微软雅黑",13,"bold"))
                                                                label.place(x=3,y=1)
                                                                label2=ttk.Label(frame,text=f"晚餐时间,现在是 {时间}\n今天吃的怎么样",font=("微软雅黑",11))
                                                                label2.place(x=3,y=38)
                                                                def OK():
                                                            
                                                                    弹窗.destroy()
                                                                    
                                                                       

                                                                btn1=ttk.Button(frame,text="OK",comman=OK)
                                                                btn1.place(x=3,y=160,height=36,width=334)
                                                                  # 设置窗口的初始位置（右下角坐标）
                                                                def on_closing():
                                                                             pass  # 不执行任何操作，阻止关闭 
                                                                          
                                                                         
                                                                弹窗.protocol("WM_DELETE_WINDOW",  on_closing)
                                                                def place_window_to_bottom_right(root, window_width=360, window_height=220):
                                                                            # 获取屏幕的宽度和高度
                                                                            screen_width = root.winfo_screenwidth()
                                                                            screen_height = root.winfo_screenheight()

                                                                            # 计算窗口左上角的坐标
                                                                            x_coordinate = screen_width - window_width - 24  # 从右侧留出一点空间
                                                                            y_coordinate = screen_height - window_height - 94  # 从底部留出一点空间（考虑到任务栏）

                                                                            # 设置窗口的大小和位置
                                                                            弹窗.geometry(f"{window_width}x{window_height}+{x_coordinate}+{y_coordinate}")
                                                                           # 使用函数将窗口放置到右下角
                                                                place_window_to_bottom_right(弹窗)



                                                             else:
                                                                 tkinter. messagebox.showinfo("Calendar AI",f"晚餐时间,现在是 {时间}\n今天吃的怎么样")
                                                                 
                                                 
                                                            elif(hour>=22  and 提醒判[4]==0):
                                                             uuser = Account1(name, '1', "Calendar AI自动对话{状态:关心}", "操作:08自动操作{检测状态}")
                                                             uuser.record_history()
                                                             提醒判[4]=1
                                                             if(弹窗_提示窗==[1,0]):
                                                                
                                                         
                                                                弹窗 = Toplevel(word)
                                                                弹窗.title("便利贴 OFFICE【PET/7.V.v】")
                                                                弹窗.attributes('-topmost',  True)
                                                                # 使用 ttk 创建一个框架 
                                                                frame = ttk.Frame(弹窗, padding="10 10 10 10")
                                                                frame.pack(fill="both",  expand= True)
                                                              
                                                             # 添加一个标签
                                                                image = Image.open('PET - 副本.png') 
                                                                
                                                               # 设置新的图像尺寸 
                                                                new_width = 120 
                                                                new_height = 130 
                                                                
                                                               # 调整图像大小，使用高质量的重采样方法 
                                                                resized_image = image.resize((new_width,  new_height), Image.LANCZOS)
                                                                
                                                               # 保存调整大小后的图像 
                                                                resized_image.save('PET - 副本.png') 
                                                                image_path = "PET - 副本.png" 
                                                                original_image = Image.open(image_path) 
                                                                photo2 = ImageTk.PhotoImage(original_image)
                                                                label3 = tk.Label(弹窗, image = photo2)
                                                                label3.image  = photo2  
                                                                label3.place(x=220,y=25)
                                                                
                                                                label = ttk.Label(frame, text="Calendar AI",font=("微软雅黑",13,"bold"))
                                                                label.place(x=3,y=1)
                                                                label2=ttk.Label(frame,text=f"深夜了,现在是 {时间}\n工作的事先放一放吧",font=("微软雅黑",11))
                                                                label2.place(x=3,y=38)
                                                                def OK():
                                                            
                                                                    弹窗.destroy()
                                                                    
                                                                       

                                                                btn1=ttk.Button(frame,text="OK",comman=OK)
                                                                btn1.place(x=3,y=160,height=36,width=334)
                                                                  # 设置窗口的初始位置（右下角坐标）
                                                                def on_closing():
                                                                             pass  # 不执行任何操作，阻止关闭 
                                                                          
                                                                         
                                                                弹窗.protocol("WM_DELETE_WINDOW",  on_closing)
                                                                def place_window_to_bottom_right(root, window_width=360, window_height=220):
                                                                            # 获取屏幕的宽度和高度
                                                                            screen_width = root.winfo_screenwidth()
                                                                            screen_height = root.winfo_screenheight()

                                                                            # 计算窗口左上角的坐标
                                                                            x_coordinate = screen_width - window_width - 24  # 从右侧留出一点空间
                                                                            y_coordinate = screen_height - window_height - 94  # 从底部留出一点空间（考虑到任务栏）

                                                                            # 设置窗口的大小和位置
                                                                            弹窗.geometry(f"{window_width}x{window_height}+{x_coordinate}+{y_coordinate}")
                                                                           # 使用函数将窗口放置到右下角
                                                                place_window_to_bottom_right(弹窗)
                                                             else:
                                                                  tkinter. messagebox.showinfo("Calendar AI",f"深夜了,现在是 {时间}\n工作的事先放一放吧")
                                                                  
                                                            elif(hour>=16 and hour<18 and minute<15  and 提醒判[9]==0):
                                                             uuser = Account1(name, '1', "Calendar AI自动对话{状态:关心}", "操作:08自动操作{检测状态}")
                                                             uuser.record_history()
                                                             提醒判[9]=1
                                                             if(弹窗_提示窗==[1,0]):
                                                                
                                                         
                                                                弹窗 = Toplevel(word)
                                                                弹窗.title("便利贴 OFFICE【PET/7.V.v】")
                                                                弹窗.attributes('-topmost',  True)
                                                                # 使用 ttk 创建一个框架 
                                                                frame = ttk.Frame(弹窗, padding="10 10 10 10")
                                                                frame.pack(fill="both",  expand= True)
                                                              
                                                             # 添加一个标签
                                                                image = Image.open('PET - 副本.png') 
                                                                
                                                               # 设置新的图像尺寸 
                                                                new_width = 120 
                                                                new_height = 130 
                                                                
                                                               # 调整图像大小，使用高质量的重采样方法 
                                                                resized_image = image.resize((new_width,  new_height), Image.LANCZOS)
                                                                
                                                               # 保存调整大小后的图像 
                                                                resized_image.save('PET - 副本.png') 
                                                                image_path = "PET - 副本.png" 
                                                                original_image = Image.open(image_path) 
                                                                photo2 = ImageTk.PhotoImage(original_image)
                                                                label3 = tk.Label(弹窗, image = photo2)
                                                                label3.image  = photo2  
                                                                label3.place(x=220,y=25)
                                                                
                                                                label = ttk.Label(frame, text="Calendar AI",font=("微软雅黑",13,"bold"))
                                                                label.place(x=3,y=1)
                                                                label2=ttk.Label(frame,text=f"加油坚持住,现在是{时间}\n马上就能吃饭了",font=("微软雅黑",11))
                                                                label2.place(x=3,y=38)
                                                                def OK():
                                                            
                                                                    弹窗.destroy()
                                                                    
                                                                       

                                                                btn1=ttk.Button(frame,text="OK",comman=OK)
                                                                btn1.place(x=3,y=160,height=36,width=334)
                                                                  # 设置窗口的初始位置（右下角坐标）
                                                                def on_closing():
                                                                             pass  # 不执行任何操作，阻止关闭 
                                                                          
                                                                         
                                                                弹窗.protocol("WM_DELETE_WINDOW",  on_closing)
                                                                def place_window_to_bottom_right(root, window_width=360, window_height=220):
                                                                            # 获取屏幕的宽度和高度
                                                                            screen_width = root.winfo_screenwidth()
                                                                            screen_height = root.winfo_screenheight()

                                                                            # 计算窗口左上角的坐标
                                                                            x_coordinate = screen_width - window_width - 24  # 从右侧留出一点空间
                                                                            y_coordinate = screen_height - window_height - 94  # 从底部留出一点空间（考虑到任务栏）

                                                                            # 设置窗口的大小和位置
                                                                            弹窗.geometry(f"{window_width}x{window_height}+{x_coordinate}+{y_coordinate}")
                                                                           # 使用函数将窗口放置到右下角
                                                                place_window_to_bottom_right(弹窗)
                                                             else:
                                                                  tkinter. messagebox.showinfo("Calendar AI",f"加油坚持住,现在是{时间}\n马上就能吃饭了")
                                                                  


                                                            
                                                  if(PETAI==[0,0,1]):
                                                                                                          
                                                    uuser = Account1(name, '1', "Calendar AI自动对话{状态:安慰}", "操作:08自动操作{检测状态}")
                                                    uuser.record_history()
                                                    if(弹窗_提示窗==[1,0]):
                                                        #print(1)
                                                        弹窗 = Toplevel(word)
                                                        弹窗.title("便利贴 OFFICE【PET/7.V.v】")
                                                        弹窗.attributes('-topmost',  True)
                                                        # 使用 ttk 创建一个框架 
                                                        frame = ttk.Frame(弹窗, padding="10 10 10 10")
                                                        frame.pack(fill="both",  expand= True)
                                                      
                                                     # 添加一个标签
                                                        image = Image.open('PET - 副本.png') 
                                                        
                                                       # 设置新的图像尺寸 
                                                        new_width = 120 
                                                        new_height = 130 
                                                        
                                                       # 调整图像大小，使用高质量的重采样方法 
                                                        resized_image = image.resize((new_width,  new_height), Image.LANCZOS)
                                                        
                                                       # 保存调整大小后的图像 
                                                        resized_image.save('PET - 副本.png') 
                                                        image_path = "PET - 副本.png" 
                                                        original_image = Image.open(image_path) 
                                                        photo2 = ImageTk.PhotoImage(original_image)
                                                        label3 = tk.Label(弹窗, image = photo2)
                                                        label3.image  = photo2  
                                                        label3.place(x=220,y=25)
                                                        
                                                        label = ttk.Label(frame, text="Calendar AI",font=("微软雅黑",13,"bold"))
                                                        label.place(x=3,y=1)
                                                        label2=ttk.Label(frame,text=f"我在这里,\n不要担心我始终陪着您",font=("微软雅黑",11))
                                                        label2.place(x=3,y=38)
                                                        def OK():
                                                    
                                                            弹窗.destroy()
                                                            
                                                               

                                                        btn1=ttk.Button(frame,text="OK",comman=OK)
                                                        btn1.place(x=3,y=160,height=36,width=334)
                                                          # 设置窗口的初始位置（右下角坐标）
                                                        def on_closing():
                                                                     pass  # 不执行任何操作，阻止关闭 
                                                                  
                                                                 
                                                        弹窗.protocol("WM_DELETE_WINDOW",  on_closing)
                                                        def place_window_to_bottom_right(root, window_width=360, window_height=220):
                                                                            # 获取屏幕的宽度和高度
                                                                            screen_width = root.winfo_screenwidth()
                                                                            screen_height = root.winfo_screenheight()

                                                                            # 计算窗口左上角的坐标
                                                                            x_coordinate = screen_width - window_width - 24  # 从右侧留出一点空间
                                                                            y_coordinate = screen_height - window_height - 94  # 从底部留出一点空间（考虑到任务栏）

                                                                            # 设置窗口的大小和位置
                                                                            弹窗.geometry(f"{window_width}x{window_height}+{x_coordinate}+{y_coordinate}")
                                                                           # 使用函数将窗口放置到右下角
                                                        place_window_to_bottom_right(弹窗)

                                                        PETAI=[0,1,0]
                                                    else:
                                               
                                                          tkinter. messagebox.showinfo("Calendar AI",f"我在这里,\n不要担心我始终陪着您")
                                                     
                                                  
                                                   
                                                       
                                             
                                                  if(name!=''):
                                                       f=open(name+'账本.rtf','r')
                                                                 
                                                       a=f.readlines()
                                                       f.close()
                                                       for i in range(len(a)):
                                                          b=a[-(i+1)]
                                                          b=b.split(',')
                                                          c=b[3]
                                                        
                                                          c=c.split('虚拟物品:')
                                                         
                                                          c=c[1]
                                                      
                                                          if(c=='calendar AI/&&\n'):
                                                               c=c
                                                               if(PETAI!=[1,0,0]):
                                                                   PETAI=[0,1,0]
                                                               break
                                                   
                                                  word.after(1000,calendarAI)
                                               
                                                except Exception as e:
                                                    # 打印错误信息和行号
                                                    tb = traceback.extract_tb(sys.exc_info()[2])
                                                    error_message = f"{e} (line {tb[-1].lineno})"
                                                    print(f"报错: {error_message}")


                                            calendarAI()
                                            label_时长=''
                                            btn_返回=''
                                            btn_CA=''
                                            
                                           
                                            
                                            def shop():
                                                global 姓名
                                                
                                                nonlocal 工作时长,label_时长,btn_返回,btn_CA
                                                nonlocal 运行,商城,放行,timme,分,秒,时
                                            
                                                try:
                                                    
                                                    name=姓名
                                                    label_时长=tk.Label(word,text='                                                       ',font=("微软雅黑 Light",11,'bold'))
                                                    label_时长.place(x=505,y=5)
                                                    if(name!='' and 运行==1):
                                                        
                                                        def Cencell():
                                                      
                                                            
                                                            nonlocal 运行,放行,label_时长,btn_返回,btn_CA
                                                            global 频道
                                                            
                                                            放行=0
                                                            运行=0
                                                            频道='00'
                                                            切换()
                                                            
                                                            label_时长.destroy()
                                                        
                                                            
                                                            word.geometry('473x417')
                                                            btn3.destroy()
                                                            btn_CA.destroy()
                                                            
                                                            
                                                        if(放行==0):
                                                            
                                                            放行+=1
                                                            if(放行==3):
                                                                shenfen = "用户"

                                                                tongy="1"
                                                                uuser = Account1(姓名, tongy, "商城购物", "操作:07自动操作{自动经营代码}")
                                                                uuser.record_history()
                                                        时 = int(工作时长[0])
                                                        分 = int(工作时长[1])
                                                        秒 = int(工作时长[2])
                                                        timee=时+分+秒
                                                        f=open(name+'.rtf','r')
                                                        a=f.readlines()
                                                        b=a[-1]
                                                        b=b.split(',')
                                                        c=b[2]
                                                        c=c.split('当前资金:')
                                                        c=c[1]
                                                        c=list(c)
                                                        if(len(c)==1):
                                                            c=[0,'时',0,'分',0,'秒']
                                                        i=0
                                                 
                                                        pw=b[1]
                                                        
                                                        pw=pw.split('密码:')
                                                        pw=pw[1]
                                                        
                                                        


                                                        import re 
     
                                                        def extract_time_units(lst):
                                                            # 将列表转换为字符串 
                                                            lst_str = ''.join(map(str, lst))
                                                            
                                                            # 使用正则表达式匹配数字和单位 
                                                            pattern = r'(\d+)(时|分|秒)'
                                                            matches = re.findall(pattern,  lst_str)
                                                            
                                                            # 初始化变量 
                                                            时时 = None 
                                                            分分 = None 
                                                            秒秒 = None 
                                                            
                                                            # 处理匹配结果 
                                                            for match in matches:
                                                                value, unit = match 
                                                                if unit == '时':
                                                                    时时 = int(value)
                                                                elif unit == '分':
                                                                    分分 = int(value)
                                                                elif unit == '秒':
                                                                    秒秒 = int(value)
                                                            
                                                            return 时时, 分分, 秒秒 
                                                         
                                                        # 示例列表 
                                                        my_list =c                                                     
                                                        # 提取时间单位 
                                                        时时, 分分, 秒秒 = extract_time_units(my_list)
                                                        #时+=360
                                                        
                                                        

                                                        时=时+int(时时)
                                                        分=int(分分)+分
                                                        秒=int(秒秒)+秒
                                                        if(秒>59):
                                                            秒-=60
                                                            分+=1
                                                        if(分>59):
                                                            分-=60
                                                            时+=1
                                                            
                                                        timme=str(时)+"时"+str(分)+"分"+str(秒)+"秒"

                                                             
                                                        label_时长.config(text='                                                       ')
                                              
                                                        label_时长.config(text='办公总时长:'+str(timme))
                                                        

                                                        btn2=0
                                                        
                                                        def PET():
                                                            nonlocal PETAI,timme,分,秒,时,a
                                                            global 姓名
                                                            global 弹窗_提示窗,频道
                                                            f=open(name+'账本.rtf','r')
                                                                 
                                                            a=f.readlines()
                                                            f.close()
                                                            
                                                            
                                                            for i in range(len(a)):
                                                                  b=a[-(i+1)]
                                                                  b=b.split(',')
                                                                  c=b[3]
                                                                
                                                                  c=c.split('虚拟物品:')
                                                                 
                                                                  c=c[1]
                                                                  #print(c)
                                                                  if(c=='calendar AI/&&\n'):
                                                                       c=c
                                                                       break
                                                    
                                                           
                                                           
                                                            if(时>=60 or c=='calendar AI/&&\n'):
                                                                 
                                                                 
                                                                 if PETAI==[0,0,0] and c!='calendar AI/&&\n':
                                                                    if(弹窗_提示窗==[1,0]):
                                                                      弹窗 = Tk()
                                                                      弹窗.title("便利贴 OFFICE【PET/7.V.v】")
                                                                      弹窗.attributes('-topmost',  True)
                                                                      # 使用 ttk 创建一个框架 
                                                                      frame = ttk.Frame(弹窗, padding="10 10 10 10")
                                                                      frame.pack(fill="both",  expand=True)
                                                                    
                                                                   # 添加一个标签 
                                                                      label = ttk.Label(frame, text="便利贴 OFFICE",font=("微软雅黑",13,"bold"))
                                                                      label.place(x=3,y=1)
                                                                      label2=ttk.Label(frame,text=f"您确定购买Calendar AI并支付积分吗",font=("微软雅黑",11))
                                                                      label2.place(x=3,y=38)
                                                                      def OK():
                                                                         nonlocal PETAI,时,分,秒
                                                                         
                                                                         时-=60
                                                                         timme=str(时)+"时"+str(分)+"分"+str(秒)+"秒"
                                                                         shenfen = "用户"

                                                                         label_时长.config(text='                                                       ')
                                              
                                                                         label_时长.config(text='办公总时长:'+str(timme))

                                                                         tongy="1"
                                                                         uuser = Account1(姓名, tongy, "商城购物", "操作:07自动操作{售卖AI代码}")
                                                                         uuser.record_history()



                                                                         # 创建 Account 对象并记录
                                                                         user = Account(name, pw,timme , "自动经营", shenfen)
                                                                         user.record()
                                                                         uuser = Account1(姓名, '1', f"设置(开启Calendar AI对话模式)", "操作:07自动操作{AI启动待机代码}")
                                                                         uuser.record_history()
                                                                         
                                                                         user = Account2(name,'calendar AI','60H')
                                                                         user.record_zhangben()
                                                                         PETAI=[1,0,0]
                                                                         弹窗.destroy()
                                                                      def Cencel():
                                                                         
                                                                           
                                                                           弹窗.destroy()
                                                                           
                                                                             

                                                                      btn1=ttk.Button(frame,text="确认购买",comman=OK)
                                                                      btn1.place(x=3,y=160,height=36,width=167)
                                                                      btn2=ttk.Button(frame,text="再看看",comman=Cencel)
                                                                      btn2.place(x=170,y=160,height=36,width=167)
                                                                      def on_closing():
                                                                         pass  # 不执行任何操作，阻止关闭 
                                                                      
                                                                     
                                                                      弹窗.protocol("WM_DELETE_WINDOW",  on_closing)
                                                                        # 设置窗口的初始位置（右下角坐标）
                                                                      def place_window_to_bottom_right(root, window_width=360, window_height=220):
                                                                            # 获取屏幕的宽度和高度
                                                                            screen_width = root.winfo_screenwidth()
                                                                            screen_height = root.winfo_screenheight()

                                                                            # 计算窗口左上角的坐标
                                                                            x_coordinate = screen_width - window_width - 24  # 从右侧留出一点空间
                                                                            y_coordinate = screen_height - window_height - 94  # 从底部留出一点空间（考虑到任务栏）

                                                                            # 设置窗口的大小和位置
                                                                            弹窗.geometry(f"{window_width}x{window_height}+{x_coordinate}+{y_coordinate}")
                                                                           # 使用函数将窗口放置到右下角
                                                                      place_window_to_bottom_right(弹窗)
                                                                    else:
                                                                        response = messagebox.askyesno("便利贴 OFFICE", "您确定购买Calendar AI并支付积分吗？")
                                                                        if response:
                                                                             时-=60
                                                                             timme=str(时)+"时"+str(分)+"分"+str(秒)+"秒"
                                                                             shenfen = "用户"

                                                                             tongy="1"
                                                                             uuser = Account1(姓名, tongy, "商城购物", "操作:07自动操作{售卖AI代码}")
                                                                             uuser.record_history()



                                                                             # 创建 Account 对象并记录
                                                                             user = Account(name, pw,timme , "自动经营", shenfen)
                                                                             user.record()
                                                                             uuser = Account1(姓名, '1', f"设置(开启Calendar AI对话模式)", "操作:07自动操作{AI启动待机代码}")
                                                                             uuser.record_history()
                                                                             
                                                                             user = Account2(name,'calendar AI','60H')
                                                                             user.record_zhangben()
                                                                             PETAI=[1,0,0]
                                                                        else:
                                                                            return


                                                                 else:
                                                                     if(弹窗_提示窗==[1,0]):
                                                                       弹窗 = Tk()
                                                                       弹窗.title("便利贴 OFFICE【PET/7.V.v】")
                                                                       弹窗.attributes('-topmost',  True)
                                                                       # 使用 ttk 创建一个框架 
                                                                       frame = ttk.Frame(弹窗, padding="10 10 10 10")
                                                                       frame.pack(fill="both",  expand=True)
                                                                        
                                                                       # 添加一个标签 
                                                                       label = ttk.Label(frame, text="便利贴 OFFICE",font=("微软雅黑",13,"bold"))
                                                                       label.place(x=3,y=1)
                                                                       label2=tk.Label(frame,text=f"提醒:您当前的账户已拥有此AI",font=("微软雅黑",12))
                                                                       label2.place(x=3,y=38)
                                                                       
                                                                       def OK():
                                                                            nonlocal PETAI
                                                                            PETAI=[0,0,1]
                                                                            弹窗.destroy()
                                                                            

                                                                       btn1=ttk.Button(frame,text="我知道了",comman=OK)
                                                                       btn1.place(x=3,y=160,height=36,width=334)
                                                                       def on_closing():
                                                                         pass  # 不执行任何操作，阻止关闭 
                                                                      
                                                                     
                                                                       弹窗.protocol("WM_DELETE_WINDOW",  on_closing)
                                                                       
                                                                       def place_window_to_bottom_right(root, window_width=360, window_height=220):
                                                                            # 获取屏幕的宽度和高度
                                                                            screen_width = root.winfo_screenwidth()
                                                                            screen_height = root.winfo_screenheight()

                                                                            # 计算窗口左上角的坐标
                                                                            x_coordinate = screen_width - window_width - 24  # 从右侧留出一点空间
                                                                            y_coordinate = screen_height - window_height - 94  # 从底部留出一点空间（考虑到任务栏）

                                                                            # 设置窗口的大小和位置
                                                                            弹窗.geometry(f"{window_width}x{window_height}+{x_coordinate}+{y_coordinate}")
                                                                           # 使用函数将窗口放置到右下角
                                                                       place_window_to_bottom_right(弹窗)

                                                                     else:
                                                                        r=messagebox.showinfo("便利贴 OFFICE:","您当前的账户已拥有此AI")
                                                                        # 判断用户是否点击确定
                                                                        if r == 'ok':
                                                                            PETAI=[0,0,1]
                                                                




                                                                       
                                                            else:
                                                   
                                                                if(弹窗_提示窗==[1,0]):
                                                                  弹窗 = Tk()
                                                                  弹窗.title("便利贴 OFFICE【PET/7.V.v】")
                                                                  弹窗.attributes('-topmost',  True)
                                                                  # 使用 ttk 创建一个框架 
                                                                  frame = ttk.Frame(弹窗, padding="10 10 10 10")
                                                                  frame.pack(fill="both",  expand=True)
                                                                   
                                                                  # 添加一个标签 
                                                                  label = ttk.Label(frame, text="便利贴 OFFICE",font=("微软雅黑",13,"bold"))
                                                                  label.place(x=3,y=1)
                                                                  label2=tk.Label(frame,text=f"提醒:您当前的账户暂未达到此金额",font=("微软雅黑",12),fg='#FF6A6A')
                                                                  label2.place(x=3,y=38)
                                                                  
                                                                  def OK():
                                                                       弹窗.destroy()
                                                                       

                                                                  btn1=ttk.Button(frame,text="我知道了",comman=OK)
                                                                  btn1.place(x=3,y=160,height=36,width=334)
                                                                  def on_closing():
                                                                    pass  # 不执行任何操作，阻止关闭 
                                                                 
                                                                
                                                                  弹窗.protocol("WM_DELETE_WINDOW",  on_closing)
                                                                  
                                                                  # 设置窗口的初始位置（右下角坐标）
                                                                  def place_window_to_bottom_right(root, window_width=360, window_height=220):
                                                                            # 获取屏幕的宽度和高度
                                                                            screen_width = root.winfo_screenwidth()
                                                                            screen_height = root.winfo_screenheight()

                                                                            # 计算窗口左上角的坐标
                                                                            x_coordinate = screen_width - window_width - 24  # 从右侧留出一点空间
                                                                            y_coordinate = screen_height - window_height - 94  # 从底部留出一点空间（考虑到任务栏）

                                                                            # 设置窗口的大小和位置
                                                                            弹窗.geometry(f"{window_width}x{window_height}+{x_coordinate}+{y_coordinate}")
                                                                           # 使用函数将窗口放置到右下角
                                                                  place_window_to_bottom_right(弹窗)
                                                                else:
                                                                    tkinter.messagebox.showerror("便利贴 OFFICE:","您当前的账户暂未达到此金额")
                                                                    

                                                                   
                                                          
                                                         
                                             
                                                        style = ttk.Style()
                                                        style.configure('Custom.TButton',
                                                                       font=('幼圆', 9,"bold"))
                                                        
                                               
                                                        
                                                        word.geometry('740x417')
                                                        txt_edit.config(width=45)
                                                       
                                                        

                                                       
                                                       

                                                    
                                                                                                
                                                        
                                                        
                                                        try:
                                                           # 获取当前脚本所在的目录
                                                           image_path = "PET.png"  # 假设图片在同一目录下
                                                           current_dir = os.path.dirname(os.path.abspath(__file__))
                                                           
                                                           # 构建完整的图片路径
                                                           full_image_path = os.path.join(current_dir, image_path)
                                                           
                                                           # 检查文件是否存在
                                                           if not os.path.isfile(full_image_path):
                                                               raise FileNotFoundError(f"图片文件不存在: {full_image_path}")

                                                           # 使用Pillow加载图片并调整大小（如果需要）
                                                           original_image = Image.open(full_image_path)
                                                           resized_image = original_image.resize((95, 86), Image.Resampling.LANCZOS)  # 调整大小

                                                           # 将PIL图像转换为Tkinter兼容的图像
                                                           img = ImageTk.PhotoImage(resized_image)

                                                           # 创建一个Button，并设置图片和文字
                                                            

                                                           btn_CA=ttk.Button(word,style='Custom.TButton',text='''calendar AI
   60小时''',image=img,compound='top',command=PET) 
                                                           btn_CA.place(x=465,y=48,width=115,height=122)
                                                           # 保存对图片的引用，防止垃圾回收
                                                           btn_CA.image = img

                                                        except FileNotFoundError as e:
                                                           messagebox.showerror("错误", f"图片文件未找到: {e}")
                                                        except Exception as e:
                                                           messagebox.showerror("错误", f"无法加载图片: {e}")
                                                           raise

                                                        
                                                        
                                                            
                                                            
                                                        style=ttk.Style()
                                                        style.configure('m.TButton',font=('微软雅黑',12))
                                                        btn3=tkinter.Button(word,text="<返回",font=("微软雅黑",11),borderwidth=-1,fg='black',bg='#EDEDED',activebackground='#cecfcb',command=Cencell)
                                                        btn3.place(x=461,y=3,width=45,height=33)
                                                        #word.after(1000,shop)
                                                    elif(运行==1 and name==''):
                                                        #print(弹窗_提示窗)
                                                        if 弹窗_提示窗==[1,0]:
                                                            弹窗 = Tk()
                                                            弹窗.title("便利贴 OFFICE【PET/7.V.v】")
                                                            弹窗.attributes('-topmost',  True)
                                                            # 使用 ttk 创建一个框架 
                                                            frame = ttk.Frame(弹窗, padding="10 10 10 10")
                                                            frame.pack(fill="both",  expand=True)
                                                             
                                                            # 添加一个标签 
                                                            label = ttk.Label(frame, text="便利贴 OFFICE",font=("微软雅黑",13,"bold"))
                                                            label.place(x=3,y=1)
                                                            label2=tk.Label(frame,text=f"提醒:您当前还未登录自己的账户",font=("微软雅黑",12),fg='#FF6A6A')
                                                            label2.place(x=3,y=38)
                                                            
                                                            def OK():
                                                                 弹窗.destroy()
                                                                 close()
                                                                 账户()
                                                            def on_closing():
                                                                        pass  # 不执行任何操作，阻止关闭 
                                                                     
                                                            def Cencel():
                                                                global 频道
                                                                弹窗.destroy()
                                                                频道='00'
                                                                切换()
                                                                return
                                                            弹窗.protocol("WM_DELETE_WINDOW",  on_closing)

                                                            btn1=ttk.Button(frame,text="前往登录",comman=OK)
                                                            btn1.place(x=3,y=160,height=36,width=167)
                                                            btn2=ttk.Button(frame,text="不了,谢谢",comman=Cencel)
                                                            btn2.place(x=171,y=160,height=36,width=167)
                                                            # 设置窗口的初始位置（右下角坐标）
                                                            def place_window_to_bottom_right(root, window_width=360, window_height=220):
                                                                                # 获取屏幕的宽度和高度
                                                                                screen_width = root.winfo_screenwidth()
                                                                                screen_height = root.winfo_screenheight()

                                                                                # 计算窗口左上角的坐标
                                                                                x_coordinate = screen_width - window_width - 24  # 从右侧留出一点空间
                                                                                y_coordinate = screen_height - window_height - 94  # 从底部留出一点空间（考虑到任务栏）

                                                                                # 设置窗口的大小和位置
                                                                                弹窗.geometry(f"{window_width}x{window_height}+{x_coordinate}+{y_coordinate}")
                                                                               # 使用函数将窗口放置到右下角
                                                            place_window_to_bottom_right(弹窗)
                                                        else:
                                                            response = messagebox.askyesno("便利贴 OFFICE", "您当前还未登录自己的账户,需要前往登录吗？")
                                                            if response:
                                                                #print("用户选择了是")
                                                                
                                                                close()
                                                                账户()
                                                            else:
                                                                global 频道
                                                                
                                                                频道='00'
                                                                切换()
                                                                

                                                                                            
                                                    
                                                        
                                                except Exception as e:
                                                    # 打印错误信息和行号
                                                    tb = traceback.extract_tb(sys.exc_info()[2])
                                                    error_message = f"{e} (line {tb[-1].lineno})"
                                                    print(f"报错: {error_message}")






                                            '''窗口设置'''
                                            '''弹窗设置'''
                                            
                                                                
                                            默认提示='窗口位置(默认自动)'
                                            默认弹窗='提示窗口样式(弹窗)'
                                            #global 弹窗_提示窗
                                            name=姓名
                                            备份b=''
                                            if(name!=''):
                                                with(open(name+'主控记录.rtf','r'))as ff:
                                                    a=ff.readlines()
                                                    cc=''
                                                    c=''
                                                    检测备份_文本=''
                                                    ccc=1
                                                    for i in range(len(a)-1,-1,-1):
                                                        b=a[-(i+1)]
                                                        #print(b)
                                                        备份b=b
                                                        #b=b.split(',')
                                                        try:
                                                            备份b=备份b.split('/&&')
                                                        except:
                                                            检测备份_文本=备份b

                                                        else:
                                                            cc=b
                                                            cc=b+检测备份_文本
                                                            cc=cc.split(',')
                                                            cc=cc[3]
                                                            cc=cc.split('事件:')
                                                            cc=cc[1]
                                                            检测备份_文本=''
                                                            

                                                        #print('cc1:'+cc)
                                                        if(cc=='设置[调整窗口位置{自动}]'):
                                                           ccc=1
                                                        elif(cc=='设置[调整窗口位置{最前}]'):
                                                            ccc=2
                                                        elif(cc=='设置[调整窗口位置{最后}]'):
                                                            ccc=3
                                                        
                                                    if(ccc==1):
                                                        默认提示='窗口位置(默认自动)'
                                                        word.attributes('-topmost',  False)
                                                        
                                                    elif(ccc==2):
                                                        默认提示='窗口位置(最前)'
                                                        word.attributes('-topmost',  True)
                                                        #print('最前\n\n')
                                                       
                                                      
                                                    elif(ccc==3):
                                                        默认提示='窗口位置(最后)'
                                                        word.lower()
                                                    
                                                        
                                                      
                                                        
                                                    cc=''
                                                    c=''
                                                    检测备份_文本=''
                                                    for i in range(len(a)-1,-1,-1):
                                                        b=a[-(i+1)]
                                                        #print(b)
                                                        备份b=b
                                                        #b=b.split(',')
                                                        try:
                                                            备份b=备份b.split('/&&')
                                                        except:
                                                            检测备份_文本=备份b

                                                        else:
                                                            cc=b
                                                            cc=b+检测备份_文本
                                                            cc=cc.split(',')
                                                            cc=cc[3]
                                                            cc=cc.split('事件:')
                                                            cc=cc[1]
                                                            检测备份_文本=''

                                                        #print('cc:'+cc)  
                                                        if(cc=='设置[提示窗口样式(弹窗)]'):
                                                            ccc=1
                                                        elif(cc=='设置[提示窗口样式(提示窗)]'):
                                                            ccc=2
                                                    if(ccc==1):
                                                            默认提示='提示窗口样式(弹窗)'
                                                            弹窗_提示窗=[1,0]
                                                            
                                                    elif(ccc==2):
                                                            默认提示='提示窗口样式(提示窗)'
                                                            弹窗_提示窗=[0,1]
                                                            
                                                      
                                            else:
                                                默认提示='窗口位置(默认自动)'
                                            
                                       
                                                    
                                            def 历史():
                                                nonlocal 切换_List,默认提示,默认弹窗
                                                global 姓名,频道,z_color
                                                nonlocal v_scrollbar
                                                name=姓名
                                                uuser = Account1(姓名, '1', "设置{正操作}", "操作:06运行{设置生成代码}")
                                                uuser.record_history()
                                                
                                                频道='03'
                                                if(切换_List[2]==1):
                                                    return
                                                切换_List[2]=1
                                                切换()
                                                
                                                word.geometry('740x417')
                                                txt_edit.config(width=45)
                                                label_盖住=tk.Label(text='                                                                             \n                                                                             \n                                                                             \n                                                                             \n                                                                             \n                                                                             \n                                                                             \n                                                                             \n                                                                             \n                                                                             \n                                                                             \n                                                                             \n                                                                             \n                                                                             \n                                                                             \n                                                                             \n                                                                             \n                                                                             \n                                                                             \n                                                                             \n                                                                             \n                                                                             \n                                                                             \n                                                                             \n                                                                           \n                                                                             \n                                                                      \n                                                                            \n')
                                                label_盖住.place(x=457,y=0)
                                                v_scrollbar.destroy()
                                                v_scrollbar = tk.Scrollbar(word, orient=tk.VERTICAL, command=txt_edit.yview)
                                                v_scrollbar.pack(side=tk.RIGHT, fill=tk.Y)
                                                txt_edit.config(yscrollcommand=v_scrollbar.set)


                                                
                                                style=ttk.Style()
                                                style.configure('m.TButton',font=('微软雅黑',12))
                                                style=ttk.Style()
                                                style.configure('n.TButton',font=('微软雅黑',9))
                                                

                                                label1=ttk.Label(word,text='设置',font=('幼圆',13,'bold'))
                                                label1.place(x=505,y=7)

                                                label2=ttk.Label(word,text='搜索',font=('微软雅黑',11))
                                                label2.place(x=467,y=53)



                                                #搜索
                                                def 历史记录():
                                                    global 姓名
                                                    name=姓名
                                                    uuser = Account1(姓名, '1', "设置{正浏览历史记录}", "操作:06运行{输出浏览记录代码}")
                                                    uuser.record_history()
                                                    历史记录=[]
                                                    历史=tk.Tk()
                                                    历史.title('OFFICE 历史记录')
                                                    历史.geometry('370x270')
                                                    label=ttk.Label(历史,text='历史记录',font=("幼圆",11,'bold'))
                                                    label.place(x=4,y=10)
                                                    entry11=ttk.Entry(历史,font=('微软雅黑',9))
                                                    entry11.place(x=123,y=6,height=29,width=150)
                                                    entry11.insert(0,'搜索历史记录')
                                                    entry11.bind('<Button-1>',  lambda e: entry11.delete(0,  tk.END))
                                                    def entry():
                                                        nonlocal 历史记录
                                                        global 姓名
                                                        
                                                        text.delete('1.0',tk.END)
                                                        if(entry11.get()==''):
                                                            with(open(name+'主控记录.rtf','r'))as ff:
                                                                a=ff.readlines()
                                                                for i in range(len(a)-1,-1,-1):
                                                                    b=a[-(i+1)]
                                                                    b=b.split(',')
                                                                    c=b[3]
                                                                    c=c.split('事件:')
                                                                    c=c[1]
                                                                    d=b[0]
                                                                    d=d.split('时间')
                                                                    d=d[1]
                                                                    历史记录.append(d+', '+c+'\n')
                                                            
                                                                for j in range(len(历史记录)-1,-1,-1):
                                                                    text.insert(tk.END,历史记录[j])
                                                        else:
                                                            uuser = Account1(姓名, '1', f"设置(正搜索历史记录:{entry11.get()})", "操作:06运行{输出搜索代码}")
                                                            uuser.record_history()
                                                            for i in range(len(历史记录)-1,-1,-1):
                                                                if(entry11.get() in 历史记录[i]):
                                                                
                                                                    text.insert(tk.END,历史记录[i]+'\n')
                                                    btn1=ttk.Button(历史,text='搜索',command=entry)
                                                    btn1.place(x=275,y=8,width=50)
                                                    text=tk.Text(历史,height=64,width=181)
                                                    text.place(x=3,y=43)
                                                    
                                                    with(open(name+'主控记录.rtf','r'))as ff:
                                                        a=ff.readlines()
                                                        for i in range(len(a)-1,-1,-1):
                                                            b=a[-(i+1)]
                                                            b=b.split(',')
                                                            c=b[3]
                                                            c=c.split('事件:')
                                                            c=c[1]
                                                            d=b[0]
                                                            d=d.split('时间')
                                                            d=d[1]
                                                            历史记录.append(d+', '+c+'\n\n')
                                                        for j in range(len(历史记录)-1,-1,-1):
                                                            text.insert(tk.END,历史记录[j])

                                                btn_历史=ttk.Button(word,text='历史记录',style='n.TButton',command=历史记录)
                                                btn_历史.place(x=465,y=83,height=28,width=80)
                                                if 姓名=='':
                                                    btn_历史.config(state='disabled')
                                                
                                                def fast():
                                                    global 姓名
                                                    name=姓名
                                                    uuser = Account1(姓名, '1', "设置{正浏览快捷单}", "操作:06运行{输出快捷单代码}")
                                                    uuser.record_history()
                                                    快捷键=[]
                                                    历史=tk.Tk()
                                                    历史.title('OFFICE 快捷单')
                                                    历史.geometry('370x270')
                                                    label=ttk.Label(历史,text='快捷单',font=("幼圆",11,'bold'))
                                                    label.place(x=4,y=10)
                                                    entry11=ttk.Entry(历史,font=('微软雅黑',9))
                                                    entry11.place(x=123,y=6,height=29,width=150)
                                                    entry11.insert(0,'搜索快捷方式')
                                                    entry11.bind('<Button-1>',  lambda e: entry11.delete(0,  tk.END))
                                                    
                                                    text=tk.Text(历史,height=63,width=181)
                                                    text.place(x=3,y=43)
                                                    c='文件\n\n'
                                                    a='新建文本文档             Ctrl+n\n\n新建标签文档             Ctrl+Shift+N\n\n新建标签                 Ctrl+n\n\n新建提示标签             Ctrl+Shift+N\n\n打开                     Ctrl+o\n\n保存                     Ctrl+s\n\n保存                     Ctrl+s\n\n另存为                   Ctrl+Shift+s\n\n撤回                     Ctrl+z\n\n\n'
                                                    d='编辑\n\n'
                                                    e='剪切                     Ctrl+x\n\n复制                     Ctrl+c\n\n粘贴                     Ctrl+v\n\n全选                     Ctrl+a\n\n录入                     Ctrl+j\n\n模板                     Ctrl+m\n\n\n'
                                                    g='辅助\n\n'
                                                    h='文件管理                 Alt+w\n\n缓存清理                 Alt+q\n\n计算器                   Alt+j\n\n时钟                     Alt+t'

                                                    ss=a+e+g
                                                    ss=ss.split('\n')
                                                    快捷键=ss
                                             
                                                    text.insert(tk.END,c+a+d+e+g+h)
                                                  
                                                    def entry():
                                                        nonlocal 快捷键
                                                        global 姓名
                                                        
                                                        text.delete('1.0',tk.END)
                                                        if(entry11.get()==''):
                                                            c='文件\n\n'
                                                            a='新建标签                 Ctrl+n\n\n新建提示标签             Ctrl+Shift+n\n\n打开                     Ctrl+o\n\n保存                     Ctrl+s\n\n保存                     Ctrl+s\n\n另存为                   Ctrl+Shift+s\n\n撤回                     Ctrl+z\n\n\n'
                                                            d='编辑\n\n'
                                                            e='剪切                     Ctrl+x\n\n复制                     Ctrl+c\n\n粘贴                     Ctrl+v\n\n全选                     Ctrl+a\n\n录入                     Ctrl+j\n\n模板                     Ctrl+m\n\n\n'
                                                            g='辅助\n\n'
                                                            h='文件管理                 Alt+w\n\n缓存清理                 Alt+q\n\n计算器                   Alt+j\n\n时钟                     Alt+t'

                                                            ss=a+e+g
                                                            ss=ss.split('\n')
                                                            快捷键=ss
                                                     
                                                            text.insert(tk.END,c+a+d+e+g+h)
                                                        else:
                                                            uuser = Account1(姓名, '1', f"设置(正搜索快捷方式:{entry11.get()})", "操作:06运行{输出搜索代码}")
                                                            uuser.record_history()
                                                            for i in range(len(快捷键)):
                                                                if(entry11.get() in 快捷键[i]):
                                                                
                                                                    text.insert(tk.END,快捷键[i]+'\n\n')
                                                    btn1=ttk.Button(历史,text='搜索',command=entry)
                                                    btn1.place(x=275,y=8,width=50)
                                                               
                                                btn2=ttk.Button(word,text='快捷键',style='n.TButton',command=fast)
                                                btn2.place(x=465,y=117,height=28,width=80)
                                                label3=ttk.Label(word,text='AI',font=('微软雅黑',12))
                                                label3.place(x=467,y=160)







                                                #AI设置
                                                def on_slider_move(event):
                                                    nonlocal last_position
                                                    nonlocal 放行,a,PETAI
                                                    nonlocal 运行
                                                    
                                                    current_position = slider.get()
                                                    
                                                    if last_position > current_position:
                                                        uuser = Account1(姓名, '1', f"设置(关闭Calendar AI对话模式)", "操作:06运行{AI关闭待机代码}")
                                                        uuser.record_history()
                                                    
                                                   
                                                    elif last_position < current_position:
                                                        uuser = Account1(姓名, '1', f"设置(开启Calendar AI对话模式)", "操作:06运行{AI启动待机代码}")
                                                        uuser.record_history()
                                                        
                                                    last_position = current_position
                                                
                                                slider = tk.Scale(word, from_=0, to=1, orient=tk.HORIZONTAL, length=74)
                                                label_关=ttk.Label(word,text='关闭')
                                                label_关.place(x=465,y=223)
                                                label_启=ttk.Label(word,text='启动')
                                                label_启.place(x=515,y=223)
                                                if(name!=''):
                                                    with(open(name+'账本.rtf','r'))as fff:
                                                        aa=fff.readlines()
                                                        for i in range(len(aa)):
                                                            b=aa[-(i+1)]
                                                            b=b.split(',')
                                                            c=b[3]
                                                            #print(c)
                                                            if(c=='虚拟物品:calendar AI/&&\n'):
                                                                
                                                                slider = tk.Scale(word, from_=0, to=1, orient=tk.HORIZONTAL, length=74)
                                                    
                                                                slider.bind("<B1-Motion>", on_slider_move)

                                                                slider.place(x=465,y=177)
                                                                slider.config(state="normal")
                                                                with(open(name+'主控记录.rtf','r'))as ff:
                                                                            a=ff.readlines()
                                                                            cc=''
                                                                            c=''
                                                                            ccc=1
                                                                            检测备份_文本=''
                                                                            for i in range(len(a)-1,-1,-1):
                                                                                b=a[-(i+1)]
                                                                                #print(b)
                                                                                备份b=b
                                                                                #b=b.split(',')
                                                                                try:
                                                                                    备份b=备份b.split('/&&')
                                                                                except:
                                                                                    检测备份_文本=备份b

                                                                                else:
                                                                                    cc=b
                                                                                    cc=b+检测备份_文本
                                                                                    cc=cc.split(',')
                                                                                    cc=cc[4]
                                                                                    
                                                                                    cc=cc.split('操作:')
                                                                                    cc=cc[1]
                                                                                    #print(cc)
                                                                                    检测备份_文本=''
                                                                                if(cc=='06运行{AI关闭待机代码}/&&\n'):
                                                                                    ccc=1
                                                                                elif(cc=='06运行{AI启动待机代码}/&&\n'or cc=='07自动操作{AI启动待机代码}/&&\n'):
                                                                                    ccc=2
                                                                              
                                                                                
                                                                            if(ccc==1):
                                                                                关闭=1
                                                                                
                                                                            elif(ccc==2):
                                                                                关闭=0
                                                                                
                                                                                
                                                                break
                                                            else:
                                                              
                                                                关闭=1
                                                                
                                                                slider.config(state="disabled")
                                                                break
                                                    if(关闭==1):
                                                        last_position = 0  # 初始位置
                                                    else:
                                                        last_position = 1  # 初始位置

                                                else :
                                                    last_position=0
                                            
                                                    slider = tk.Scale(word, from_=0, to=1, orient=tk.HORIZONTAL, length=74)
                                                    
                                                    slider.bind("<B1-Motion>", on_slider_move)

                                                    slider.place(x=510,y=177)
                                                    label_关.config(text='关闭')
                                                    
                                                    label_启.config(text='启动')
                                            
                                                    btn1.config(state='disabled')
                                                    slider.config(state="disabled")
                                                    
                                                
                                                slider.set(last_position)
                                                slider.bind("<B1-Motion>", on_slider_move)

                                                slider.place(x=465,y=177)
                                                
                                                








                                                #窗口部署
                                                '''窗口位置'''
                                                def handle_selection2(event):
                                                    global 姓名
                                                    name=姓名
                                                    selected_value = combobox2.get()
                                                    if selected_value == "默认自动":
                                                            combobox2.set("窗口位置(默认自动)")  # 设置默认提示文本
                                                            word.attributes('-topmost',  False)
                                                            if(name!=''):
                                                                userr=Account1(name,'1','设置[调整窗口位置{自动}]','操作:08编辑{更调窗口位置}')
                                                                userr.record_history()

                                                                
                                                    if selected_value == "最前":
                                                        combobox2.set("窗口位置(最前)")  # 设置默认提示文本
                                                        word.attributes('-topmost',  True)
                                                        if(name!=''):
                                                                userr=Account1(name,'1','设置[调整窗口位置{最前}]','操作:08编辑{更调窗口位置}')
                                                                userr.record_history()

                                                                
                                                    if selected_value == "最后":
                                                        combobox2.set("窗口位置(最后)")  # 设置默认提示文本
                                                        word.lower()
                                                        if(name!=''):
                                                                userr=Account1(name,'1','设置[调整窗口位置{最后}]','操作:08编辑{更调窗口位置}')
                                                                userr.record_history()
                                                                
                                                默认提示='窗口位置(默认自动)'
                                                if(name!=''):
                                                    with(open(name+'主控记录.rtf','r'))as ff:
                                                        a=ff.readlines()
                                                        cc=''
                                                        c=''
                                                        检测备份_文本=''
                                                        ccc=1
                                                        for i in range(len(a)-1,-1,-1):
                                                            b=a[-(i+1)]
                                                            #print(b)
                                                            备份b=b
                                                            #b=b.split(',')
                                                            try:
                                                                备份b=备份b.split('/&&')
                                                            except:
                                                                检测备份_文本=备份b

                                                            else:
                                                                cc=b
                                                                cc=b+检测备份_文本
                                                                cc=cc.split(',')
                                                                cc=cc[3]
                                                                cc=cc.split('事件:')
                                                                cc=cc[1]
                                                                检测备份_文本=''
                                                                    
                                                                

                                                            if(cc=='设置[调整窗口位置{自动}]'):
                                                                ccc=1
                                                            elif(cc=='设置[调整窗口位置{最前}]'):
                                                                ccc=2
                                                            elif(cc=='设置[调整窗口位置{最后}]'):
                                                                ccc=3  
                                                        if(ccc==1):
                                                            默认提示='窗口位置(默认自动)'
                                                            word.attributes('-topmost',  False)
                                                            
                                                        elif(ccc==2):
                                                            默认提示='窗口位置(最前)'
                                                            word.attributes('-topmost',  True)
                                                            
                                                        elif(ccc==3):
                                                            默认提示='窗口位置(最后)'
                                                            word.lower()
                                                            

                                                        
                                                else:
                                                    默认提示='窗口位置(默认自动)'
                                                            
                                                label6=ttk.Label(word,text='窗口部署',font=('微软雅黑',11))
                                                label6.place(x=575,y=48,height=38)
                                                options2 = ["最前",'默认自动','最后']
                                                combobox2 = ttk.Combobox(word, values=options2)
                                                combobox2.set(默认提示)  # 设置默认提示文本
                                                combobox2.bind("<<ComboboxSelected>>", handle_selection2)  # 绑定事件处理器
                                                combobox2.place(x=577,y=82,width=140,height=25)



                                                '''提示弹窗'''
                                                默认弹窗='提示窗口样式(弹窗)'
                                                def handle_selection3(event):
                                                    global 弹窗_提示窗,姓名
                                                    name=姓名
                                                    selected_value = combobox3.get()
                                                    print(1)
                                                    if selected_value == "提示窗口样式(弹窗)":
                                                            弹窗_提示窗=[1,0]
                                                            userr=Account1(name,'1','设置[提示窗口样式(弹窗)]','操作:08编辑{更调提示窗口模版}')
                                                            userr.record_history()
                                                    if selected_value == "提示窗口样式(提示窗)":
                                                            弹窗_提示窗=[0,1]
                                                            userr=Account1(name,'1','设置[提示窗口样式(提示窗)]','操作:08编辑{更调提示窗口模版}')
                                                            userr.record_history()
                                                global 弹窗_提示窗
                                                if(name!=''):
                                                    with(open(name+'主控记录.rtf','r'))as ff:
                                                        a=ff.readlines()
                                                        cc=''
                                                        c=''
                                                        检测备份_文本=''
                                                        for i in range(len(a)-1,-1,-1):
                                                            b=a[-(i+1)]
                                                            #print(b)
                                                            备份b=b
                                                            #b=b.split(',')
                                                            try:
                                                                备份b=备份b.split('/&&')
                                                            except:
                                                                检测备份_文本=备份b

                                                            else:
                                                                cc=b
                                                                cc=b+检测备份_文本
                                                                cc=cc.split(',')
                                                                cc=cc[3]
                                                                cc=cc.split('事件:')
                                                                cc=cc[1]
                                                                检测备份_文本=''
                                                                
                                                            if(cc=='设置[提示窗口样式(弹窗)]'):
                                                                ccc=1
                                                            elif(cc=='设置[提示窗口样式(提示窗)]'):
                                                                ccc=2
                                                        if(ccc==1):
                                                                默认提示='提示窗口样式(弹窗)'
                                                                弹窗_提示窗=[1,0]
                                                                
                                                        elif(ccc==2):
                                                                默认提示='提示窗口样式(提示窗)'
                                                                弹窗_提示窗=[0,1]
                                                               

                                                            
                                                            
                                                else:
                                                    默认弹窗='提示窗口样式(弹窗)'

                                                options3 = ['提示窗口样式(弹窗)','提示窗口样式(提示窗)']
                                                combobox3 = ttk.Combobox(word, values=options3)
                                                combobox3.set(默认提示)  # 设置默认提示文本
                                                combobox3.bind("<<ComboboxSelected>>", handle_selection3)  # 绑定事件处理器
                                                combobox3.place(x=577,y=115,width=140,height=25)
                                                def 返回():
                                                      global 频道
                                                      
                                                      
                                                      btn2.destroy()
                                            
                                                      btn3.destroy()
                                                      label_盖住.destroy()
                                                      combobox3.destroy()
                                                      combobox2.destroy()
                                                      label_启.destroy()
                                                      label_关.destroy()
                                                      label6.destroy()
                                                      label2.destroy()
                                                      slider.destroy()
                                                      label3.destroy()
                                                      btn2.destroy()
                                                      btn_历史.destroy()
                                                      label1.destroy()
                                                    
                                                  
                                                      频道='00'
                                                      
                                                      word.geometry('473x417')
                                                      切换()
                                                      return
                                      
                                                btn3=tkinter.Button(word,text="<返回",font=("微软雅黑",11),borderwidth=-1,fg='black',bg='#EDEDED',activebackground='#cecfcb',command=返回)
                                                btn3.place(x=461,y=3,width=45,height=33)











                                            def AI():
                                                    global 弹窗_提示窗,姓名
                                                    name=姓名
                                                    uuser = Account1(name, '1', "Calendar AI自动对话{状态:安慰}", "操作:08自动操作{检测状态}")
                                                    uuser.record_history()
                                                    c=''
                                                    if(name!=''):
                                                        with(open(name+'账本.rtf','r'))as f:     
                                                                a=f.readlines()
                                                                f.close()
                                                                for i in range(len(a)):
                                                                      b=a[-(i+1)]
                                                                      b=b.split(',')
                                                                      c=b[3]
                                                                    
                                                                      c=c.split('虚拟物品:')
                                                                     
                                                                      c=c[1]
                                                                      #print(c)
                                                                      if(c=='calendar AI/&&\n'):
                                                                           c=c
                                                                           break
                                                    if(c==''):
                                                        return
                                                        
                                                    if(弹窗_提示窗==[1,0]):
                                                        #print(1)
                                                        弹窗 = Toplevel(word)
                                                        弹窗.title("便利贴 OFFICE【PET/7.V.v】")
                                                        弹窗.attributes('-topmost',  True)
                                                        # 使用 ttk 创建一个框架 
                                                        frame = ttk.Frame(弹窗, padding="10 10 10 10")
                                                        frame.pack(fill="both",  expand= True)
                                                      
                                                     # 添加一个标签
                                                        image = Image.open('PET - 副本.png') 
                                                        
                                                       # 设置新的图像尺寸 
                                                        new_width = 120 
                                                        new_height = 130 
                                                        
                                                       # 调整图像大小，使用高质量的重采样方法 
                                                        resized_image = image.resize((new_width,  new_height), Image.LANCZOS)
                                                        
                                                       # 保存调整大小后的图像 
                                                        resized_image.save('PET - 副本.png') 
                                                        image_path = "PET - 副本.png" 
                                                        original_image = Image.open(image_path) 
                                                        photo2 = ImageTk.PhotoImage(original_image)
                                                        label3 = tk.Label(弹窗, image = photo2)
                                                        label3.image  = photo2  
                                                        label3.place(x=220,y=25)
                                                        
                                                        label = ttk.Label(frame, text="Calendar AI",font=("微软雅黑",13,"bold"))
                                                        label.place(x=3,y=1)
                                                        label2=ttk.Label(frame,text=f"我在这里,\n不要担心我始终陪着您",font=("微软雅黑",11))
                                                        label2.place(x=3,y=38)
                                                        def OK():
                                                    
                                                            弹窗.destroy()
                                                            
                                                               

                                                        btn1=ttk.Button(frame,text="OK",comman=OK)
                                                        btn1.place(x=3,y=160,height=36,width=334)
                                                          # 设置窗口的初始位置（右下角坐标）
                                                        def on_closing():
                                                                     pass  # 不执行任何操作，阻止关闭 
                                                                  
                                                                 
                                                        弹窗.protocol("WM_DELETE_WINDOW",  on_closing)
                                                        def place_window_to_bottom_right(root, window_width=360, window_height=220):
                                                                            # 获取屏幕的宽度和高度
                                                                            screen_width = root.winfo_screenwidth()
                                                                            screen_height = root.winfo_screenheight()

                                                                            # 计算窗口左上角的坐标
                                                                            x_coordinate = screen_width - window_width - 24  # 从右侧留出一点空间
                                                                            y_coordinate = screen_height - window_height - 94  # 从底部留出一点空间（考虑到任务栏）

                                                                            # 设置窗口的大小和位置
                                                                            弹窗.geometry(f"{window_width}x{window_height}+{x_coordinate}+{y_coordinate}")
                                                                           # 使用函数将窗口放置到右下角
                                                        place_window_to_bottom_right(弹窗)

                                                        PETAI=[0,1,0]
                                                    else:
                                               
                                                          tkinter. messagebox.showinfo("Calendar AI",f"我在这里,\n不要担心我始终陪着您")
                                                     
                                            






                                            '''简历初始按钮'''
                                            if(姓名==""):
                                                姓名=""
                                                btn1=ttk.Button(word,text="登录",command=简历)
                                                btn1.place(x=0,y=50,width=46,height=30)
                                                登录=1
                                            else:
                                                登录=0
                                              
                                                truncated_name=''
                                                def truncate_name(姓名):
                                                    
                                                    if len(姓名) > 2:
                                                        return 姓名[:2] + '...'
                                                    else:
                                                        return 姓名

                                                
                                                    # 截断名字
                                                truncated_name = truncate_name(姓名)
                                                
                                                    
                                                btn1=ttk.Button(word,text=truncated_name,command=简历)
                                                btn1.place(x=0,y=50,width=46,height=30)

                                            
                                            
                                            def 切换():
                                                global 频道
                                                nonlocal 切换_List
                                                if(频道=='03'):
                                                    btn15.config(state='disabled')
                                                    btn1.config(state='disabled')
                                                    btn16.config(state='normal')
                                                    btn17.config(state='disabled')
                                                    
                                                elif(频道=='01'):
                                                    btn15.config(state='normal')
                                                    btn1.config(state='disabled')
                                                    btn16.config(state='disabled')
                                                    btn17.config(state='disabled')
                                                elif(频道=='02' ):
                                                    btn15.config(state='disabled')
                                                    btn1.config(state='normal')
                                                    btn16.config(state='disabled')
                                                    btn17.config(state='disabled')
                                                elif(频道=='00'):
                                                    切换_List=[0,0,0,0]
                                                    btn17.config(state='normal')
                                                    btn16.config(state='normal')
                                                    btn15.config(state='normal')
                                                    btn1.config(state='normal')

                                            def 新建():
                                                global 姓名
                                                name=姓名
                                                wor=tk.Tk()
                                                wor.geometry('300x230')
                                                wor.title('新建标签-便利贴 OFFICE【7.V.v】')
                                                wor.resizable(True, False)
                                                wor.configure(bg='#fff0a7')
                                                wor.attributes('-topmost',  True)

                                                uuser = Account1(name, '1', "[便利贴]生成便利贴", "操作:06运行{[便利贴]生成便利贴组件代码}")
                                                uuser.record_history()

                                                # 创建菜单栏
                                                menu_bar = tk.Menu(wor)
                                                edit_menu = tk.Menu(menu_bar, tearoff=0)

                                                def save_as():
                                                    global 文本
                                                    nonlocal 旬报
                                                    global 姓名
                                                    name=姓名
                                                    
                                                    global 文本 
                                                    file_path = filedialog.asksaveasfilename(defaultextension=".json",  filetypes=[("Text Files", "*.txt"), ("All Files", "*.*"), ("RTF Document", "*.rtf")])
                                                    if file_path:
                                                        文本 = file_path
                                                        save()
                                                    旬报=txt_editt.get('1.0',tk.END)
                                                    文本 = os.path.basename(文本) 
                                                    if(文本!=""):
                                                        wor.title(文本+"-便利贴 OFFICCE【PET/7.V.v】")
                                                    uuser = Account1(name, '1', "[便利贴]另存标签文件:"+str(文本), "操作:10文件{[便利贴]重命名文件并定义格式}")
                                                    uuser.record_history()
                                                    
                                                def save():
                                                    global 文本 
                                                    global 旬报
                                                    global 姓名
                                                    name=姓名
                                                   
                                                 
                                                    if 文本 != "":
                                                        try:
                                                            # 获取文本内容 
                                                            content = txt_editt.get('1.0',  tk.END).strip()
                                                            
                                                            # 获取文本格式信息 
                                                            format_info = []
                                                            for tag in txt_editt.tag_names(): 
                                                                ranges = txt_editt.tag_ranges(tag) 
                                                                while ranges:
                                                                    start = ranges[0]
                                                                    end = ranges[1]
                                                                    format_info.append({ 
                                                                        "tag": tag,
                                                                        "start": str(start),
                                                                        "end": str(end),
                                                                        "config": txt_editt.tag_cget(tag,  "font"),
                                                                        "color": txt_editt.tag_cget(tag,  "foreground")
                                                                    })
                                                                    ranges = ranges[2:]
                                                 
                                                            # 创建一个包含文本内容和格式信息的字典
                                                            data = {
                                                                "content": content,
                                                                "format_info": format_info
                                                            }
                                                 
                                                            # 将数据保存到文件
                                                            with open(文本, 'w', encoding='utf-8') as file:
                                                                json.dump(data,  file, ensure_ascii=False, indent=4)
                                                 
                                                            旬报 = content
                                                            文本 = os.path.basename(文本) 
                                                            wor.title( 文本 + "-便利贴 OFFICE【PET/7.V.v】")
                                                            uuser = Account1(name, '1', "[便利贴]保存标签文件:"+str(文本), "操作:10文件{[便利贴]重命名文件/定义格式}")
                                                            uuser.record_history()
                                                        except Exception as e:
                                                            tb = traceback.extract_tb(sys.exc_info()[2]) 
                                                            error_message = f"{e} (line {tb[-1].lineno})"
                                                            print(f"报错: {error_message}")
                                                            messagebox.showerror(" 保存失败", f"保存文件时发生错误: {error_message}")
                                                    else:
                                                        save_as()
                                                def new_bq():
                                                    global 文本
                                                    nonlocal 旬报
                                                    global 姓名
                                                    name=姓名
                                                    wor.geometry('300x230')
                                                    txt_editt.config(font=('微软雅黑',11),height=9)
                                                    txt_editt.config(state=tk.NORMAL) 
                                                    try:
                                                        txt_editt.config(state=tk.NORMAL) 
                                                        if(txt_editt.get('1.0',  tk.END)!=旬报):
                                                            response = messagebox.askyesno(" 确认", "需要保存原文件吗？") 
                                                            if response: 
                                                                save()
                                                            
                                                        # 无论是否保存原文件，都清空文本框内容并更新窗口标题 
                                                        txt_editt.delete('1.0',  tk.END)
                                                        旬报=txt_editt.get('1.0',tk.END)
                                                        wor.title(" 新建标签-便利贴 OFFICE【PET/7.V.v】")
                                                        文本 = os.path.basename(文本) 
                                                        uuser = Account1(name, '1', "[便利贴]新建标签:"+str(文本), "操作:10文件{[便利贴]生成新文档}")
                                                        uuser.record_history()
                                                    except Exception as e:
                                                            # 打印错误信息和行号
                                                            tb = traceback.extract_tb(sys.exc_info()[2])
                                                            error_message = f"{e} (line {tb[-1].lineno})"
                                                            print(f"报错: {error_message}")
                                           
                                                    
                                                    
                                                def dak():
                                                    global 文本,a
                                                    nonlocal 旬报
                                                    global 姓名
                                                    name=姓名
                                                    try:
                                                        uuser = Account1(name, '1', "[便利贴]打开文件标签{正选择}", "操作:10文件{[便利贴]读取文本文档}")
                                                        uuser.record_history()
                                                        if(txt_editt.get('1.0',  tk.END)!=旬报):
                                                            response = messagebox.askyesno("确认", "需要保存原文件吗？")
                                                            if response:
                                                                #print("用户选择了是")
                                                                with(open(文本,"w",encoding='utf-8')) as file:
                                                                    file.write(txt_edit.get('1.0',tk.END))
                                                                    txt_editt.delete('1.0',tk.END)
                                                        
                                                        #文本对话框打开模式
                                                        def load():
                                                            global 文本
                                                            file_path = filedialog.askopenfilename(filetypes=[("Text Files", "*.txt"), ("All Files", "*.*"), ("RTF Document", "*.rtf")])
                                                            if file_path:
                                                                try:
                                                                    with open(file_path, 'r', encoding='utf-8') as file:
                                                                        data = json.load(file) 
                                                                        content = data.get("content",  "")
                                                                        format_info = data.get("format_info",  [])
                                                         
                                                                        # 清空文本框
                                                                        txt_editt.delete('1.0',  tk.END)
                                                         
                                                                        # 插入文本内容
                                                                        txt_editt.insert(tk.END,  content)
                                                         
                                                                        # 恢复格式
                                                                        for info in format_info:
                                                                            tag = info["tag"]
                                                                            start = info["start"]
                                                                            end = info["end"]
                                                                            config = info.get("config",  "Arial 12")
                                                                            color = info.get("color",  "black")
                                                         
                                                                            # 配置标签
                                                                            txt_edit.tag_configure(tag,  font=config, foreground=color)
                                                                            txt_edit.tag_add(tag,  start, end)
                                                         
                                                                        文本 = file_path
                                                                        文本 = os.path.basename(文本) 
                                                                        wor.title( 文本 + "-便利贴 OFFICE【PET/7.V.v】")
                                                                        uuser = Account1(name, '1', "打开文件标签{选择完毕}", "操作:10文件{[便利贴]输出文本内容}")
                                                                        uuser.record_history()
                                                                        
                                                                except Exception as e:
                                                                    tb = traceback.extract_tb(sys.exc_info()[2]) 
                                                                    error_message = f"{e} (line {tb[-1].lineno})"
                                                                    print(f"报错: {error_message}")
                                                                    messagebox.showerror(" 加载失败", f"加载文件时发生错误: {error_message}")
                                                         
                                                        load()
                                                        
                                                       
                                                        旬报=txt_editt.get('1.0',tk.END)
                                                    except Exception as e:
                                                            # 打印错误信息和行号
                                                            tb = traceback.extract_tb(sys.exc_info()[2])
                                                            error_message = f"{e} (line {tb[-1].lineno})"
                                                            print(f"报错: {error_message}")
                                                
                                                def close():
                                                    
                                                    global 文本, a, 姓名 
                                                    nonlocal 旬报, 工作时长, 工作判,分,秒,时,提示标签
                                                    name=姓名
                                                    try:
                                                        if 姓名 != "":
                                                        # 当前工作时长 
                                                            时 = int(工作时长[0])
                                                            分 = int(工作时长[1])
                                                            秒 = int(工作时长[2])
                                                            timee=时+分+秒
                                                            f=open(name+'.rtf','r')
                                                            a=f.readlines()
                                                            b=a[-1]
                                                            b=b.split(',')
                                                            c=b[2]
                                                            c=c.split('当前资金:')
                                                            c=c[1]
                                                            c=list(c)
                                                            if(len(c)==1):
                                                                c=[0,'时',0,'分',0,'秒']
                                                            i=0
                                                     
                                                            pw=b[1]
                                                            pw=pw.split('密码:')
                                                            
                                                            pw=pw[1]
                                                        
                                                            
                                                            import re 
         
                                                            def extract_time_units(lst):
                                                                # 将列表转换为字符串 
                                                                lst_str = ''.join(map(str, lst))
                                                                
                                                                # 使用正则表达式匹配数字和单位 
                                                                pattern = r'(\d+)(时|分|秒)'
                                                                matches = re.findall(pattern,  lst_str)
                                                                
                                                                # 初始化变量 
                                                                时时 = None 
                                                                分分 = None 
                                                                秒秒 = None 
                                                                
                                                                # 处理匹配结果 
                                                                for match in matches:
                                                                    value, unit = match 
                                                                    if unit == '时':
                                                                        时时 = int(value)
                                                                    elif unit == '分':
                                                                        分分 = int(value)
                                                                    elif unit == '秒':
                                                                        秒秒 = int(value)
                                                                
                                                                return 时时, 分分, 秒秒 
                                                             
                                                            # 示例列表 
                                                            my_list =c                                                     
                                                            # 提取时间单位 
                                                            时时, 分分, 秒秒 = extract_time_units(my_list)
                                                        


                                                            时=时+int(时时)
                                                            分=int(分分)+分
                                                            秒=int(秒秒)+秒
                                                            if(秒>59):
                                                                秒-=60
                                                                分+=1
                                                            if(分>59):
                                                                分-=60
                                                                时+=1
                                                                
                                                            timme=str(时)+"时"+str(分)+"分"+str(秒)+"秒"
                                                            工作时长[0]=时
                                                            工作时长[1]=分
                                                            工作时长[2]=秒
                                                            shenfen = "用户"
                                                            
                                                                

                                                            tongy="1"
                                                            uuser = Account1(姓名, tongy, "[便利贴]退出登录", "操作:06运行{[便利贴]关闭便利贴窗口代码}")
                                                            uuser.record_history()



                                                            # 创建 Account 对象并记录
                                                            user = Account(name, pw,timme , "退出登录", shenfen)
                                                            user.record()
                                                             
                                                        if(提示标签==0):
                                                            if txt_editt.get('1.0',  tk.END) != 旬报:
                                                                uuser = Account1(name, '1', "[便利贴]退出登录{正选择}", "操作:06运行{[便利贴]退出保存代码}")
                                                                uuser.record_history()
                                                                response = messagebox.askyesno(" 确认", "需要保存原文件吗？")
                                                                if response:
                                                                    save()
                                                        else:
                                                            worddd.destroy()
                                                               
                                                        
                                                    except Exception as e:
                                                        tb = traceback.extract_tb(sys.exc_info()[2]) 
                                                        error_message = f"{e} (line {tb[-1].lineno})"
                                                        print(f"报错: {error_message}")
                                                 
                                                    wor.destroy()
                                                    工作判 = False 
                                                    return 
                                                 
                                                # 绑定窗口关闭事件到自定义函数 
                                                wor.protocol("WM_DELETE_WINDOW",  close)

                                                
                                                #font_F=font.Font(family="等线 Light",size=11)
                                                last_state = word.wm_state()
                                                current_state = word.wm_state() 
                                                
                                                
                                                screen_width = word.winfo_screenwidth() 
                                                txt_editt=tk.Text(wor,width=int(screen_width  / 7)-53,height=9,font=('微软雅黑',11),bg='#fff7d0')
                                                txt_editt.place(x=3,y=36)
                                                #定义字体  size是字号   slant="italic"斜体   weight="normal"加粗
                                                

                                              
                                                 
                                                # 创建垂直滚动条并与文本编辑框关联
                                                v_scrollbar = tk.Scrollbar(wor, orient=tk.VERTICAL, command=txt_editt.yview) 
                                                v_scrollbar.pack(side=tk.RIGHT,  fill=tk.Y)
                                                txt_editt.config(yscrollcommand=v_scrollbar.set)

                                                #检测光标所在行数
                                                def update_cursor_line(event=None):
                                                    # 获取光标位置对应的文本索引
                                                    cursor_index = txt_editt.index("insert")
                                                    
                                                    # 解析出行号
                                                    line_number = int(cursor_index.split('.')[0])
                                                    
                                                    # 更新标签显示当前光标所在行数
                                                    line_label2.config(text=f"Ln: {line_number}")
                                                
                                                
                                                # 绑定事件以在光标移动时更新行数显示
                                                txt_editt.bind("<KeyRelease>", update_cursor_line)  # 键盘输入后更新
                                                txt_editt.bind("<ButtonRelease-1>", update_cursor_line)  # 鼠标点击后更新

                                                # 创建标签用于显示光标所在的行数
                                                line_label2 = tk.Label(wor, text="Ln: ",font=('微软雅黑',10),bg='#fff0a7')
                                                line_label2.place(x=208,y=3)
                                                # 初始化显示光标所在行数
                                                update_cursor_line()

                                                


                                                






                                                
                                               
                                                
                                                
                                                
                                                def redd():
                                                    global Font,ffont
                                                    global 姓名
                                                    name=姓名
                                                    uuser = Account1(name, '1', "[便利贴]调整字色{red}", "操作:08编辑{[便利贴]改变文本字色}")
                                                    uuser.record_history()
                                                    try:
                                                        start = txt_editt.index(tk.SEL_FIRST)
                                                        end = txt_editt.index(tk.SEL_LAST)

                                                        # 创建或更新名为 "red" 的 tag，指定前景色为红色
                                                        txt_editt.tag_config("red", foreground="#FF6A6A")

                                                        # 应用 "red" tag 到选定的文本范围
                                                        txt_editt.tag_add("red", start, end)
                                                    
                                                    except:
                                                        return
                                                def oranged():
                                                     
                                                    global Font,ffont
                                                    global 姓名
                                                    name=姓名
                                                    uuser = Account1(name, '1', "[便利贴]调整字色{orange}", "操作:08编辑{[便利贴]改变文本字色}")
                                                    uuser.record_history()
                                                    try:
                                                        start = txt_editt.index(tk.SEL_FIRST)
                                                        end = txt_editt.index(tk.SEL_LAST)

                                                        # 创建或更新名为 "red" 的 tag，指定前景色为红色
                                                        txt_editt.tag_config("red", foreground="#FF7F50")

                                                        # 应用 "red" tag 到选定的文本范围
                                                        txt_editt.tag_add("red", start, end)
                                                    
                                                    except:
                                                        return
                                                def yellowd():
                                                    global Font,ffont
                                                    global 姓名
                                                    name=姓名
                                                    uuser = Account1(name, '1', "[便利贴]调整字色{yellow}", "操作:08编辑{[便利贴]改变文本字色}")
                                                    uuser.record_history()
                                                    try:
                                                        start = txt_editt.index(tk.SEL_FIRST)
                                                        end = txt_editt.index(tk.SEL_LAST)

                                                        # 创建或更新名为 "red" 的 tag，指定前景色为红色
                                                        txt_editt.tag_config("red", foreground="#FFFF00")

                                                        # 应用 "red" tag 到选定的文本范围
                                                        txt_editt.tag_add("red", start, end)
                                                    
                                                    except:
                                                        return
                                                def greend():
                                                    global Font,ffont
                                                    global 姓名
                                                    name=姓名
                                                    uuser = Account1(name, '1', "[便利贴]调整字色{green绿}", "操作:08编辑{[便利贴]改变文本字色}")
                                                    uuser.record_history()
                                                    try:
                                                        start = txt_editt.index(tk.SEL_FIRST)
                                                        end = txt_editt.index(tk.SEL_LAST)

                                                        # 创建或更新名为 "red" 的 tag，指定前景色为红色
                                                        txt_editt.tag_config("red", foreground="#B5E61D")

                                                        # 应用 "red" tag 到选定的文本范围
                                                        txt_editt.tag_add("red", start, end)
                                                    
                                                    except:
                                                        return
                                                def blued():
                                                    global Font,ffont
                                                    global 姓名
                                                    name=姓名
                                                    uuser = Account1(name, '1', "[便利贴]调整字色{blue}", "操作:08编辑{[便利贴]改变文本字色}")
                                                    uuser.record_history()
                                                    try:
                                                        start = txt_editt.index(tk.SEL_FIRST)
                                                        end = txt_editt.index(tk.SEL_LAST)

                                                        # 创建或更新名为 "red" 的 tag，指定前景色为红色
                                                        txt_editt.tag_config("red", foreground="#3487FF")

                                                        # 应用 "red" tag 到选定的文本范围
                                                        txt_editt.tag_add("red", start, end)
                                                    
                                                    except:
                                                        return
                                                def purpled():
                                                    global Font,ffont
                                                    global 姓名
                                                    name=姓名
                                                    uuser = Account1(name, '1', "[便利贴]调整字色{purple}", "操作:08编辑{[便利贴]改变文本字色}")
                                                    uuser.record_history()
                                                    try:
                                                        start = txt_editt.index(tk.SEL_FIRST)
                                                        end = txt_editt.index(tk.SEL_LAST)

                                                        # 创建或更新名为 "red" 的 tag，指定前景色为红色
                                                        txt_editt.tag_config("red", foreground="#9B6CFF")

                                                        # 应用 "red" tag 到选定的文本范围
                                                        txt_editt.tag_add("red", start, end)
                                                    except:
                                                        return
                                                def blackd():
                                                    global Font,ffont
                                                    global 姓名
                                                    name=姓名
                                                    uuser = Account1(name, '1', "[便利贴]调整字色{black}", "操作:08编辑{[便利贴]改变文本字色}")
                                                    uuser.record_history()
                                                    try:
                                                        start = txt_editt.index(tk.SEL_FIRST)
                                                        end = txt_editt.index(tk.SEL_LAST)

                                                        # 创建或更新名为 "red" 的 tag，指定前景色为红色
                                                        txt_editt.tag_config("red", foreground="black")

                                                        # 应用 "red" tag 到选定的文本范围
                                                        txt_editt.tag_add("red", start, end)
                                                    except:
                                                        return
                                                def greyd():
                                                    global Font,ffont
                                                    global 姓名
                                                    name=姓名
                                                    uuser = Account1(name, '1', "[便利贴]调整字色{grey}", "操作:08编辑{[便利贴]改变文本字色}")
                                                    uuser.record_history()
                                                    try:
                                                        start = txt_editt.index(tk.SEL_FIRST)
                                                        end = txt_editt.index(tk.SEL_LAST)

                                                        # 创建或更新名为 "red" 的 tag，指定前景色为红色
                                                        txt_editt.tag_config("red", foreground="#B3B2B5")

                                                        # 应用 "red" tag 到选定的文本范围
                                                        txt_editt.tag_add("red", start, end)
                                                    
                                                    except:
                                                        return
                                                def whited():
                                                    global Font,ffont
                                                    global 姓名
                                                    name=姓名
                                                    uuser = Account1(name, '1', "[便利贴]调整字色{white}", "操作:08编辑{[便利贴]改变文本字色}")
                                                    uuser.record_history()
                                                    try:
                                                        start = txt_editt.index(tk.SEL_FIRST)
                                                        end = txt_editt.index(tk.SEL_LAST)

                                                        # 创建或更新名为 "red" 的 tag，指定前景色为红色
                                                        txt_editt.tag_config("red", foreground="#ffffff")

                                                        # 应用 "red" tag 到选定的文本范围
                                                        txt_editt.tag_add("red", start, end)
                                                    except:
                                                        return
                                                def pinkd():
                                                    global Font,ffont
                                                    global 姓名
                                                    name=姓名
                                                    uuser = Account1(name, '1', "[便利贴]调整字色{pink}", "操作:08编辑{[便利贴]改变文本字色}")
                                                    uuser.record_history()
                                                    try:
                                                        start = txt_editt.index(tk.SEL_FIRST)
                                                        end = txt_editt.index(tk.SEL_LAST)

                                                        # 创建或更新名为 "red" 的 tag，指定前景色为红色
                                                        txt_editt.tag_config("red", foreground="#FF89B4")

                                                        # 应用 "red" tag 到选定的文本范围
                                                        txt_editt.tag_add("red", start, end)
                                                    except:
                                                        return
                                                def green():
                                                    global Font,ffont
                                                    global 姓名
                                                    name=姓名
                                                    uuser = Account1(name, '1', "[便利贴]调整字色{green青}", "操作:08编辑{[便利贴]改变文本字色}")
                                                    uuser.record_history()
                                                    try:
                                                        start = txt_editt.index(tk.SEL_FIRST)
                                                        end = txt_editt.index(tk.SEL_LAST)

                                                       
                                                        txt_editt.tag_config("red", foreground="#00FFFF")

                                                        # 应用 "red" tag 到选定的文本范围
                                                        txt_editt.tag_add("red", start, end)
                                                    except:
                                                        return

                                                def flesh():
                                                    global Font,ffont
                                                    global 姓名
                                                    name=姓名
                                                    uuser = Account1(name, '1', "[便利贴]调整字色{flesh肉色}", "操作:08编辑{[便利贴]改变文本字色}")
                                                    uuser.record_history()
                                                    try:
                                                        start = txt_editt.index(tk.SEL_FIRST)
                                                        end = txt_editt.index(tk.SEL_LAST)

                                                       
                                                        txt_editt.tag_config("red", foreground="#fff7d0")

                                                        # 应用 "red" tag 到选定的文本范围
                                                        txt_editt.tag_add("red", start, end)
                                                    except:
                                                        return

                                                

                                            
                                                color = tk.Menu(edit_menu, tearoff=0)
                                                color.add_command(label="红色",command=redd)
                                                color.add_command(label="橙色",command=oranged)
                                                color.add_command(label="黄色",command=yellowd)
                                                color.add_command(label="绿色",command=greend)

                                                color.add_command(label="青色",command=green)
                                                
                                                
                                                color.add_command(label="蓝色",command=blued)
                                                color.add_command(label="紫色",command=purpled)
                                                color.add_command(label="粉色",command=pinkd)
                                                color.add_command(label="肉色",command=flesh)
                                                
                                                color.add_command(label="黑色",command=blackd)
                                                color.add_command(label="灰色",command=greyd)
                                                color.add_command(label="白色",command=whited)
                                                
                                                edit_menu.add_cascade(label="字色", menu=color)
                                                字号=tk.Menu(edit_menu,tearoff=0)
                                                current_font_family = tk.StringVar(value="宋体")
                                                current_font_size = tk.IntVar(value=12)
                                                

                                               
                                                def jq():
                                                    global 剪切文本
                                                    global 姓名
                                                    name=姓名
                                                    try:
                                                        剪切文本=txt_editt.get(tk.SEL_FIRST,tk.SEL_LAST)
                                                        txt_editt.delete(tk.SEL_FIRST,tk.SEL_LAST)
                                                        uuser = Account1(name, '1', f"[便利贴]剪切文本", "操作:08编辑{[便利贴]剪切扫过文本}")
                                                        uuser.record_history()
                                                    except:
                                                        pass
                                                    
                                                def fz():
                                                    global 剪切文本
                                                    global 姓名
                                                    name=姓名
                                                    try:
                                                        剪切文本=txt_editt.get(tk.SEL_FIRST,tk.SEL_LAST)
                                                        uuser = Account1(name, '1', f"[便利贴]复制文本", "操作:08编辑{[便利贴]复制扫过文本}")
                                                        uuser.record_history()
                                                    except:
                                                        pass
                                                def zt():
                                                    global 剪切文本
                                                    global 姓名
                                                    name=姓名
                                                    if 剪切文本:
                                                        txt_editt.insert(tk.INSERT,剪切文本)
                                                        uuser = Account1(name, '1', f"[便利贴]粘贴文本", "操作:08编辑{[便利贴]粘贴扫过文本}")
                                                        uuser.record_history()

                                                edit_menu.add_separator()
                                                def qax():
                                                    txt_editt.tag_add("sel", "1.0", "end-1c")
                                                    # 将焦点设置到 Text 控件上
                                                    txt_editt.focus_set()
                                                 
                                                
                                                edit_menu.add_command(label="剪切 Ctrl+x", command=jq)
                                                edit_menu.add_command(label="复制 Ctrl+c", command=fz)
                                                edit_menu.add_command(label="粘贴 Ctrl+v", command=zt)
                                                edit_menu.add_command(label="全选 Ctrl+a", command=qax)
                                                wor.bind('<Control-x>', lambda event:jq())
                                                wor.bind('<Control-c>', lambda event:fz())
                                                wor.bind('<Control-v>', lambda event:zt())
                                                wor.bind('<Control-a>', lambda event:qax())










                                                    


                                                def 正方形():
                                                   z="◼"
                                                   txt_editt.insert(tk.INSERT,z)
                                                   global 姓名
                                                   name=姓名
                                                   uuser = Account1(name, '1', "[便利贴]插入特殊符{实行[]}", "操作:08编辑{[便利贴]输出特殊字符}")
                                                   uuser.record_history()
                                                def 正方形2():
                                                   z="□"
                                                   txt_editt.insert(tk.INSERT,z)
                                                   global 姓名
                                                   name=姓名
                                                   uuser = Account1(name, '1', "[便利贴]插入特殊符{空心[]}", "操作:08编辑{[便利贴]输出特殊字符}")
                                                   uuser.record_history()
                                                def 三角形():
                                                    z="▲"
                                                    txt_editt.insert(tk.INSERT,z)
                                                    global 姓名
                                                    name=姓名
                                                    uuser = Account1(name, '1', "[便利贴]插入特殊符{实心▲}", "操作:08编辑{[便利贴]输出特殊字符}")
                                                    uuser.record_history()
                                                def 三角形2():
                                                    z="△"
                                                    txt_editt.insert(tk.INSERT,z)
                                                    global 姓名
                                                    name=姓名
                                                    uuser = Account1(name, '1', "[便利贴]插入特殊符{空心△}", "操作:08编辑{[便利贴]输出特殊字符}")
                                                    uuser.record_history()
                                                def 长方形1():
                                                    z="[ ]"
                                                    txt_editt.insert(tk.INSERT,z)
                                                    global 姓名
                                                    name=姓名
                                                    uuser = Account1(name, '1', "[便利贴]插入特殊符{[ ]}", "操作:08编辑{[便利贴]输出特殊字符}")
                                                    uuser.record_history()
                                                def 圆形():
                                                    z="⚪"
                                                    txt_editt.insert(tk.INSERT,z)
                                                    global 姓名
                                                    name=姓名
                                                    uuser = Account1(name, '1', "[便利贴]插入特殊符{o}", "操作:08编辑{[便利贴]输出特殊字符}")
                                                    uuser.record_history()
                                                def 梯形():
                                                    z="/二\\"
                                                    txt_editt.insert(tk.INSERT,z)
                                                    global 姓名
                                                    name=姓名
                                                    uuser = Account1(name, '1', "[便利贴]插入特殊符{/二\\}", "操作:08编辑{[便利贴]输出特殊字符}")
                                                    uuser.record_history()
                                                def 平行四边形():
                                                    z="/二/"
                                                    txt_editt.insert(tk.INSERT,z)
                                                    global 姓名
                                                    name=姓名
                                                    uuser = Account1(name, '1', "[便利贴]插入特殊符{/二/}", "操作:08编辑{[便利贴]输出特殊字符}")
                                                    uuser.record_history()
                                                def 除():
                                                    z="÷"
                                                    txt_editt.insert(tk.INSERT,z)
                                                    global 姓名
                                                    name=姓名
                                                    uuser = Account1(name, '1', "[便利贴]插入特殊符{÷}", "操作:08编辑{[便利贴]输出特殊字符}")
                                                    uuser.record_history()
                                                def 乘():
                                                    z="×"
                                                    txt_editt.insert(tk.INSERT,z)
                                                    global 姓名
                                                    name=姓名
                                                    uuser = Account1(name, '1', "[便利贴]插入特殊符{×}", "操作:08编辑{[便利贴]输出特殊字符}")
                                                    uuser.record_history()
                                                def 勾():
                                                    z="✔"
                                                    txt_editt.insert(tk.INSERT,z)
                                                    global 姓名
                                                    name=姓名
                                                    uuser = Account1(name, '1', "[便利贴]插入特殊符{勾}", "操作:08编辑{[便利贴]输出特殊字符}")
                                                    uuser.record_history()
                                                def 叉():
                                                    z="❌"
                                                    txt_editt.insert(tk.END,z)
                                                    global 姓名
                                                    name=姓名
                                                    uuser = Account1(name, '1', "[便利贴]插入特殊符{叉}", "操作:08编辑{[便利贴]输出特殊字符}")
                                                    uuser.record_history()
                                                def 点():
                                                    z="·"
                                                    txt_editt.insert(tk.END,z)
                                                    global 姓名
                                                    name=姓名
                                                    uuser = Account1(name, '1', "[便利贴]插入特殊符{·}", "操作:08编辑{[便利贴]输出特殊字符}")
                                                    uuser.record_history()
                                                def 上():
                                                    z="↑"
                                                    txt_editt.insert(tk.END,z)
                                                    global 姓名
                                                    name=姓名
                                                    uuser = Account1(name, '1', "[便利贴]插入特殊符{↑}", "操作:08编辑{[便利贴]输出特殊字符}")
                                                    uuser.record_history()
                                                def 下():
                                                    z="↓"
                                                    txt_editt.insert(tk.END,z)
                                                    global 姓名
                                                    name=姓名
                                                    uuser = Account1(name, '1', "[便利贴]插入特殊符{↓}", "操作:08编辑{[便利贴]输出特殊字符}")
                                                    uuser.record_history()
                                                def 左():
                                                    z="←"
                                                    txt_editt.insert(tk.END,z)
                                                    global 姓名
                                                    name=姓名
                                                    uuser = Account1(name, '1', "[便利贴]插入特殊符{←}", "操作:08编辑{[便利贴]输出特殊字符}")
                                                    uuser.record_history()
                                                def 右():
                                                    z="→"
                                                    txt_editt.insert(tk.END,z)
                                                    global 姓名
                                                    name=姓名
                                                    uuser = Account1(name, '1', "[便利贴]插入特殊符{→}", "操作:08编辑{[便利贴]输出特殊字符}")
                                                    uuser.record_history()
                                                    
                                                xingz = tk.Menu(edit_menu, tearoff=0)
                                                xingz.add_command(label="◼",command=正方形)
                                                xingz.add_command(label="□",command=正方形2)
                                                xingz.add_command(label="·",command=点)
                                                xingz.add_command(label='△',command=三角形2)
                                                xingz.add_command(label="▲",command=三角形)
                                                xingz.add_command(label="[  ]",command=长方形1)
                                                xingz.add_command(label="⚪",command=圆形)
                                                xingz.add_command(label="/二\\",command=梯形)
                                                xingz.add_command(label="/二/",command=平行四边形)
                                                xingz.add_command(label='↑',command=上)
                                                xingz.add_command(label='↓',command=下)
                                                xingz.add_command(label='←',command=左)
                                                xingz.add_command(label='→',command=右)

                                                xingz.add_command(label="÷",command=除)
                                                xingz.add_command(label="×",command=乘)
                                                xingz.add_command(label="✔",command=勾)
                                                xingz.add_command(label="❌",command=叉)

                                                edit_menu.add_separator()
                                                def qax():
                                                    txt_edit.tag_add("sel", "1.0", "end-1c")
                                                    # 将焦点设置到 Text 控件上
                                                    txt_edit.focus_set()
                                                 
                                                
                                 
                                               
                                               
                                                wor.bind('<Control-a>', lambda event:qax())
                                               
                                                def red():
                                                    global 姓名
                                                    name=姓名
                                                    uuser = Account1(name, '1', "[便利贴]调整色板色{red}", "操作:08编辑{[便利贴]改变文本字色}")
                                                    uuser.record_history()
                                                    txt_editt.config(bg="#FF6A6A")
                                                    
                                                def orange():
                                                    global 姓名
                                                    name=姓名
                                                    uuser = Account1(name, '1', "[便利贴]调整色板色{orange}", "操作:08编辑{[便利贴]改变文本字色}")
                                                    uuser.record_history()
                                                    txt_editt.config(bg="#FF7F50")
                                                def yellow():
                                                    global 姓名
                                                    name=姓名
                                                    uuser = Account1(name, '1', "[便利贴]调整色板色{yellow}", "操作:08编辑{[便利贴]改变文本字色}")
                                                    uuser.record_history()
                                                    txt_editt.config(bg="#FFFF00")
                                                def greenn():
                                                    
                                                    global 姓名
                                                    name=姓名
                                                    uuser = Account1(name, '1', "[便利贴]调整色板色{green}", "操作:08编辑{[便利贴]改变文本字色}")
                                                    uuser.record_history()
                                                    txt_editt.config(bg="#B5E61D")
                                                def blue():
                                                    txt_editt.config(bg="#3487FF")
                                                    global 姓名
                                                    name=姓名
                                                    uuser = Account1(name, '1', "[便利贴]调整色板色{blue}", "操作:08编辑{[便利贴]改变文本字色}")
                                                    uuser.record_history()
                                                def purple():
                                                    txt_editt.config(bg="#9B6CFF")
                                                    global 姓名
                                                    name=姓名
                                                    uuser = Account1(name, '1', "[便利贴]调整色板色{purple}", "操作:08编辑{[便利贴]改变文本字色}")
                                                    uuser.record_history()
                                                def pink():
                                                    txt_editt.config(bg="#FF89B4")
                                                    global 姓名
                                                    name=姓名
                                                    uuser = Account1(name, '1', "[便利贴]调整色板色{pink}", "操作:08编辑{[便利贴]改变文本字色}")
                                                    uuser.record_history()
                                                def black():
                                                    txt_editt.config(bg="#373738")
                                                    global 姓名
                                                    name=姓名
                                                    uuser = Account1(name, '1', "[便利贴]调整色板色{black}", "操作:08编辑{[便利贴]改变文本字色}")
                                                    uuser.record_history()
                                                def white():
                                                    txt_editt.config(bg="#ffffff")
                                                    global 姓名
                                                    name=姓名
                                                    uuser = Account1(name, '1', "[便利贴]调整色板色{white}", "操作:08编辑{[便利贴]改变文本字色}")
                                                    uuser.record_history()
                                                def grey():
                                                    txt_editt.config(bg="#B3B2B5")
                                                    global 姓名
                                                    name=姓名
                                                    uuser = Account1(name, '1', "[便利贴]调整色板色{grey}", "操作:08编辑{[便利贴]改变文本字色}")
                                                    uuser.record_history()
                                                def green():
                                                     txt_editt.config(bg="#00FFFF")
                                                     global 姓名
                                                     name=姓名
                                                     uuser = Account1(name, '1', "[便利贴]调整色板色{green(青)}", "操作:08编辑{[便利贴]改变文本字色}")
                                                     uuser.record_history()
                                                def flesh():
                                                     txt_editt.config(bg="#fff7d0")
                                                     global 姓名
                                                     name=姓名
                                                     uuser = Account1(name, '1', "[便利贴]调整色板色{flesh(肉色)}", "操作:08编辑{[便利贴]改变文本字色}")
                                                     uuser.record_history()
                                                #在填充中添加子菜单的项
                                                aboutt_menu = tk.Menu(edit_menu, tearoff=0)
                                                aboutt_menu.add_command(label="红色",command=red)
                                                aboutt_menu.add_command(label="橙色",command=orange)
                                                aboutt_menu.add_command(label="黄色",command=yellow)
                                                aboutt_menu.add_command(label="绿色",command=greenn)
                                                aboutt_menu.add_command(label="青色",command=green)
                                                aboutt_menu.add_command(label="蓝色",command=blue)
                                                aboutt_menu.add_command(label="紫色",command=purple)
                                                aboutt_menu.add_command(label="粉色",command=pink)
                                                aboutt_menu.add_command(label="肉色",command=flesh)
                                                
                                                aboutt_menu.add_command(label="黑色",command=black)
                                                aboutt_menu.add_command(label="白色",command=white)
                                                aboutt_menu.add_command(label="灰色",command=grey)









                                                '''提示标签'''
                                                
                                                
                                                def join():
                                                    global 状态,month,year,day,hourList,minuteList,dayList,monthList
                                                
                                                    global 姓名
                                                    nonlocal 提示标签,worddd,备份_备份i
                                                    name=姓名
                                                    if(提示标签!=0):
                                                        return
                                                    提示标签+=1
                                                    try:
                                                            # 自动生成的内容
                                                            
                                                     
                                                            worddd=tkinter.Tk()
                                                            worddd.title("OFFICE 设置")
                                                            worddd.geometry("215x225")
                                                            worddd.resizable(False, False)  # 禁止
                                                            worddd.attributes('-topmost',  True)
                                                            wor.geometry('382x235')
                                                            txt_editt.config(font=('微软雅黑',10),height=10)
                                                            txt_editt.config(state='normal')
                                                            uuser = Account1(name, '1', "[便利贴]录入备注{正录入}", "操作:08编辑{[便利贴]正在录入}")
                                                            uuser.record_history()
                                                            global ii,hour,minute,提示总次数
                                                            提示总次数=1
                                                          
                                                            
                                                            hour=datetime.now().strftime("%H")
                                                            minute=datetime.now().strftime("%M")
                                                            hour=int(hour)
                                                            minute=int(minute)
                                                            label1=tkinter.Label(worddd,text="请在文本中选取录入位置")
                                                            label1.place(x=25,y=3)
                                                            
                                                            label2=tkinter.Label(worddd,text=str(hour)+"时")
                                                            label2.place(x=24,y=37)

                                                            now=datetime.now()
                                                            year=f'{now.year}'
                                                            year=list(year)
                                                            year=year[len(year)-2:]
                                                          
                                                            s=10
                                                            ss=0
                                                            for i in range(2):
                                                                
                                                                 ss=int(year[i])*s+int(ss)
                                                                 s=s/10
                                                            s=10
                                                            
                                                            year=int(ss)
                                                            ss=0
                                                            
                                                            month=f'{now.month}'
                                                            month=int(month)
                                                            day=f'{now.day}'
                                                            day=int(day)
                                                            label3=tkinter.Label(worddd,text=str(year)+"年")
                                                            label3.place(x=24,y=67)


                                                            

                                                            label3=tkinter.Label(worddd,text=str(month)+"月")
                                                            label3.place(x=55,y=67)
                                                            def up():
                                                                global month
                                                                 
                                                                month+=1
                                                                if(month>12):
                                                                    month=12
                                                                    return
                                                                label2=tkinter.Label(worddd,text="      ")
                                                                label2.place(x=55,y=67)
                                                                label2=tkinter.Label(worddd,text=str(month)+"月")
                                                                label2.place(x=55,y=67)
                                                            def down():
                                                                global month
                                                                month-=1
                                                                if(month<1):
                                                                    month=1
                                                                    return
                                                                label2=tkinter.Label(worddd,text="      ")
                                                                label2.place(x=55,y=67)
                                                                label2=tkinter.Label(worddd,text=str(month)+"月")
                                                                label2.place(x=55,y=67)
                                                               
                                                               
                                                            btn5=ttk.Button(worddd,text="""↑""",command=up)
                                                            btn5.place(x=87,y=67,width=16)
                                                            btn6=ttk.Button(worddd,text="""↓""",command=down)
                                                            btn6.place(x=105,y=67,width=16)

                                                            label3=tkinter.Label(worddd,text=str(day)+"日")
                                                            label3.place(x=122,y=67)
                                                            def up():
                                                                global day,month
                                                                day+=1
                                                                if(month==1 or month==3 or month==5 or month==7 or month==8  or month==10 or month==12):
                                                                    if(day>31):
                                                                         day=31
                                                                         return
                                                                else:
                                                                     if(day>30):
                                                                          day=31
                                                                          return
                                                                         
                                                                         
                                                                label2=tkinter.Label(worddd,text="      ")
                                                                label2.place(x=122,y=67)
                                                                label2=tkinter.Label(worddd,text=str(day)+"日")
                                                                label2.place(x=122,y=67)
                                                            def down():
                                                                global day,month
                                                                day-=1
                                                                if(day<1):
                                                                     day=1
                                                                     return
                                                                         
                                                                label2=tkinter.Label(worddd,text="      ")
                                                                label2.place(x=122,y=67)
                                                                label2=tkinter.Label(worddd,text=str(day)+"日")
                                                                label2.place(x=122,y=67)
                                                               
                                                            btn5=ttk.Button(worddd,text="""↑""",command=up)
                                                            btn5.place(x=154,y=67,width=16)
                                                            btn6=ttk.Button(worddd,text="""↓""",command=down)
                                                            btn6.place(x=172,y=67,width=16)
                                                            
                                                         
                                                          
                                                            def up():
                                                                global hour
                                                                hour+=1
                                                                hour=int(hour)
                                                                if(hour>24):
                                                                    hour=24
                                                                    return
                                                                
                                                                label2=tkinter.Label(worddd,text="      ")
                                                                label2.place(x=24,y=37)
                                                                label2=tkinter.Label(worddd,text=str(hour)+"时")
                                                                label2.place(x=24,y=37)
                                                                
                                                            def down():
                                                                global hour
                                                           
                                                                hour=int(hour)
                                                                hour-=1
                                                                if(hour<0):
                                                                    hour=1
                                                                    return
                                                                label2=tkinter.Label(worddd,text="      ")
                                                                label2.place(x=24,y=37)
                                                                label2=tkinter.Label(worddd,text=str(hour)+"时")
                                                                label2.place(x=24,y=37)
                                                            
                                                            btn1=ttk.Button(worddd,text="""↑""",command=up)
                                                            btn1.place(x=68,y=37,width=16)
                                                            btn2=ttk.Button(worddd,text="""↓""",command=down)
                                                            btn2.place(x=86,y=37,width=16)
                                                            label2=tkinter.Label(worddd,text=str(minute)+"分")
                                                            label2.place(x=108,y=37)
                                                            def upp():
                                                                global minute
                                                                minute=int(minute)
                                                                minute+=1
                                                                
                                                                if(minute>59):
                                                                    minute=59
                                                                    return
                                                                label2=tkinter.Label(worddd,text="       ")
                                                                label2.place(x=108,y=37)
                                                                label2=tkinter.Label(worddd,text=str(minute)+"分")
                                                                label2.place(x=108,y=37)
                                                            def downn():
                                                                global minute
                                                                minute=int(minute)
                                                                minute-=1
                                                                if(minute<0):
                                                                    minute=0
                                                                    return
                                                                label2=tkinter.Label(worddd,text="       ")
                                                                label2.place(x=108,y=37)
                                                                label2=tkinter.Label(worddd,text=str(minute)+"分")
                                                                label2.place(x=108,y=37)
                                                                
                                                            btn3=ttk.Button(worddd,text="""↑""",command=upp)
                                                            btn3.place(x=147,y=37,width=16)
                                                            btn4=ttk.Button(worddd,text="""↓""",command=downn)
                                                            btn4.place(x=165,y=37,width=16)
                                                            def toggle_password_visibility():
                                                                         global 换行
                                                                         if(换行==0):
                                                                            
                                                                             换行=1
                                                                            
                                                                         elif(换行==1):
                                                                              换行=0
                                                                              
                                                            def OKk():
                                                                    global minute,hour,minuteList,hourList ,placeList,newsList,n,换行,ii,次数,running,状态
                                                                    global year,month,day,dayList,monthList
                                                                    global 姓名,备份i
                                                                    nonlocal 备份_备份i
                                                                    name=姓名
                                                                    running=False
                                                                    txt_edit.config(state=tk.NORMAL) 
                                                                
                                                                
                                                                
                                                                    #print(1)
                                                                    if(状态==1):
                                                                        备份_备份i=备份i
                                                                        ii=备份i
                                                                    状态=0
                                                                    
                                                                    if(entry11.get()!="" and entry22.get()!=""):
                                                                        placeList.append(entry11.get())
                                                                        newsList.append(entry22.get())
                                                                        
                                                                        dayList.append(day)
                                                                        monthList.append(month)
                                                                        
                                                                        if(int(hour)<10):
                                                                           
                                                                            hour=int(hour)
                                                                        if(int(minute)<10):
                                                                            
                                                                            minute=int(minute)
                                                                        #print(hour)
                                                                        hourList.append(hour)
                                                                        minuteList.append(minute)
                                                                        #print('hourList:')
                                                                        #print(hourList)
                                                                        ii+=1            
                                                                        txt_editt.delete('1.0', tk.END)
                                                                        generated_content = "       时间                            地点                         事件\n\n"
                                                                        txt_editt.insert(tk.END,generated_content)
                                                                        
                                                                        备份i=ii
                                                                       
                                                                        for j in range(ii):
                                                                            
                                                                            #print('j:'+str(j))
                                                                            n+=1
                                                                            #print('ii:'+str(ii))
                                                                            
                                                                            #print('hourList:'+str(hourList[j]))
                                                                            time=str(year)+"年"+str(monthList[j])+"月"+str(dayList[j])+"日"+str(hourList[j])+":"+str(minuteList[j])
                                                                            place=placeList[j]
                                                                            news=newsList[j]
                                                                            #print('time[j]:'+time)
                                                                            
                                                                            s=str(n)+str(time)+str(place)+str(news)
                                                                            #print(len(list(s)))
                                                                            s=[]
                                                                            转站_sList=[]
                                                                            转站_s=''
                                                                            if(n>9 ):
                                                                                if(换行==0):
                                                                                    time="   "+str(year)+"年"+str(monthList[j])+"月"+str(dayList[j])+"日, "+str(hourList[j])+":"+str(minuteList[j])
                                                                                    place=placeList[j]
                                                                                    news=newsList[j]

                                                                                    s.append(str(n))
                                                                                    time=list(time)
                                                                                    #print(len(time))
                                                                                    for i in range(len(time)):
                                                                                        s.append(time[i])
                                                                                    
                                                                                    #print(len(s))
                                                                                    检测=int(len(s))-22
                                                                                    if 检测!=0:
                                                                                        检测=0-检测
                                                                                    #print(检测)
                                                                                    for i in range(检测):
                                                                                        s.append('  ')
                                                                                    s.append(place)
                                                                                    s.append('                         ')
                                                                                    s.append(news)
                                                                                    s.append('\n')
                                                                                    终点=''
                                                                                    for i in range(len(s)):
                                                                                        终点=终点+s[i]
                                                                                        
                                                                                      
                                                                                        
                                                                                    #s=str(n)+time+"     " +place+"                 "+news+"\n"
                                                                                    txt_editt.insert(tk.END,终点)
                                                                                    print(13)
                                                                                else:
                                                                                    time="   "+str(year)+"年"+str(monthList[j])+"月"+str(dayList[j])+"日, "+str(hourList[j])+":"+str(minuteList[j])
                                                                                    place=placeList[j]
                                                                                    news=newsList[j]

                                                                                    s.append(str(n))
                                                                                    time=list(time)
                                                                                    #print(len(time))
                                                                                    for i in range(len(time)):
                                                                                        s.append(time[i])
                                                                                   
                                                                                    #print(len(s))
                                                                                    检测=int(len(s))-22
                                                                                    if 检测!=0:
                                                                                        检测=0-检测
                                                                                    #print(检测)
                                                                                    for i in range(检测):
                                                                                        s.append('  ')
                                                                                    s.append(place)
                                                                                    s.append('                         ')
                                                                                    s.append(news)
                                                                                    s.append('\n\n')
                                                                                    终点=''
                                                                                    for i in range(len(s)):
                                                                                        终点=终点+s[i]
                                                                                        

                                                                                    
                                                                                    #s=str(n)+time+"     " +place+"                 "+news+"\n\n"
                                                                                    txt_editt.insert(tk.END,终点)
                                                                                    print(14)
                                                                            else:
                                                                                if(换行==0):
                                                                                    time="     "+str(year)+"年"+str(monthList[j])+"月"+str(dayList[j])+"日, "+str(hourList[j])+":"+str(minuteList[j])
                                                                                   
                                                                                    
                                                                                    place=placeList[j]
                                                                                    news=newsList[j]

                                                                                    s.append(str(n))
                                                                                    time=list(time)
                                                                                    #print(len(time))
                                                                                    for i in range(len(time)):
                                                                                        s.append(time[i])
                                                                                    s.append('   ')
                                                                                    #print(len(s))
                                                                                    检测=int(len(s))-23
                                                                                    if 检测!=0:
                                                                                        检测=0-检测
                                                                                    #print(检测)
                                                                                    for i in range(检测):
                                                                                        s.append('  ')
                                                                                    s.append(place)
                                                                                    s.append('                        ')
                                                                                    s.append(news)
                                                                                    s.append('\n')
                                                                                    终点=''
                                                                                    for i in range(len(s)):
                                                                                        终点=终点+s[i]
                                                                                        
                                                                                    #s=str(n)+time+"     " +place+"                 "+news+"\n"
                                                                                    txt_editt.insert(tk.END,终点)
                                                                                    print(15)
                                                                                else:
                                                                                    time="     "+str(year)+"年"+str(monthList[j])+"月"+str(dayList[j])+"日, "+str(hourList[j])+":"+str(minuteList[j])
                                                                                    place=placeList[j]
                                                                                    news=newsList[j]

                                                                                    s.append(str(n))
                                                                                    time=list(time)
                                                                                    #print(len(time))
                                                                                    for i in range(len(time)):
                                                                                        s.append(time[i])
                                                                                    s.append('   ')
                                                                                    #print(len(s))
                                                                                    检测=int(len(s))-23
                                                                                    if 检测!=0:
                                                                                        检测=0-检测
                                                                                    #print(检测)
                                                                                    for i in range(检测):
                                                                                        s.append('  ')
                                                                                    s.append(place)
                                                                                    s.append('                        ')
                                                                                    s.append(news)
                                                                                    s.append('\n\n')
                                                                                    终点=''
                                                                                    for i in range(len(s)):
                                                                                        终点=终点+s[i]

                                                                                    
                                                                                    #s=str(n)+time+"     " +place+"                 "+news+"\n\n"
                                                                                
                                                                                    txt_editt.insert(tk.END,终点)
                                                                                    print(16)
                                                                        #print(']\n')
                                                                            
                                                                            
                                                                            
                                                                        menu_bar.entryconfig('运行',  state='normal')
                                                                        uuser = Account1(name, '1', "录入文本", "操作:08编辑{检测文本}")
                                                                        uuser.record_history()
                                                                        uuser = Account1(name, '1', "[便利贴]开启菜单运行按钮", "操作:06运行{[便利贴]运行提示标签准备状态}")
                                                                        uuser.record_history()
                                                                     
                                                                        
                                                                        n=0
                                                                                
                                                                                
                                                                    else:
                                                                            tkinter.messagebox.showerror("系统消息:","输入异常,请确认输入格式/遗漏项 ")
                                                                            uuser = Account1(name, '1', "[便利贴]录入备注{录入有误}", "操作:08编辑{[便利贴]判断提示}")
                                                                            uuser.record_history()
                                                                            return
                                                         
                                                                        
                                                            #文本=filename
                                                            def Cencell():
                                                                global hour ,minute,n,换行,ii,备份i
                                                                nonlocal 提示标签
                                                                提示标签=0
                                                                
                                                                n=0
                                                                换行=0
                                                                备份i=ii
                                                                ii=0
##                                                                wor.geometry('300x230')
##                                                                txt_editt.config(font=('微软雅黑',11),height=9)
##                                                                txt_editt.config(font=('微软雅黑',10))
                                                                uuser = Account1(name, '1', "[便利贴]录入备注{录入完成}", "操作:08编辑{[便利贴]录入完成}")
                                                                uuser.record_history()
                                                                worddd.destroy()

                                                            
                                                            # 绑定窗口关闭事件到自定义函数
                                                            
                                                
                                                            worddd.protocol("WM_DELETE_WINDOW", Cencell)
                                                            entry11 = ttk.Entry(worddd, font=("微软雅黑", 10))
                                                            entry11.bind('<Button-1>', lambda e: entry11.delete(0, tk.END))
                                                            entry11.insert(0, "地点")
                                                            entry11.place(x=25,y=97,width=167)

                                                            entry22 = ttk.Entry(worddd, font=("微软雅黑", 10))
                                                            entry22.bind('<Button-1>', lambda e: entry22.delete(0, tk.END))
                                                            entry22.insert(0, "事件")
                                                            entry22.place(x=25,y=127,width=167)
                                                            
                                                            show_password = tk.BooleanVar()
                                                            show_password.set(False)  # 默认不显示密码
                                                            check_button = tk.Checkbutton(worddd, text="自动换行", font=("april",9),fg="orange",
                                                                                          variable=show_password, command=toggle_password_visibility)
                                                            check_button.place(x=24,y=160)
                                                            
                                                            button1=ttk.Button(worddd,text="Next",command=OKk)
                                                            button1.place(x=26,y=187,width=65)
                                                            button2=ttk.Button(worddd,text="Cancel",command=Cencell)
                                                            button2.place(x=128,y=187,width=65)
                                                        
                                                            n=0
                                                    except Exception as e:
                                                            # 打印错误信息和行号
                                                            tb = traceback.extract_tb(sys.exc_info()[2])
                                                            error_message = f"{e} (line {tb[-1].lineno})"
                                                            print(f"报错: {error_message}")



                                                def 运行标签签():    
                                                    try:
                                                        global 运判,次数数,running,次数数数
                                                        global hourList,minuteList,placeList,newsList
                                                        global month,day,year,hour,ii,备份i
                                                        nonlocal 提示标签,worddd
                                                    
                                                        if(提示标签!=0):
                                                            worddd.destroy()
                                                        提示标签=0
                                                        txt_editt.config(state=tk.DISABLED)
                   
                                                        edit_menu.entryconfig('字色',  state='disabled')
                                                   
                                                        edit_menu.entryconfig('剪切 Ctrl+x',  state='disabled')
                                                        edit_menu.entryconfig('复制 Ctrl+c',  state='disabled')
                                                        edit_menu.entryconfig('粘贴 Ctrl+v',  state='disabled')
                                                        edit_menu.entryconfig('全选 Ctrl+a',  state='disabled')
                                                        edit_menu.entryconfig('插入形状',  state='disabled')
                                                        
                                                        edit_menu.entryconfig('排版',  state='disabled')
                                                        次数数=0
                                                        if(弹窗_提示窗==[1,0]):
                                                            弹窗 = Tk()
                                                            弹窗.title("便利贴 OFFICE【PET/7.V.v】")
                                                            弹窗.attributes('-topmost',  True)
                                                            # 使用 ttk 创建一个框架 
                                                            frame = ttk.Frame(弹窗, padding="10 10 10 10")
                                                            frame.pack(fill="both",  expand=True)
                                                             
                                                            # 添加一个标签 
                                                            label = ttk.Label(frame, text="便利贴 OFFICE",font=("微软雅黑",13,"bold"))
                                                            label.place(x=3,y=1)
                                                            label2=ttk.Label(frame,text=f"已将您的备注列为开始模式",font=("微软雅黑",11))
                                                            label2.place(x=3,y=38)
                                                            def OK():
                                                                 弹窗.destroy()
                                                            def on_closing():
                                                                            pass  # 不执行任何操作，阻止关闭 
                                                                         
                                                                        
                                                            弹窗.protocol("WM_DELETE_WINDOW",  on_closing)

                                                            btn1=ttk.Button(frame,text="我知道了",comman=OK)
                                                            btn1.place(x=3,y=160,height=36,width=334)
                                                            # 设置窗口的初始位置（右下角坐标）
                                                            def place_window_to_bottom_right(root, window_width=360, window_height=220):
                                                                                    # 获取屏幕的宽度和高度
                                                                                    screen_width = root.winfo_screenwidth()
                                                                                    screen_height = root.winfo_screenheight()

                                                                                    # 计算窗口左上角的坐标
                                                                                    x_coordinate = screen_width - window_width - 24  # 从右侧留出一点空间
                                                                                    y_coordinate = screen_height - window_height - 94  # 从底部留出一点空间（考虑到任务栏）

                                                                                    # 设置窗口的大小和位置
                                                                                    弹窗.geometry(f"{window_width}x{window_height}+{x_coordinate}+{y_coordinate}")
                                                                                   # 使用函数将窗口放置到右下角
                                                            place_window_to_bottom_right(弹窗)
                                                        else:
                                                            tkinter. messagebox.showinfo("便利贴 OFFICE",f"已将您的备注列为开始模式")
                                                           
                                                        global 姓名
                                                        name=姓名
                                                        uuser = Account1(name, '1', "[便利贴]运行提示标签{开始模式}", "操作:07自动运行{[便利贴]预备-开始状态}")
                                                        uuser.record_history()
                                                        运行标签()
                                                        
                                                    except Exception as e:
                                                        # 打印错误信息和行号
                                                        tb = traceback.extract_tb(sys.exc_info()[2])
                                                        error_message = f"{e} (line {tb[-1].lineno})"
                                                        print(f"报错: {error_message}")
                                                        
                                                def 挂起():
                                                    global 运判,次数数,running
                                                    global 姓名,弹窗_提示窗
   
                                             
                                                    edit_menu.entryconfig('字色',  state='normal')
                                                    
                                                    edit_menu.entryconfig('剪切 Ctrl+x',  state='normal')
                                                    edit_menu.entryconfig('复制 Ctrl+c',  state='normal')
                                                    edit_menu.entryconfig('粘贴 Ctrl+v',  state='normal')
                                                    edit_menu.entryconfig('全选 Ctrl+a',  state='normal')
                                                    edit_menu.entryconfig('插入形状',  state='normal')
                                
                                                    edit_menu.entryconfig('排版',  state='normal')
                                                    txt_editt.config(state='normal')
                                                    name=姓名
                                                    uuser = Account1(name, '1', "[便利贴]运行提示标签{挂起模式}", "操作:07自动运行{[便利贴]等待状态}")
                                                    uuser.record_history()
                                                    txt_editt.config(state=tk.NORMAL) 
                                                    running=False
                                                    if(弹窗_提示窗==[1,0]):
                                                        弹窗 = Tk()
                                                        弹窗.title("便利贴 OFFICE【PET/7.V.v】")
                                                        弹窗.attributes('-topmost',  True)
                                                        # 使用 ttk 创建一个框架 
                                                        frame = ttk.Frame(弹窗, padding="10 10 10 10")
                                                        frame.pack(fill="both",  expand=True)
                                                         
                                                        # 添加一个标签 
                                                        label = ttk.Label(frame, text="便利贴 OFFICE",font=("微软雅黑",13,"bold"))
                                                        label.place(x=3,y=1)
                                                        label2=ttk.Label(frame,text=f"已将您的备注列为待准备模式",font=("微软雅黑",11))
                                                        label2.place(x=3,y=38)
                                                        def OK():
                                                             弹窗.destroy()
                                                        def on_closing():
                                                                            pass  # 不执行任何操作，阻止关闭 
                                                                         
                                                                        
                                                        弹窗.protocol("WM_DELETE_WINDOW",  on_closing)

                                                        btn1=ttk.Button(frame,text="我知道了",comman=OK)
                                                        btn1.place(x=3,y=160,height=36,width=334)
                                                        # 设置窗口的初始位置（右下角坐标）
                                                        def place_window_to_bottom_right(root, window_width=360, window_height=220):
                                                                                    # 获取屏幕的宽度和高度
                                                                                    screen_width = root.winfo_screenwidth()
                                                                                    screen_height = root.winfo_screenheight()

                                                                                    # 计算窗口左上角的坐标
                                                                                    x_coordinate = screen_width - window_width - 24  # 从右侧留出一点空间
                                                                                    y_coordinate = screen_height - window_height - 94  # 从底部留出一点空间（考虑到任务栏）

                                                                                    # 设置窗口的大小和位置
                                                                                    弹窗.geometry(f"{window_width}x{window_height}+{x_coordinate}+{y_coordinate}")
                                                                                   # 使用函数将窗口放置到右下角
                                                        place_window_to_bottom_right(弹窗)
                                                    else:
                                                        tkinter. messagebox.showinfo("便利贴 OFFICE",f"已将您的备注列为待准备模式")
                                                        
                                                    
                                                    次数数+=1
                                                def 关闭():
                                                    global running,次数数,次数数数
                                                    global 姓名,弹窗_提示窗
                                                    
                                                    name=姓名
                                                    menu_bar.entryconfig('运行',  state='disabled')
                                             
                                                    edit_menu.entryconfig('字色',  state='normal')
                                                    
                                                    edit_menu.entryconfig('剪切 Ctrl+x',  state='normal')
                                                    edit_menu.entryconfig('复制 Ctrl+c',  state='normal')
                                                    edit_menu.entryconfig('粘贴 Ctrl+v',  state='normal')
                                                    edit_menu.entryconfig('全选 Ctrl+a',  state='normal')
                                                    edit_menu.entryconfig('插入形状',  state='normal')
                                
                                                    edit_menu.entryconfig('排版',  state='normal')
                                                    txt_editt.config(state='normal')
                                                    
                                                    uuser = Account1(name, '1', "[便利贴]运行提示标签{关闭模式}", "操作:07自动运行{[便利贴]关闭状态}")
                                                    uuser.record_history()
                                                    txt_editt.config(state=tk.NORMAL) 
                                                    menu_bar.entryconfig('运行',  state='disabled')

                                                    running=False
                                                    次数数数=''
                                                    try:
                                                        response = messagebox.askyesno("确认", "需要保存文件记录吗？")
                                                        if response=='ok':
                                                            with(open(文本,"w",encoding='utf-8')) as file:
                                                                file.write(txt_edit.get('1.0',tk.END))
                                                                txt_editt.delete('1.0',tk.END)
                                                        else:
                                                            txt_editt.delete('1.0',tk.END)

                                                                
                                                        次数数+=1
                                                        if(弹窗_提示窗==[1,0]):
                                                            弹窗 = Tk()
                                                            弹窗.title("便利贴 OFFICE【PET/7.V.v】")
                                                            弹窗.attributes('-topmost',  True)
                                                            # 使用 ttk 创建一个框架 
                                                            frame = ttk.Frame(弹窗, padding="10 10 10 10")
                                                            frame.pack(fill="both",  expand=True)
                                                             
                                                            # 添加一个标签 
                                                            label = ttk.Label(frame, text="便利贴 OFFICE",font=("微软雅黑",13,"bold"))
                                                            label.place(x=3,y=1)
                                                            label2=ttk.Label(frame,text=f"已将您的备注关闭",font=("微软雅黑",11))
                                                            label2.place(x=3,y=38)
                                                            def OK():
                                                                 txt_edit.delete('1.0',tk.END)
                                                                 弹窗.destroy()
                                                            
                                                            def on_closing():
                                                                            pass  # 不执行任何操作，阻止关闭 
                                                                         
                                                                        
                                                            弹窗.protocol("WM_DELETE_WINDOW",  on_closing)

                                                            btn1=ttk.Button(frame,text="我知道了",comman=OK)
                                                            btn1.place(x=3,y=160,height=36,width=334)
                                                            # 设置窗口的初始位置（右下角坐标）
                                                            def place_window_to_bottom_right(root, window_width=360, window_height=220):
                                                                                    # 获取屏幕的宽度和高度
                                                                                    screen_width = root.winfo_screenwidth()
                                                                                    screen_height = root.winfo_screenheight()

                                                                                    # 计算窗口左上角的坐标
                                                                                    x_coordinate = screen_width - window_width - 24  # 从右侧留出一点空间
                                                                                    y_coordinate = screen_height - window_height - 94  # 从底部留出一点空间（考虑到任务栏）

                                                                                    # 设置窗口的大小和位置
                                                                                    弹窗.geometry(f"{window_width}x{window_height}+{x_coordinate}+{y_coordinate}")
                                                                                   # 使用函数将窗口放置到右下角
                                                            place_window_to_bottom_right(弹窗)
                                                        else:
                                                            txt_editt.delete('1.0',tk.END)
                                                            tkinter. messagebox.showinfo("便利贴 OFFICE",f"已将您的备注关闭")
                                                            return
                                                          
                                                                                
                                                    except Exception as e:
                                                            # 打印错误信息和行号
                                                            import traceback
                                                            tb = traceback.extract_tb(sys.exc_info()[2])
                                                            error_message = f"{e} (line {tb[-1].lineno})"
                                                            print(f"报错: {error_message}")
                                                
                                                        
                                                def 运行标签():
                                                        global 运判,次数数,running,次数数数
                                                        global hourList,minuteList,placeList,newsList
                                                        global month,day,year,hour,ii,备份i
                                                        global 提示总次数
                                                        global 姓名,弹窗_提示窗
                                                        nonlocal 备份_备份i
        ##                                                print("ii:"+str(ii))
        ##                                                print("ts:"+str(提示总次数))
                                                        
                                                        if(备份_备份i<提示总次数-(备份i-备份_备份i)):
                                                            menu_bar.entryconfig('运行',  state='disabled')
                                             
                                                            edit_menu.entryconfig('字色',  state='normal')
                                                            
                                                            edit_menu.entryconfig('剪切 Ctrl+x',  state='normal')
                                                            edit_menu.entryconfig('复制 Ctrl+c',  state='normal')
                                                            edit_menu.entryconfig('粘贴 Ctrl+v',  state='normal')
                                                            edit_menu.entryconfig('全选 Ctrl+a',  state='normal')
                                                            edit_menu.entryconfig('插入形状',  state='normal')
                                        
                                                            edit_menu.entryconfig('排版',  state='normal')
                                                            txt_editt.config(state='normal')
                                                            running=False
                                                            次数数数=''

                                                        
                                                        if(次数数==0):
                                                          running=True
                                                          次数数+=1
                                                        if(running==True):
                                                            try:
                                                                    
                                                                    
                                                                    now_str = datetime.now()
                                                                    s=10
                                                                    ss=0
                                                                    a=list(f"{now_str.year}")
                                                                    a=a[len(a)-2:]
                                                                    for i in range(2):
                                                                         
                                                                          ss=int(a[i])*s+int(ss)
                                                                          s=s/10
                                                                    s=10
                                                                     
                                                                    a=int(ss)
                                                                    
                                                                    ss=0
                                                                    
                                                           
                                                                    now_str=f"{a}年{now_str.month}月{now_str.day}日, {now_str.hour}:{now_str.minute}"
                                                                    now=datetime.now()
                                                                    
                                                                    

                                                                    for j in range(len(minuteList)):
                                                                        # 确保小时为两位数格式
                                                                        #hour = f"{int(hourList[j]):02d}"
                                                                        if(int(hour)<10):
                                                                            hour='0'+str(hour)
                                                                            hour=int(hour)
                                                                            
                                                                        time = f"{year}年{month}月{day}日, {hour}:{minuteList[j]}"
                                                                        
                                                                        place=placeList[j]
                                                                        news=newsList[j]
       
                                                                        if now_str == time and 次数数数!=time :
                                                                            
                                                                           
                                                                            次数数数=time
                                                                            if(弹窗_提示窗==[1,0]):
                                                                                弹窗 = Tk()
                                                                                弹窗.title("便利贴 OFFICE【PET/7.V.v】")
                                                                                弹窗.attributes('-topmost',  True)
                                                                                # 使用 ttk 创建一个框架 
                                                                                frame = ttk.Frame(弹窗, padding="10 10 10 10")
                                                                                frame.pack(fill="both",  expand=True)
                                                                                 
                                                                                # 添加一个标签 
                                                                                label = ttk.Label(frame, text="便利贴 OFFICE",font=("微软雅黑",13,"bold"))
                                                                                label.place(x=3,y=1)
                                                                                label2=ttk.Label(frame,text=f"您备注的在\n时间:{time}\n\n前往地点:{place}          事件:{news}\n\n的标签提醒您,时间到了。",font=("微软雅黑",11))
                                                                                label2.place(x=3,y=28)
                                                                       
                                                                                name=姓名
                                                                                uuser = Account1(name, '1', "[便利贴]运行提示标签{激活提示}", "操作:07自动运行{[便利贴]启动提示弹窗}")
                                                                                uuser.record_history()
                                                                                def OK():
                                                                                    
                                                                                     弹窗.destroy()
                                                                                     

                                                                                btn1=ttk.Button(frame,text="确定消除",comman=OK)
                                                                                btn1.place(x=3,y=160,height=36,width=334)
                                                                                # 设置窗口的初始位置（右下角坐标）
                                                                                def place_window_to_bottom_right(root, window_width=360, window_height=220):
                                                                                    # 获取屏幕的宽度和高度
                                                                                    screen_width = root.winfo_screenwidth()
                                                                                    screen_height = root.winfo_screenheight()

                                                                                    # 计算窗口左上角的坐标
                                                                                    x_coordinate = screen_width - window_width - 24  # 从右侧留出一点空间
                                                                                    y_coordinate = screen_height - window_height - 94  # 从底部留出一点空间（考虑到任务栏）

                                                                                    # 设置窗口的大小和位置
                                                                                    弹窗.geometry(f"{window_width}x{window_height}+{x_coordinate}+{y_coordinate}")
                                                                                   # 使用函数将窗口放置到右下角
                                                                                place_window_to_bottom_right(弹窗)
                                                                                def on_closing():
                                                                                 pass  # 不执行任何操作，阻止关闭 
                                                                              
                                                                             
                                                                                弹窗.protocol("WM_DELETE_WINDOW",  on_closing)
                                                                            else:
                                                              
                                                                                tkinter. messagebox.showinfo("便利贴 OFFICE",f"您备注的在\n时间:{time}\n\n前往地点:{place}          事件:{news}\n\n的标签提醒您,时间到了。")
                                                                                
                                                                                name=姓名
                                                                                uuser = Account1(name, '1', "[便利贴]运行提示标签{激活提示}", "操作:07自动运行{[便利贴]启动提示弹窗}")
                                                                                uuser.record_history()
                                                                               
                                                                             
                                                                            提示总次数+=1
                                                                            time=""
                                                                            break  # 匹配后退出循环
                                                                    
                                                            except Exception as e:
                                                                # 打印错误信息和行号
                                                                import traceback
                                                                tb = traceback.extract_tb(sys.exc_info()[2])
                                                                error_message = f"{e} (line {tb[-1].lineno})"
                                                                print(f"报错: {error_message}")
                                                            
                                                            # 每隔1秒再次调用此函数,防止卡死
                                                            else:
                                                                
                                                                wor.after(1000, 运行标签)
                                                def joinn():
                                                    global 状态
                                                    nonlocal 提示标签,worddd
                                                    if(提示标签!=0):
                                                        worddd.destroy()
                                                    提示标签=0
                                                    状态=1
                                                    join()











                                                




                                                
                                                def new_tsbq():
                                                    global n,文本
                                                    nonlocal 旬报
                                                    global a,状态,placeList,newsList,minuteList,hourList,ii
                                                    global 姓名
                                                    ii=0
                                                    name=姓名
                                                    placeList=[]
                                                    newsList=[]
                                                    minuteList=[]
                                                    hourList=[]
                                                    状态=0
                                                    try:
                                                        txt_editt.config(state=tk.NORMAL) 
                                                        if(txt_editt.get('1.0',  tk.END)!=旬报):
                                                            response = messagebox.askyesno(" 确认", "需要保存原文件吗？") 
                                                            if response: 
                                                                save()
                                                        txt_editt.delete('1.0',tk.END)
                                                        join()
                                                        旬报=txt_edit.get('1.0',tk.END)
                                                        文本 = os.path.basename(文本) 
                                                        wor.title("新建文本-便利贴 OFFICE【PET/7.V.v】")
                                                        menu_bar.entryconfig('编辑',  state='normal')
                                                        uuser = Account1(name, '1', "[便利贴]新建提示标签:"+str(文本), "操作:10文件{[便利贴]生成新文档}")
                                                        uuser.record_history()
                                                    except Exception as e:
                                                            # 打印错误信息和行号
                                                            tb = traceback.extract_tb(sys.exc_info()[2])
                                                            error_message = f"{e} (line {tb[-1].lineno})"
                                                            print(f"报错: {error_message}")
                                                            
                                                # 文件菜单
                                                file_menu = tk.Menu(menu_bar, tearoff=0)
                                                file_menu.add_command(label="新建标签 Ctrl+n", command=new_bq)
                                                file_menu.add_command(label="新建提示标签 Ctrl+Shift+N", command=new_tsbq)
                                               
                
                                                #file_menu.add_command(label="新建窗口 Ctrl+shift+n", command=window)
                                                
                                                file_menu.add_separator()
                                                file_menu.add_command(label="打开 Ctrl+o", command=dak)
                                                

                                                
                                                file_menu.add_command(label="保存 Ctrl+s", command=save)
                                                file_menu.add_command(label="另存为 Ctrl+Shift+s", command=save_as)
                                                file_menu.add_command(label="撤回 Ctrl+z",command=Undo)
                                                file_menu.add_separator()
                                                file_menu.add_command(label="关闭", command=close)
                                                menu_bar.add_cascade(label="文件", menu=file_menu)
                                                wor.bind('<Control-z>', lambda event:Undo())
                                                wor.bind('<Control-o>', lambda event: dak())
                                                wor.bind('<Control-s>', lambda event:save())
                                                wor.bind('<Control-n>', lambda event: new_bq())
                                                wor.bind('<Control-Shift-n>', lambda event: new_tsbq())
                                                wor.bind('<Control-Shift-s>', lambda event: save_as())

                                                #在填充中添加子菜单
                                                
                                                edit_menu.add_cascade(label="填充色板", menu=aboutt_menu)
                                                edit_menu.add_cascade(label="插入形状", menu=xingz)
                                                edit_menu.add_separator()
                                                edit_menu.add_command(label="录入 Ctrl+j", command=joinn)
                                                wor.bind('<Control-j>', lambda event: join())
                                                edit_menu.add_separator()

                                                # 运行菜单
                                                run_menu = tk.Menu(menu_bar, tearoff=0)
                                                run_menu.add_command(label="挂起", command=挂起)
                                                run_menu.add_command(label="关闭", command=关闭)
                                                     
                                                run_menu.add_command(label="运行提示标签", command=运行标签签)
                                                menu_bar.add_cascade(label="运行", menu=run_menu)
                                                menu_bar.entryconfig('运行',  state='disabled')
                                     


                                                def right():
                                                    try:
                                                        try:
                                                            txt_editt.tag_remove("left", "1.0", "end")
                                                            txt_editt.tag_remove("center", "1.0", "end")
                                                            txt_editt.tag_remove("right", "1.0", "end")
                                                            a=txt_editt.tag_ranges(tk.SEL)
                                                            if not a:
                                                                return
                                                            txt_editt.tag_add("right",*a)
                                                            global 姓名
                                                            name=姓名
                                                            uuser = Account1(name, '1', "[便利贴]调整文本排版{right}", "操作:08编辑{[便利贴]改变文本位置}")
                                                            uuser.record_history()
                                                        except tk.TclError:
                                                            pass
                                                    except Exception as e:
                                                        # 打印错误信息和行号
                                                        tb = traceback.extract_tb(sys.exc_info()[2])
                                                        error_message = f"{e} (line {tb[-1].lineno})"
                                                        print(f"报错: {error_message}")
                                                def middle():
                                                    try:
                                                        try:
                                                            txt_editt.tag_remove("left", "1.0", "end")
                                                            txt_editt.tag_remove("center", "1.0", "end")
                                                            txt_editt.tag_remove("right", "1.0", "end")
                                                            a=txt_editt.tag_ranges(tk.SEL)
                                                            if not a:
                                                                return
                                                            txt_editt.tag_add("center",*a)
                                                            global 姓名
                                                            name=姓名
                                                            uuser = Account1(name, '1', "[便利贴]调整文本排版{middle}", "操作:08编辑{[便利贴]改变文本位置}")
                                                            uuser.record_history()
                                                        except:
                                                            pass
                                                    except Exception as e:
                                                        # 打印错误信息和行号
                                                        tb = traceback.extract_tb(sys.exc_info()[2])
                                                        error_message = f"{e} (line {tb[-1].lineno})"
                                                        print(f"报错: {error_message}")
                                                def left():
                                                    try:
                                                        try:
                                                            txt_editt.tag_remove("left", "1.0", "end")
                                                            txt_editt.tag_remove("center", "1.0", "end")
                                                            txt_editt.tag_remove("right", "1.0", "end")
                                                            # 获取当前选中的文本范围
                                                            a = txt_editt.tag_ranges(tk.SEL)
                                                            if not a:
                                                                return  # 如果没有选中文本，则不进行任何操作
                                                            
                                                            # 应用相应的对齐标签到选中的文本
                                                            txt_editt.tag_add("left", *a)
                                                            global 姓名
                                                            name=姓名
                                                            uuser = Account1(name, '1', "[便利贴]调整文本排版{left}", "操作:08编辑{[便利贴]改变文本位置}")
                                                            uuser.record_history()
                                                        except tk.TclError:
                                                            pass  # 如果没有选中的文本，则忽略错误
                                                    except Exception as e:
                                                        # 打印错误信息和行号
                                                        tb = traceback.extract_tb(sys.exc_info()[2])
                                                        error_message = f"{e} (line {tb[-1].lineno})"
                                                        print(f"报错: {error_message}")             

                                                # 定义不同的对齐标签(必写)
                                                txt_editt.tag_configure("left", justify='left')
                                                txt_editt.tag_configure("center", justify='center')
                                                txt_editt.tag_configure("right", justify='right')
                                                pb = tk.Menu(edit_menu, tearoff=0)
                                                pb.add_command(label="三  ",command=left)
                                                pb.add_command(label=" 三 ",command=middle)
                                                pb.add_command(label="  三",command=right)
                                                edit_menu.add_cascade(label="排版", menu=pb)

                                                

                                                menu_bar.add_cascade(label="编辑", menu=edit_menu)



                                           





                                                wor.config(menu=menu_bar)

                                                
                                                


                                                btn_新建=tkinter.Button(wor,text="＋",font=("微软雅黑 Light",19),borderwidth=-1,fg='#585858',bg='#fff0a7',activebackground='#EDEDED',command=新建)
                                                btn_新建.place(x=1,y=3,width=33,height=30)
                                               
                                                word.mainloop()















                                                

                                            style=ttk.Style()
                                            style.configure('n.TButton',font=('微软雅黑',18))
                                            
                                            btn_新建=tkinter.Button(word,text="＋",font=("微软雅黑 Light",19),borderwidth=-1,fg='#585858',bg='#EDEDED',activebackground='#cecfcb',command=新建)
                                            btn_新建.place(x=1,y=3,width=44,height=41)


                                            try:
                                               # 获取当前脚本所在的目录
                                               image_path = "购物车3.png"  # 假设图片在同一目录下
                                               current_dir = os.path.dirname(os.path.abspath(__file__))
                                               
                                               # 构建完整的图片路径
                                               full_image_path = os.path.join(current_dir, image_path)
                                               
                                               # 检查文件是否存在
                                               if not os.path.isfile(full_image_path):
                                                   raise FileNotFoundError(f"图片文件不存在: {full_image_path}")

                                               # 使用Pillow加载图片并调整大小（如果需要）
                                               original_image = Image.open(full_image_path)
                                               resized_image = original_image.resize((35, 32), Image.Resampling.LANCZOS)  # 调整大小

                                               # 将PIL图像转换为Tkinter兼容的图像
                                               img = ImageTk.PhotoImage(resized_image)

                                               # 创建一个Button，并设置图片和文字
                                                

                                               btn15=ttk.Button(word,style='Custom.TButton',image=img,compound='top',command=商城) 
                                               btn15.place(x=1,y=85,width=45,height=42)
                                               # 保存对图片的引用，防止垃圾回收
                                               btn15.image = img

                                            except FileNotFoundError as e:
                                               messagebox.showerror("错误", f"图片文件未找到: {e}")
                                            except Exception as e:
                                               messagebox.showerror("错误", f"无法加载图片: {e}")
                                               raise
                                            try:
                                               # 获取当前脚本所在的目录
                                               image_path = "历史记录5.png"  # 假设图片在同一目录下
                                               current_dir = os.path.dirname(os.path.abspath(__file__))
                                               
                                               # 构建完整的图片路径
                                               full_image_path = os.path.join(current_dir, image_path)
                                               
                                               # 检查文件是否存在
                                               if not os.path.isfile(full_image_path):
                                                   raise FileNotFoundError(f"图片文件不存在: {full_image_path}")

                                               # 使用Pillow加载图片并调整大小（如果需要）
                                               original_image = Image.open(full_image_path)
                                               resized_image = original_image.resize((35, 32), Image.Resampling.LANCZOS)  # 调整大小

                                               # 将PIL图像转换为Tkinter兼容的图像
                                               img = ImageTk.PhotoImage(resized_image)

                                               # 创建一个Button，并设置图片和文字
                                                

                                               btn16=ttk.Button(word,style='Custom.TButton',image=img,compound='top',command=历史) 
                                               btn16.place(x=1,y=132,width=45,height=42)
                                               # 保存对图片的引用，防止垃圾回收
                                               btn16.image = img

                                            except FileNotFoundError as e:
                                               messagebox.showerror("错误", f"图片文件未找到: {e}")
                                            except Exception as e:
                                               messagebox.showerror("错误", f"无法加载图片: {e}")
                                               raise
                                            try:
                                               # 获取当前脚本所在的目录
                                               image_path = "AI3.png"  # 假设图片在同一目录下
                                               current_dir = os.path.dirname(os.path.abspath(__file__))
                                               
                                               # 构建完整的图片路径
                                               full_image_path = os.path.join(current_dir, image_path)
                                               
                                               # 检查文件是否存在
                                               if not os.path.isfile(full_image_path):
                                                   raise FileNotFoundError(f"图片文件不存在: {full_image_path}")

                                               # 使用Pillow加载图片并调整大小（如果需要）
                                               original_image = Image.open(full_image_path)
                                               resized_image = original_image.resize((35, 32), Image.Resampling.LANCZOS)  # 调整大小

                                               # 将PIL图像转换为Tkinter兼容的图像
                                               img = ImageTk.PhotoImage(resized_image)

                                               # 创建一个Button，并设置图片和文字
                                                

                                           
                                               btn17=ttk.Button(word,style='Custom.TButton',image=img,compound='top',command=AI) 
                                               btn17.place(x=1,y=179,width=45,height=42)
                                            
                                               # 保存对图片的引用，防止垃圾回收
                                               btn17.image = img

                                               

                                            except FileNotFoundError as e:
                                               messagebox.showerror("错误", f"图片文件未找到: {e}")
                                            except Exception as e:
                                               messagebox.showerror("错误", f"无法加载图片: {e}")
                                               raise

                                            






                                            
                                            word.config(menu=menu_bar)
                                            word.mainloop()
                                            
        便利贴OFFICE()
        

    except Exception as e:
                # 打印错误信息和行号
                tb = traceback.extract_tb(sys.exc_info()[2])
                error_message = f"{e} (line {tb[-1].lineno})"
                print(f"报错: {error_message}")


    </p>
</body>
