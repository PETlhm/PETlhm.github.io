<!doctype html>
<html lang="zh-CN">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Python 分发站 — 专业下载（单文件）</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=Roboto+Mono:wght@400;700&display=swap" rel="stylesheet">
<!-- JSZip for real zip packaging -->
<script src="https://cdn.jsdelivr.net/npm/jszip@3.10.1/dist/jszip.min.js"></script>
<style>
  :root{
    --bg:#fff7ec;
    --card:#fffaf4;
    --muted:#5b6670;
    --accent:#ff9800;     /* 橙色主色 */
    --win-gloss: linear-gradient(180deg,#fff7ec,#ffe0b2);
    --btn-glass: linear-gradient(180deg,rgba(255,152,0,0.92),rgba(255,193,7,0.65));
    --radius:10px;
    --shadow: 0 10px 30px rgba(255,152,0,0.08);
    --mono:'Roboto Mono', monospace;
    --ui:'Inter',system-ui,-apple-system,"Segoe UI",Roboto,Arial;
  }
  body{margin:0;font-family:var(--ui);background:linear-gradient(180deg,#fff7ec, var(--bg));color:#0b1220;-webkit-font-smoothing:antialiased;transition:background 0.3s;}
  .container{max-width:980px;margin:34px auto;padding:20px}
  header{display:flex;align-items:center;gap:16px;background:var(--win-gloss);padding:14px;border-radius:14px;box-shadow:var(--shadow);border:1px solid rgba(8,18,40,0.06);transition:background 0.3s;}
  .logo{width:56px;height:56px;border-radius:10px;background:linear-gradient(135deg,var(--accent),#ffb300);display:flex;align-items:center;justify-content:center;color:#fff;font-weight:800;font-size:2rem;}
  .title h1{margin:0;font-size:18px}
  .title p{margin:4px 0 0;color:var(--muted);font-size:13px}
  .tools{margin-left:auto;display:flex;gap:10px;align-items:center}
  .btn {
    display:inline-flex;align-items:center;gap:8px;padding:8px 14px;border-radius:6px;
    background:linear-gradient(180deg,#fff8eb,#ffe0b2);
    border:1px solid rgba(11,20,40,0.08);box-shadow: 0 2px 0 rgba(255,255,255,0.6) inset, 0 2px 6px rgba(2,6,23,0.06);
    color:#0b1220;font-weight:600;cursor:pointer;transition:all .12s ease;font-size:14px;
  }
  .btn.primary{
    background:var(--btn-glass);
    color:#fff;
    border-color:rgba(255,152,0,0.12);
    box-shadow:0 6px 18px rgba(255,152,0,0.14)
  }
  .btn.ghost{background:transparent;border:1px solid rgba(11,20,40,0.06)}
  .btn:active{transform:translateY(1px);background:linear-gradient(180deg,#fb8c00,#ffb300);}
  .controls{display:flex;gap:10px;align-items:center;margin-top:14px}
  .search{flex:1;display:flex;gap:8px;align-items:center}
  input[type="search"]{width:100%;padding:10px 12px;border-radius:8px;border:1px solid rgba(8,18,40,0.06);background:var(--card);font-size:14px}
  select{padding:9px;border-radius:8px;border:1px solid rgba(8,18,40,0.06);background:var(--card);font-size:14px}
  .grid{display:grid;grid-template-columns:repeat(2,1fr);gap:16px;margin-top:18px}
  @media(max-width:820px){.grid{grid-template-columns:1fr}}
  .card{background:var(--card);border-radius:10px;padding:14px;border:1px solid rgba(8,18,40,0.04);box-shadow:0 6px 20px rgba(255,152,0,0.06);display:flex;flex-direction:column;min-height:140px;transition:background 0.3s;}
  .meta{display:flex;align-items:center;gap:12px}
  .tag{background:linear-gradient(180deg,#fff3e0,#ffe0b2);padding:6px 8px;border-radius:6px;font-weight:700;color:var(--accent);font-size:13px;border:1px solid rgba(255,152,0,0.06)}
  .name{font-weight:700;margin:0;font-size:15px}
  .desc{color:var(--muted);font-size:13px;margin:8px 0 0}
  .foot{display:flex;align-items:center;margin-top:auto;gap:10px}
  .pill{font-family:var(--mono);background:#fff3e0;padding:6px 8px;border-radius:6px;font-size:12px;color:#b26a00}
  .small{color:var(--muted);font-size:13px}
  .card .actions{margin-left:auto;display:flex;gap:8px}
  .count{font-size:12px;color:#b26a00}
  .modal-wrap{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:rgba(6,12,20,0.45);z-index:1200}
  .modal{width:92%;max-width:980px;border-radius:10px;padding:12px;background:linear-gradient(180deg,#fff3e0,#ffe0b2);color:#6d4c00;box-shadow:0 20px 80px rgba(255,152,0,0.2);transition:background 0.3s;}
  pre{background:rgba(255,255,255,0.02);padding:12px;border-radius:6px;overflow:auto;font-family:var(--mono);font-size:13px;max-height:62vh}
  .modal .meta{display:flex;align-items:center;gap:12px;margin-bottom:8px}
  .close{margin-left:auto;background:transparent;border:1px solid rgba(255,152,0,0.16);padding:8px;border-radius:6px;color:#ff9800;cursor:pointer}
  .copy-toast{position:fixed;right:22px;bottom:22px;background:#ff9800;color:#fff;padding:10px 14px;border-radius:10px;box-shadow:0 8px 30px rgba(255,152,0,0.22);display:none}
  footer{margin-top:18px;text-align:center;color:var(--muted);font-size:13px}

  /* 玻璃主题变量 */
  body.glass-theme{
    --bg: rgba(255,255,255,0.23);
    --card: rgba(255,255,255,0.14);
    --win-gloss: linear-gradient(180deg,rgba(255,255,255,0.34),rgba(255,255,255,0.09));
    --btn-glass: linear-gradient(180deg,rgba(255,152,0,0.68),rgba(255,193,7,0.42));
  }
  body.glass-theme,
  body.glass-theme .container,
  body.glass-theme header,
  body.glass-theme .card,
  body.glass-theme .modal {
    background: var(--card)!important;
    backdrop-filter: blur(12px) saturate(1.3);
    -webkit-backdrop-filter: blur(12px) saturate(1.3);
    box-shadow: 0 10px 30px rgba(255,152,0,0.09);
  }
  body.glass-theme .btn.primary {
    background: var(--btn-glass)!important;
    color:#fff;
    border-color:rgba(255,152,0,0.22);
    box-shadow:0 6px 18px rgba(255,152,0,0.18);
  }
  body.glass-theme .btn {
    background:linear-gradient(180deg,rgba(255,255,255,0.72),rgba(255,224,178,0.32));
    color:#b26a00;
  }
  body.glass-theme .btn.ghost {
    background:transparent;
    border:1px solid rgba(255,152,0,0.12);
    color:#b26a00;
  }
  body.glass-theme .pill {
    background:rgba(255,224,178,0.4);
    color:#b26a00;
  }
  body.glass-theme .tag {
    background:linear-gradient(180deg,rgba(255,243,224,0.9),rgba(255,224,178,0.6));
    color:var(--accent);
    border:1px solid rgba(255,152,0,0.09);
  }
  body.glass-theme .copy-toast{background:rgba(255,152,0,0.82);}
</style>
</head>
<body>
  <div class="container">
    <header>
      <div class="logo">Py</div>
      <div class="title">
        <h1>Python 分发站 · 专业下载</h1>
        <p>融合 Windows7 手感、Apple 质感与开发者友好，单文件静态页面分发脚本/安装包。</p>
      </div>
      <div class="tools" role="toolbar" aria-label="site tools">
        <button class="btn primary" id="downloadAllBtn">下载全部 (zip)</button>
        <button class="btn" id="refreshBtn">刷新列表</button>
        <button class="btn ghost" id="readmeBtn">说明</button>
        <button class="btn ghost" id="themeBtn">切换主题</button>
      </div>
    </header>

    <div class="controls">
      <div class="search">
        <input type="search" id="search" placeholder="搜索文件名、描述或平台（回车搜索）" />
      </div>
      <select id="filter">
        <option value="all">全部类型</option>
        <option value="script">脚本 (.py)</option>
        <option value="binary">二进制/安装包</option>
      </select>
      <select id="sort">
        <option value="name">按名称</option>
        <option value="size">按大小</option>
        <option value="downloads">按下载量</option>
      </select>
    </div>

    <main class="grid" id="grid" aria-live="polite"></main>

    <footer>将此文件放到静态主机或 GitHub Pages。若需要真实二进制分发，请替换文件 url 指向实际文件。</footer>
  </div>

  <!-- modal preview -->
  <div class="modal-wrap" id="modal">
    <div class="modal" role="dialog" aria-modal="true" aria-labelledby="modTitle">
      <div class="meta">
        <div>
          <strong id="modTitle">预览</strong>
          <span id="modName" class="pill" style="margin-left:8px"></span>
        </div>
        <div style="margin-left:auto;display:flex;gap:8px">
          <button class="btn" id="modDownload">下载</button>
          <button class="btn" id="modCopy">复制</button>
          <button class="close" id="modClose">关闭</button>
        </div>
      </div>
      <pre id="modContent" tabindex="0"></pre>
    </div>
  </div>

  <div class="copy-toast" id="toast">已复制到剪贴板</div>

<script>
/* ---------------------- 简洁、模块化的数据与工具 ---------------------- */

/* 内置资源：把脚本或小二进制元数据放上来。如果要分发真实的安装包，可把 url 指向托管好的文件 */
const FILES = [
  {
    name: "绿梵AI.py",
    type: "script",
    platform: "Windows/Linux/macOS",
    desc: "tkinter + selenium 自动化聊天脚本（含 webdriver 管理示例）。",
    content: `import tkinter as tk
from tkinter import ttk
from selenium import webdriver  # 控制浏览器的核心模块
from selenium.webdriver.chrome.service import Service  # 管理ChromDriver服务
from webdriver_manager.chrome import ChromeDriverManager  # 自动下载并管理ChromeDriver
from selenium.webdriver.common.by import By  # 定义元素定位方式
from selenium.webdriver.support.ui import WebDriverWait  # 显示等待工具
from selenium.webdriver.support import expected_conditions as EC  # 常用等待条件
import time

import threading
from selenium.webdriver.common.keys import Keys
...
# 省略内容，保持原有 FILES 数据
...
`
  },
  {
    name: "非爬取方式.py",
    type: "script",
    platform: "Cross-platform",
    desc: "轻量的关键字匹配本地问答脚本，适合离线测试与示例。",
    content: `import time
import random
...
# 省略内容，保持原有 FILES 数据
...
`
  }
];

/* ---------------------- 小工具 ---------------------- */
const $ = sel => document.querySelector(sel);
const g = id => document.getElementById(id);

async function sha1Hex(str){
  const buf = new TextEncoder().encode(str);
  const hash = await crypto.subtle.digest('SHA-1', buf);
  return Array.from(new Uint8Array(hash)).map(b => b.toString(16).padStart(2,'0')).join('');
}

/* 下载统计保存在 localStorage */
function getCounts(){ try { return JSON.parse(localStorage.getItem('dl_counts')||'{}') } catch { return {} } }
function incCount(name){ const c=getCounts(); c[name]=(c[name]||0)+1; localStorage.setItem('dl_counts',JSON.stringify(c)); }

/* ---------------------- 渲染与交互 ---------------------- */

function makeCard(f, idx){
  const div = document.createElement('article');
  div.className='card';
  div.innerHTML = `
    <div class="meta">
      <div class="tag">${f.type.toUpperCase()}</div>
      <div style="flex:1">
        <p class="name">${escapeHtml(f.name)}</p>
        <div class="desc">${escapeHtml(f.desc)}</div>
        <div style="margin-top:8px;display:flex;gap:8px;align-items:center">
          <span class="pill">${f.platform}</span>
          <span class="small" id="size-${idx}">计算大小…</span>
          <span class="count" id="count-${idx}"></span>
        </div>
      </div>
      <div class="actions">
        <button class="btn primary" data-download="${idx}">下载</button>
        <button class="btn" data-view="${idx}">预览</button>
      </div>
    </div>
  `;
  // size & count
  const sizeEl = div.querySelector(`#size-${idx}`);
  const countEl = div.querySelector(`#count-${idx}`);
  const blob = new Blob([f.content], {type:'text/plain;charset=utf-8'});
  sizeEl.textContent = blob.size < 1024 ? `${blob.size} B` : `${(blob.size/1024).toFixed(1)} KB`;
  const counts = getCounts(); countEl.textContent = `下载 ${counts[f.name]||0} 次`;
  // handlers
  div.querySelector('[data-download]').onclick = ()=>downloadFile(idx);
  div.querySelector('[data-view]').onclick = ()=>openModal(idx);
  return div;
}

function render(list){
  const grid = g('grid');
  grid.innerHTML = '';
  list.forEach((f,i)=> grid.appendChild(makeCard(f,i)));
}

/* filtering & search & sort */
function applyFilters(){
  const q = g('search').value.trim().toLowerCase();
  const filter = g('filter').value;
  const sort = g('sort').value;
  let list = FILES.filter(f=>{
    if(filter!=='all' && f.type!==filter) return false;
    if(!q) return true;
    return (f.name+f.desc+f.platform).toLowerCase().includes(q);
  });
  if(sort==='name') list.sort((a,b)=>a.name.localeCompare(b.name));
  else if(sort==='size') list.sort((a,b)=> (new Blob([a.content]).size) - (new Blob([b.content]).size) );
  else if(sort==='downloads'){
    const counts = getCounts();
    list.sort((a,b)=>(counts[b.name]||0)-(counts[a.name]||0));
  }
  render(list);
}

/* download single (supports content or url) */
async function downloadFile(i){
  const f = FILES[i];
  incCount(f.name);
  applyFilters(); // update counts
  if(f.url){
    // external URL — direct navigate (good for large binaries)
    const a = document.createElement('a');
    a.href = f.url; a.download = f.name; document.body.appendChild(a); a.click(); a.remove();
    return;
  }
  const blob = new Blob([f.content], {type: f.type==='script' ? 'text/x-python;charset=utf-8' : 'application/octet-stream'});
  // compute checksum async and show in console (nice-to-have)
  sha1Hex(f.content).then(h=> console.log(`${f.name} SHA1: ${h}`)).catch(()=>{});
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a'); a.href = url; a.download = f.name; document.body.appendChild(a); a.click(); a.remove();
  setTimeout(()=>URL.revokeObjectURL(url),5000);
}

/* preview modal */
function openModal(i){
  const f = FILES[i];
  g('modName').textContent = f.name;
  g('modTitle').textContent = `${f.type.toUpperCase()} 预览`;
  g('modContent').textContent = f.content;
  g('modal').style.display = 'flex';
  g('modDownload').onclick = ()=>downloadFile(i);
  g('modCopy').onclick = ()=>{ navigator.clipboard.writeText(f.content).then(()=>showToast()) };
}
g('modClose').onclick = ()=> g('modal').style.display='none';

/* zip all using JSZip */
async function downloadAll(){
  const zip = new JSZip();
  FILES.forEach(f=> zip.file(f.name, f.content));
  const blob = await zip.generateAsync({type:'blob',compression:'DEFLATE'});
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a'); a.href = url; a.download = 'python-files.zip'; document.body.appendChild(a); a.click(); a.remove();
  setTimeout(()=>URL.revokeObjectURL(url),5000);
}

/* helpers */
function escapeHtml(s){ return String(s).replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;') }
function showToast(){ const t=g('toast'); t.style.display='block'; setTimeout(()=>t.style.display='none',1300) }

/* ---------------------- 事件绑定 ---------------------- */
g('search').addEventListener('keydown', e=>{ if(e.key==='Enter') applyFilters() });
g('filter').addEventListener('change', applyFilters);
g('sort').addEventListener('change', applyFilters);
g('downloadAllBtn').addEventListener('click', downloadAll);
g('refreshBtn').addEventListener('click', ()=>{ location.reload() });
g('readmeBtn').addEventListener('click', ()=> {
  // simple modal readme
  g('modName').textContent='说明';
  g('modTitle').textContent='站点说明';
  g('modContent').textContent = `说明：
- 点击“下载”会把内置内容另存为文件。
- 若要分发真实安装包，把对应条目替换为 { url: "https://your.host/path/to/file.exe" }，并把 content 留空或简短说明。
- 本页面为单文件静态分发模板，可上 GitHub Pages 或任意静态主机部署。`;
  g('modal').style.display='flex';
  g('modDownload').onclick = ()=>{}; // noop
  g('modCopy').onclick = ()=>{ navigator.clipboard.writeText(g('modContent').textContent).then(()=>showToast()) };
});

/* keyboard ESC close modal */
document.addEventListener('keydown', e=>{ if(e.key==='Escape') g('modal').style.display='none' });

/* ---------------------- 主题切换事件 ---------------------- */
g('themeBtn').addEventListener('click',()=>{
  document.body.classList.toggle('glass-theme');
});

/* ---------------------- 初始化 ---------------------- */
applyFilters();

/* compute and attach SHA1 asynchronously and show in console for transparency */
FILES.forEach(f=> sha1Hex(f.content).then(h=> console.debug(`${f.name} SHA1: ${h}`)).catch(()=>{}));

</script>
</body>
</html>
